"use strict";(self.webpackChunkreact_google_sheets_project=self.webpackChunkreact_google_sheets_project||[]).push([[265],{56711:(e,t,l)=>{l.r(t),l.d(t,{default:()=>A});var o=l(65043),i=l(24217),s=l(2631),n=l(53151),r=l(93509),a=l(84211),c=l(35799),d=l(27986),h=l(6319),u=l(6058);const y=import.meta.env.VITE_API_URL||import.meta.env.REACT_APP_API_URL||"http://localhost:3001",v=async()=>{try{const e=await fetch("".concat(y,"/api/retail/dashboard"));if(!e.ok)throw new Error("Failed to fetch retail dashboard");const t=await e.json();return t.success?t.data:null}catch(e){throw console.error("Error fetching retail dashboard:",e),e}},x=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"30d";try{const t=await fetch("".concat(y,"/api/retail/sales?timeframe=").concat(e));if(!t.ok)throw new Error("Failed to fetch sales metrics");const l=await t.json();return l.success?l.data:null}catch(t){throw console.error("Error fetching sales metrics:",t),t}},g=async()=>{try{const e=await fetch("".concat(y,"/api/retail/inventory"));if(!e.ok)throw new Error("Failed to fetch inventory status");const t=await e.json();return t.success?t.data:null}catch(e){throw console.error("Error fetching inventory status:",e),e}},m=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"30d";try{const t=await fetch("".concat(y,"/api/retail/customers?timeframe=").concat(e));if(!t.ok)throw new Error("Failed to fetch customer analytics");const l=await t.json();return l.success?l.data:null}catch(t){throw console.error("Error fetching customer analytics:",t),t}},p=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e);var j=l(17304),f=l(70579);j.t1.register(j.PP,j.kc,j.FN,j.No,j.E8,j.Bs,j.hE,j.m_,j.s$);const A=()=>{var e,t,l,y,j,A,b,w,k;const[T,S]=(0,o.useState)(null),[C,E]=(0,o.useState)(null),[I,R]=(0,o.useState)(null),[V,L]=(0,o.useState)(null),[N,F]=(0,o.useState)(!0),[P,_]=(0,o.useState)(null);(0,o.useEffect)(()=>{B();const e=setInterval(B,3e4);return()=>clearInterval(e)},[]);const B=async()=>{try{F(!0),_(null);const[e,t,l,o]=await Promise.all([v(),x("30d"),g(),m("30d")]);e&&S(e),t&&E(t),l&&R(l),o&&L(o)}catch(e){console.error("Error fetching retail data:",e),_(e.message)}finally{F(!1)}},O=null!==C&&void 0!==C&&C.topProducts?{labels:C.topProducts.map(e=>e.name),datasets:[{label:"Sales (VND)",data:C.topProducts.map(e=>e.sales),backgroundColor:["#3b82f6","#60a5fa","#2563eb","#06a77d","#1d4ed8"]}]}:null,W=I?{labels:["In Stock","Low Stock","Out of Stock"],datasets:[{data:[I.inStock,I.lowStock,I.outOfStock],backgroundColor:["#06a77d","#f59e0b","#d62828"]}]}:null;return N&&!T?(0,f.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px"},children:(0,f.jsx)(i.A,{size:"large"})}):P?(0,f.jsx)(s.A,{message:"Error",description:"Error loading retail data: ".concat(P),type:"error",showIcon:!0,style:{margin:16}}):(0,f.jsxs)("div",{style:{padding:16},children:[(0,f.jsx)(n.A.Title,{level:2,style:{marginBottom:24,fontWeight:700,color:"#3b82f6"},children:"\ud83d\uded2 MIA Retail Dashboard"}),(0,f.jsxs)(r.A,{gutter:[16,16],children:[(0,f.jsx)(a.A,{xs:24,sm:12,md:6,children:(0,f.jsxs)(c.A,{style:{background:"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)",color:"white"},children:[(0,f.jsx)(n.A.Text,{style:{display:"block",marginBottom:8,opacity:.9,color:"white"},children:"Today's Revenue"}),(0,f.jsx)(n.A.Title,{level:3,style:{fontWeight:700,color:"white",margin:0},children:p((null===T||void 0===T||null===(e=T.today)||void 0===e?void 0:e.revenue)||0)}),(0,f.jsxs)(n.A.Text,{style:{display:"block",marginTop:8,opacity:.8,color:"white"},children:[(null===T||void 0===T||null===(t=T.today)||void 0===t?void 0:t.orders)||0," orders"]})]})}),(0,f.jsx)(a.A,{xs:24,sm:12,md:6,children:(0,f.jsxs)(c.A,{style:{background:"linear-gradient(135deg, #f77f00 0%, #fcbf49 100%)",color:"white"},children:[(0,f.jsx)(n.A.Text,{style:{display:"block",marginBottom:8,opacity:.9,color:"white"},children:"Active Customers"}),(0,f.jsx)(n.A.Title,{level:3,style:{fontWeight:700,color:"white",margin:0},children:(null===V||void 0===V||null===(l=V.activeCustomers)||void 0===l?void 0:l.toLocaleString())||0}),(0,f.jsxs)(n.A.Text,{style:{display:"block",marginTop:8,opacity:.8,color:"white"},children:[(null===V||void 0===V?void 0:V.newCustomers)||0," new this month"]})]})}),(0,f.jsx)(a.A,{xs:24,sm:12,md:6,children:(0,f.jsxs)(c.A,{style:{background:"linear-gradient(135deg, #06a77d 0%, #3b82f6 100%)",color:"white"},children:[(0,f.jsx)(n.A.Text,{style:{display:"block",marginBottom:8,opacity:.9,color:"white"},children:"Inventory"}),(0,f.jsxs)(n.A.Title,{level:3,style:{fontWeight:700,color:"white",margin:0},children:[(null===I||void 0===I?void 0:I.inStock)||0," /"," ",(null===I||void 0===I?void 0:I.totalProducts)||0]}),(0,f.jsxs)(n.A.Text,{style:{display:"block",marginTop:8,opacity:.8,color:"white"},children:[(null===I||void 0===I?void 0:I.lowStock)||0," low stock items"]})]})}),(0,f.jsx)(a.A,{xs:24,sm:12,md:6,children:(0,f.jsxs)(c.A,{style:{background:"linear-gradient(135deg, #3b82f6 0%, #667eea 100%)",color:"white"},children:[(0,f.jsx)(n.A.Text,{style:{display:"block",marginBottom:8,opacity:.9,color:"white"},children:"Conversion Rate"}),(0,f.jsxs)(n.A.Title,{level:3,style:{fontWeight:700,color:"white",margin:0},children:[(null===C||void 0===C||null===(y=C.conversionRate)||void 0===y?void 0:y.toFixed(1))||0,"%"]}),(0,f.jsxs)(n.A.Text,{style:{display:"block",marginTop:8,opacity:.8,color:"white"},children:["AOV: ",(null===C||void 0===C||null===(j=C.averageOrderValue)||void 0===j?void 0:j.toLocaleString("vi-VN"))||0,"\u20ab"]})]})}),(0,f.jsx)(a.A,{xs:24,md:16,children:(0,f.jsxs)(c.A,{children:[(0,f.jsx)(n.A.Title,{level:4,style:{marginBottom:16},children:"\ud83d\udcc8 Sales Trend (Last 7 Days)"}),(0,f.jsx)("div",{style:{height:"300px"},children:(0,f.jsx)(u.N1,{data:{labels:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],datasets:[{label:"Revenue (VND)",data:[12e4,15e4,18e4,14e4,16e4,2e5,22e4],borderColor:"#3b82f6",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0},tooltip:{callbacks:{label:function(e){return"Revenue: "+e.parsed.y.toLocaleString("vi-VN")+"\u20ab"}}}},scales:{y:{beginAtZero:!0,ticks:{callback:function(e){return e.toLocaleString("vi-VN")+"\u20ab"}}}}}})})]})}),(0,f.jsx)(a.A,{xs:24,md:8,children:(0,f.jsxs)(c.A,{children:[(0,f.jsx)(n.A.Title,{level:4,style:{marginBottom:16},children:"\ud83d\udce6 Inventory Status"}),W&&(0,f.jsx)("div",{style:{height:"300px"},children:(0,f.jsx)(u.Fq,{data:W,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})})]})}),(0,f.jsx)(a.A,{xs:24,md:12,children:(0,f.jsxs)(c.A,{children:[(0,f.jsx)(n.A.Title,{level:4,style:{marginBottom:16},children:"\ud83c\udfc6 Top Selling Products"}),O&&(0,f.jsx)("div",{style:{height:"300px"},children:(0,f.jsx)(u.yP,{data:O,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(e){return"Sales: "+e.parsed.y.toLocaleString("vi-VN")+"\u20ab"}}}},scales:{y:{beginAtZero:!0,ticks:{callback:function(e){return e.toLocaleString("vi-VN")+"\u20ab"}}}}}})})]})}),(0,f.jsx)(a.A,{xs:24,md:12,children:(0,f.jsxs)(c.A,{children:[(0,f.jsx)(n.A.Title,{level:4,style:{marginBottom:16},children:"\ud83d\udc65 Customer Metrics"}),(0,f.jsxs)(d.A,{direction:"vertical",size:"middle",style:{width:"100%"},children:[(0,f.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,f.jsx)(n.A.Text,{children:"Total Customers"}),(0,f.jsx)(h.A,{color:"blue",children:(null===V||void 0===V||null===(A=V.totalCustomers)||void 0===A?void 0:A.toLocaleString())||0})]}),(0,f.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,f.jsx)(n.A.Text,{children:"Retention Rate"}),(0,f.jsx)(h.A,{color:"green",children:"".concat((null===V||void 0===V||null===(b=V.retentionRate)||void 0===b?void 0:b.toFixed(1))||0,"%")})]}),(0,f.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,f.jsx)(n.A.Text,{children:"Customer Lifetime Value"}),(0,f.jsx)(h.A,{color:"cyan",children:"".concat((null===V||void 0===V||null===(w=V.customerLifetimeValue)||void 0===w?void 0:w.toLocaleString("vi-VN"))||0,"\u20ab")})]}),(0,f.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,f.jsx)(n.A.Text,{children:"Average Order Frequency"}),(0,f.jsx)(h.A,{color:"orange",children:"".concat((null===V||void 0===V||null===(k=V.averageOrderFrequency)||void 0===k?void 0:k.toFixed(1))||0,"x")})]})]})]})})]})]})}}}]);
//# sourceMappingURL=retail-dashboard.bb8034e6.chunk.js.map