"use strict";(self.webpackChunkreact_google_sheets_project=self.webpackChunkreact_google_sheets_project||[]).push([[494],{20268:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ge});var i=n(65043),s=n(27986),l=n(35799),r=n(61884),a=n(51918),c=n(11959),o=n(99195),d=n(5077),h=n(36059),u=n(25597),x=n(45844),g=n(68508),p=n(24217),m=n(2631),A=n(88971),y=n(63129),j=n(75879),v=n(93292),b=n(74173),f=n(95552),w=n(57148),k=n(21652),C=n(70579);const{Step:S}=x.A,T=()=>{const[e,t]=(0,i.useState)(0),[n,r]=(0,i.useState)(!1),[c,o]=(0,i.useState)(!1),[d,h]=(0,i.useState)(null),[T,M]=(0,i.useState)(""),[F,I]=(0,i.useState)(null);(0,i.useEffect)(()=>{E()},[]);const E=async()=>{try{var e;const t=await k.Ay.getCurrentUser();I((null===t||void 0===t?void 0:t.user)||t),o((null===t||void 0===t||null===(e=t.user)||void 0===e?void 0:e.mfaEnabled)||(null===t||void 0===t?void 0:t.mfaEnabled)||!1)}catch(t){console.error("Load user profile error:",t)}},D=d?"otpauth://totp/MIA.vn:".concat((null===F||void 0===F?void 0:F.email)||"user","?secret=").concat(d.secret,"&issuer=MIA.vn"):"";return n&&!d?(0,C.jsx)("div",{style:{textAlign:"center",padding:"40px"},children:(0,C.jsx)(p.A,{size:"large"})}):(0,C.jsx)("div",{className:"security-container",children:(0,C.jsxs)(l.A,{title:(0,C.jsxs)(s.A,{children:[(0,C.jsx)(a.A,{}),(0,C.jsx)("span",{children:"X\xe1c th\u1ef1c hai l\u1edbp (MFA)"})]}),className:"security-card",children:[c&&2!==e?(0,C.jsx)(m.A,{message:"MFA \u0111\xe3 \u0111\u01b0\u1ee3c k\xedch ho\u1ea1t",description:"T\xe0i kho\u1ea3n c\u1ee7a b\u1ea1n \u0111\xe3 \u0111\u01b0\u1ee3c b\u1ea3o v\u1ec7 b\u1eb1ng x\xe1c th\u1ef1c hai l\u1edbp.",type:"success",icon:(0,C.jsx)(b.A,{}),showIcon:!0,action:(0,C.jsx)(A.Ay,{danger:!0,onClick:async()=>{r(!0);try{await k.Ay.disableMFA(),o(!1),h(null),t(0),g.Ay.success("MFA \u0111\xe3 \u0111\u01b0\u1ee3c t\u1eaft th\xe0nh c\xf4ng!"),await E()}catch(e){g.Ay.error(e.message||"Kh\xf4ng th\u1ec3 t\u1eaft MFA")}finally{r(!1)}},loading:n,icon:(0,C.jsx)(f.A,{}),children:"T\u1eaft MFA"}),style:{marginBottom:"24px"}}):null,(0,C.jsxs)(x.A,{current:e,onChange:t,children:[(0,C.jsx)(S,{title:"B\u1eaft \u0111\u1ea7u",description:"T\u1ea1o MFA secret"}),(0,C.jsx)(S,{title:"Qu\xe9t QR Code",description:"X\xe1c th\u1ef1c thi\u1ebft b\u1ecb"}),(0,C.jsx)(S,{title:"Ho\xe0n t\u1ea5t",description:"MFA \u0111\xe3 k\xedch ho\u1ea1t"})]}),(0,C.jsx)(y.A,{}),0===e&&(0,C.jsxs)("div",{className:"mfa-step-content",children:[(0,C.jsxs)("div",{style:{textAlign:"center",marginBottom:"24px"},children:[(0,C.jsx)(u.A,{style:{fontSize:"64px",color:"#1890ff"}}),(0,C.jsx)("h3",{style:{marginTop:"16px"},children:"B\u1ea3o v\u1ec7 t\xe0i kho\u1ea3n c\u1ee7a b\u1ea1n"}),(0,C.jsx)("p",{style:{color:"#666",maxWidth:"500px",margin:"0 auto"},children:"X\xe1c th\u1ef1c hai l\u1edbp (MFA) gi\xfap b\u1ea3o v\u1ec7 t\xe0i kho\u1ea3n c\u1ee7a b\u1ea1n b\u1eb1ng c\xe1ch y\xeau c\u1ea7u m\xe3 x\xe1c th\u1ef1c t\u1eeb \u1ee9ng d\u1ee5ng x\xe1c th\u1ef1c tr\xean \u0111i\u1ec7n tho\u1ea1i khi \u0111\u0103ng nh\u1eadp."})]}),(0,C.jsx)("div",{style:{textAlign:"center"},children:(0,C.jsx)(A.Ay,{type:"primary",size:"large",icon:(0,C.jsx)(a.A,{}),onClick:async()=>{r(!0);try{const e=await k.Ay.generateMFASecret();h(e),t(1),g.Ay.success("MFA secret \u0111\xe3 \u0111\u01b0\u1ee3c t\u1ea1o!")}catch(e){g.Ay.error(e.message||"Kh\xf4ng th\u1ec3 t\u1ea1o MFA secret")}finally{r(!1)}},loading:n,children:"T\u1ea1o MFA Secret"})})]}),1===e&&d&&(0,C.jsxs)("div",{className:"mfa-step-content",children:[(0,C.jsx)(m.A,{message:"Qu\xe9t QR Code b\u1eb1ng \u1ee9ng d\u1ee5ng x\xe1c th\u1ef1c",description:"S\u1eed d\u1ee5ng Google Authenticator, Microsoft Authenticator, ho\u1eb7c \u1ee9ng d\u1ee5ng t\u01b0\u01a1ng t\u1ef1 \u0111\u1ec3 qu\xe9t m\xe3 QR.",type:"info",showIcon:!0,style:{marginBottom:"24px"}}),(0,C.jsx)("div",{style:{textAlign:"center",marginBottom:"24px"},children:(0,C.jsx)(j.A,{value:D,size:256,style:{margin:"0 auto"}})}),(0,C.jsxs)("div",{style:{marginBottom:"24px",textAlign:"center"},children:[(0,C.jsx)("p",{style:{marginBottom:"8px",fontWeight:"bold"},children:"Ho\u1eb7c nh\u1eadp m\xe3 th\u1ee7 c\xf4ng:"}),(0,C.jsx)(v.A,{value:d.manualEntryKey||d.secret,readOnly:!0,style:{maxWidth:"300px",textAlign:"center",fontFamily:"monospace",fontSize:"16px",letterSpacing:"2px"}})]}),(0,C.jsx)(y.A,{children:"Nh\u1eadp m\xe3 x\xe1c th\u1ef1c"}),(0,C.jsxs)("div",{style:{maxWidth:"400px",margin:"0 auto"},children:[(0,C.jsx)(v.A,{placeholder:"Nh\u1eadp m\xe3 6 ch\u1eef s\u1ed1 t\u1eeb \u1ee9ng d\u1ee5ng",value:T,onChange:e=>M(e.target.value),maxLength:6,style:{fontSize:"20px",textAlign:"center",letterSpacing:"4px",fontFamily:"monospace",marginBottom:"16px"}}),(0,C.jsxs)(s.A,{style:{width:"100%",justifyContent:"center"},children:[(0,C.jsx)(A.Ay,{onClick:()=>{t(0),h(null),M("")},icon:(0,C.jsx)(w.A,{}),children:"Quay l\u1ea1i"}),(0,C.jsx)(A.Ay,{type:"primary",onClick:async()=>{if(T){r(!0);try{await k.Ay.enableMFA(T),o(!0),t(2),g.Ay.success("MFA \u0111\xe3 \u0111\u01b0\u1ee3c k\xedch ho\u1ea1t th\xe0nh c\xf4ng!"),await E()}catch(e){g.Ay.error(e.message||"Kh\xf4ng th\u1ec3 k\xedch ho\u1ea1t MFA. Vui l\xf2ng ki\u1ec3m tra m\xe3 x\xe1c th\u1ef1c.")}finally{r(!1)}}else g.Ay.warning("Vui l\xf2ng nh\u1eadp m\xe3 x\xe1c th\u1ef1c")},loading:n,disabled:6!==T.length,icon:(0,C.jsx)(b.A,{}),children:"K\xedch ho\u1ea1t MFA"})]})]})]}),2===e&&(0,C.jsx)("div",{className:"mfa-step-content",children:(0,C.jsxs)("div",{style:{textAlign:"center"},children:[(0,C.jsx)(b.A,{style:{fontSize:"64px",color:"#52c41a"}}),(0,C.jsx)("h3",{style:{marginTop:"16px",color:"#52c41a"},children:"MFA \u0111\xe3 \u0111\u01b0\u1ee3c k\xedch ho\u1ea1t th\xe0nh c\xf4ng!"}),(0,C.jsx)("p",{style:{color:"#666",marginBottom:"24px"},children:"T\xe0i kho\u1ea3n c\u1ee7a b\u1ea1n gi\u1edd \u0111\xe3 \u0111\u01b0\u1ee3c b\u1ea3o v\u1ec7 b\u1eb1ng x\xe1c th\u1ef1c hai l\u1edbp. B\u1ea1n s\u1ebd c\u1ea7n nh\u1eadp m\xe3 x\xe1c th\u1ef1c m\u1ed7i khi \u0111\u0103ng nh\u1eadp."}),(0,C.jsx)(A.Ay,{type:"primary",onClick:()=>t(0),children:"Quay l\u1ea1i"})]})})]})})};var M=n(9682),F=n(88827),I=n(59970);const E=()=>{const[e,t]=(0,i.useState)(null),[n,r]=(0,i.useState)([{id:"google",name:"Google",icon:(0,C.jsx)(M.A,{}),color:"#4285F4"},{id:"github",name:"GitHub",icon:(0,C.jsx)(F.A,{}),color:"#24292e"},{id:"microsoft",name:"Microsoft",icon:(0,C.jsx)(I.A,{}),color:"#00A1F1"}]);(0,i.useEffect)(()=>{if("undefined"!==typeof window&&window.location){const e=new(window.URLSearchParams||URLSearchParams)(window.location.search),t=e.get("code"),n=e.get("state"),i=e.get("provider")||(n?n.split("_")[0]:null);t&&i&&o(i,t,n)}},[]);const o=async(e,n,i)=>{t(e);try{const t=await k.Ay.handleSSOCallback(e,n,i);null!==t&&void 0!==t&&t.token?(g.Ay.success("\u0110\u0103ng nh\u1eadp ".concat(e," th\xe0nh c\xf4ng!")),setTimeout(()=>{window.location.href="/"},1e3)):g.Ay.error("\u0110\u0103ng nh\u1eadp ".concat(e," th\u1ea5t b\u1ea1i"))}catch(s){console.error("SSO callback error for ".concat(e,":"),s),g.Ay.error(s.message||"\u0110\u0103ng nh\u1eadp ".concat(e," th\u1ea5t b\u1ea1i"))}finally{t(null),window.history.replaceState({},document.title,window.location.pathname)}};return(0,C.jsx)("div",{className:"security-container",children:(0,C.jsxs)(l.A,{title:(0,C.jsxs)(s.A,{children:[(0,C.jsx)(c.A,{}),(0,C.jsx)("span",{children:"\u0110\u0103ng nh\u1eadp b\u1eb1ng SSO"})]}),className:"security-card",children:[(0,C.jsx)(m.A,{message:"\u0110\u0103ng nh\u1eadp nhanh v\xe0 an to\xe0n",description:"S\u1eed d\u1ee5ng t\xe0i kho\u1ea3n Google, GitHub, ho\u1eb7c Microsoft \u0111\u1ec3 \u0111\u0103ng nh\u1eadp. Kh\xf4ng c\u1ea7n nh\u1edb m\u1eadt kh\u1ea9u ri\xeang.",type:"info",icon:(0,C.jsx)(a.A,{}),showIcon:!0,style:{marginBottom:"24px"}}),(0,C.jsx)("div",{className:"sso-buttons-container",children:(0,C.jsx)(s.A,{direction:"vertical",size:"middle",style:{width:"100%"},children:n.map(n=>(0,C.jsxs)(A.Ay,{type:"primary",size:"large",icon:n.icon,loading:e===n.id,onClick:()=>(async e=>{t(e);try{const n=await k.Ay.getSSOAuthUrl(e);null!==n&&void 0!==n&&n.authUrl?window.location.href=n.authUrl:(g.Ay.error("Kh\xf4ng th\u1ec3 l\u1ea5y URL x\xe1c th\u1ef1c t\u1eeb ".concat(e)),t(null))}catch(n){console.error("SSO login error for ".concat(e,":"),n),g.Ay.error(n.message||"\u0110\u0103ng nh\u1eadp ".concat(e," th\u1ea5t b\u1ea1i")),t(null)}})(n.id),style:{width:"100%",height:"50px",backgroundColor:e===n.id?"#d9d9d9":n.color,borderColor:n.color,display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},disabled:null!==e,children:["\u0110\u0103ng nh\u1eadp v\u1edbi ",n.name]},n.id))})}),(0,C.jsx)(y.A,{children:"Ho\u1eb7c"}),(0,C.jsx)("div",{style:{textAlign:"center",color:"#666"},children:(0,C.jsxs)("p",{children:["B\u1ea1n c\xf3 th\u1ec3 s\u1eed d\u1ee5ng email v\xe0 m\u1eadt kh\u1ea9u \u0111\u1ec3 \u0111\u0103ng nh\u1eadp"," ",(0,C.jsx)("a",{href:"/login",children:"t\u1ea1i \u0111\xe2y"})]})}),e&&(0,C.jsxs)("div",{style:{textAlign:"center",marginTop:"24px"},children:[(0,C.jsx)(p.A,{size:"large"}),(0,C.jsx)("p",{style:{marginTop:"16px",color:"#666"},children:"\u0110ang chuy\u1ec3n h\u01b0\u1edbng \u0111\u1ebfn nh\xe0 cung c\u1ea5p..."})]})]})})};var D=n(9690),N=n(27340),L=n(79253),B=n(6319),O=n(58543),U=n(97432),K=n(52069),z=n(85521),P=n(97042),Y=n(8905);const{Option:V}=D.A,Q={admin:"red",manager:"orange",user:"blue",guest:"default"},G={admin:"Qu\u1ea3n tr\u1ecb vi\xean",manager:"Qu\u1ea3n l\xfd",user:"Ng\u01b0\u1eddi d\xf9ng",guest:"Kh\xe1ch"},H=()=>{const[e,t]=(0,i.useState)([]),[n,r]=(0,i.useState)(!1),[a,c]=(0,i.useState)(""),[d,h]=(0,i.useState)(null),[u,x]=(0,i.useState)(!1),[p,m]=(0,i.useState)(null);(0,i.useEffect)(()=>{y()},[]);const y=async()=>{r(!0);try{const e=await k.Ay.getAllUsers();t(Array.isArray(e)?e:(null===e||void 0===e?void 0:e.users)||[])}catch(e){console.error("Load users error:",e),g.Ay.error("Kh\xf4ng th\u1ec3 t\u1ea3i danh s\xe1ch ng\u01b0\u1eddi d\xf9ng")}finally{r(!1)}},j=e.filter(e=>{var t,n,i;if(!a)return!0;const s=a.toLowerCase();return(null===(t=e.email)||void 0===t?void 0:t.toLowerCase().includes(s))||(null===(n=e.role)||void 0===n?void 0:n.toLowerCase().includes(s))||(null===(i=e.id)||void 0===i?void 0:i.toString().includes(s))}),b=[{title:"Email",dataIndex:"email",key:"email",render:(e,t)=>(0,C.jsxs)(s.A,{children:[(0,C.jsx)(o.A,{}),(0,C.jsx)("span",{children:e||"N/A"}),t.mfaEnabled&&(0,C.jsx)(N.A,{title:"MFA \u0111\xe3 k\xedch ho\u1ea1t",children:(0,C.jsx)(L.A,{status:"success"})})]}),sorter:(e,t)=>(e.email||"").localeCompare(t.email||"")},{title:"Vai tr\xf2",dataIndex:"role",key:"role",render:e=>(0,C.jsx)(B.A,{color:Q[e]||"default",children:G[e]||e}),filters:Object.keys(G).map(e=>({text:G[e],value:e})),onFilter:(e,t)=>t.role===e},{title:"MFA",dataIndex:"mfaEnabled",key:"mfaEnabled",render:e=>(0,C.jsx)(B.A,{color:e?"green":"default",children:e?"\u0110\xe3 b\u1eadt":"Ch\u01b0a b\u1eadt"}),filters:[{text:"\u0110\xe3 b\u1eadt",value:!0},{text:"Ch\u01b0a b\u1eadt",value:!1}],onFilter:(e,t)=>t.mfaEnabled===e},{title:"Quy\u1ec1n",dataIndex:"permissions",key:"permissions",render:e=>e&&Array.isArray(e)?(0,C.jsxs)(s.A,{wrap:!0,children:[e.slice(0,3).map(e=>(0,C.jsx)(B.A,{color:"blue",children:e},e)),e.length>3&&(0,C.jsxs)(B.A,{color:"default",children:["+",e.length-3]})]}):"N/A"},{title:"H\xe0nh \u0111\u1ed9ng",key:"action",render:(e,t)=>(0,C.jsxs)(s.A,{children:[(0,C.jsx)(N.A,{title:"Ch\u1ec9nh s\u1eeda vai tr\xf2",children:(0,C.jsx)(A.Ay,{type:"link",icon:(0,C.jsx)(z.A,{}),onClick:()=>{return h(e=t),m(e.role),void x(!0);var e},children:"S\u1eeda"})}),(0,C.jsx)(O.A,{title:"B\u1ea1n c\xf3 ch\u1eafc mu\u1ed1n x\xf3a ng\u01b0\u1eddi d\xf9ng ".concat(t.email,"?"),description:"H\xe0nh \u0111\u1ed9ng n\xe0y kh\xf4ng th\u1ec3 ho\xe0n t\xe1c.",onConfirm:()=>(async(e,t)=>{r(!0);try{await k.Ay.deleteUser(e),g.Ay.success("\u0110\xe3 x\xf3a ng\u01b0\u1eddi d\xf9ng ".concat(t)),await y()}catch(n){console.error("Delete user error:",n),g.Ay.error(n.message||"Kh\xf4ng th\u1ec3 x\xf3a ng\u01b0\u1eddi d\xf9ng")}finally{r(!1)}})(t.id,t.email),okText:"X\xf3a",cancelText:"H\u1ee7y",okButtonProps:{danger:!0},children:(0,C.jsx)(N.A,{title:"X\xf3a ng\u01b0\u1eddi d\xf9ng",children:(0,C.jsx)(A.Ay,{type:"link",danger:!0,icon:(0,C.jsx)(P.A,{}),disabled:"admin"===t.role,children:"X\xf3a"})})})]})}];return(0,C.jsx)("div",{className:"security-container",children:(0,C.jsxs)(l.A,{title:(0,C.jsxs)(s.A,{children:[(0,C.jsx)(o.A,{}),(0,C.jsx)("span",{children:"Qu\u1ea3n l\xfd ng\u01b0\u1eddi d\xf9ng"})]}),className:"security-card",extra:(0,C.jsxs)(s.A,{children:[(0,C.jsx)(v.A,{placeholder:"T\xecm ki\u1ebfm email, vai tr\xf2...",prefix:(0,C.jsx)(Y.A,{}),value:a,onChange:e=>c(e.target.value),style:{width:"250px"},allowClear:!0}),(0,C.jsx)(A.Ay,{icon:(0,C.jsx)(w.A,{}),onClick:y,loading:n,children:"L\xe0m m\u1edbi"})]}),children:[(0,C.jsx)(U.A,{columns:b,dataSource:j,rowKey:"id",loading:n,pagination:{pageSize:10,showSizeChanger:!0,showTotal:e=>"T\u1ed5ng ".concat(e," ng\u01b0\u1eddi d\xf9ng")}}),(0,C.jsx)(K.A,{title:(0,C.jsxs)(s.A,{children:[(0,C.jsx)(z.A,{}),(0,C.jsx)("span",{children:"Ch\u1ec9nh s\u1eeda vai tr\xf2 ng\u01b0\u1eddi d\xf9ng"})]}),open:u,onOk:async()=>{if(d&&p){r(!0);try{await k.Ay.updateUserRole(d.id,p),g.Ay.success("\u0110\xe3 c\u1eadp nh\u1eadt vai tr\xf2 c\u1ee7a ".concat(d.email)),x(!1),h(null),m(null),await y()}catch(e){console.error("Update role error:",e),g.Ay.error(e.message||"Kh\xf4ng th\u1ec3 c\u1eadp nh\u1eadt vai tr\xf2")}finally{r(!1)}}else g.Ay.warning("Vui l\xf2ng ch\u1ecdn vai tr\xf2 m\u1edbi")},onCancel:()=>{x(!1),h(null),m(null)},confirmLoading:n,children:d&&(0,C.jsxs)("div",{children:[(0,C.jsxs)("p",{children:[(0,C.jsx)("strong",{children:"Email:"})," ",d.email]}),(0,C.jsxs)("p",{style:{marginTop:"16px",marginBottom:"8px"},children:[(0,C.jsx)("strong",{children:"Vai tr\xf2 hi\u1ec7n t\u1ea1i:"})," ",(0,C.jsx)(B.A,{color:Q[d.role],children:G[d.role]})]}),(0,C.jsx)("p",{style:{marginTop:"16px",marginBottom:"8px"},children:(0,C.jsx)("strong",{children:"Vai tr\xf2 m\u1edbi:"})}),(0,C.jsx)(D.A,{value:p,onChange:m,style:{width:"100%"},placeholder:"Ch\u1ecdn vai tr\xf2 m\u1edbi",children:Object.keys(G).map(e=>(0,C.jsx)(V,{value:e,children:(0,C.jsx)(B.A,{color:Q[e],children:G[e]})},e))})]})})]})})};var R=n(89379),X=n(76552),q=n(93509),W=n(84211),_=n(68663),J=n(85862),Z=n(47884),$=n(48075),ee=n(50809),te=(n(93288),n(60497));const{RangePicker:ne}=X.A,{Option:ie}=D.A,se={"login:success":"\u0110\u0103ng nh\u1eadp th\xe0nh c\xf4ng","login:failure":"\u0110\u0103ng nh\u1eadp th\u1ea5t b\u1ea1i",logout:"\u0110\u0103ng xu\u1ea5t","mfa:enabled":"B\u1eadt MFA","mfa:disabled":"T\u1eaft MFA","mfa:verified":"X\xe1c th\u1ef1c MFA","mfa:failed":"MFA th\u1ea5t b\u1ea1i","sso:login":"\u0110\u0103ng nh\u1eadp SSO","password:changed":"\u0110\u1ed5i m\u1eadt kh\u1ea9u","permission:denied":"T\u1eeb ch\u1ed1i quy\u1ec1n","role:changed":"Thay \u0111\u1ed5i vai tr\xf2","access:granted":"C\u1ea5p quy\u1ec1n truy c\u1eadp","access:revoked":"Thu h\u1ed3i quy\u1ec1n","data:read":"\u0110\u1ecdc d\u1eef li\u1ec7u","data:write":"Ghi d\u1eef li\u1ec7u","data:delete":"X\xf3a d\u1eef li\u1ec7u","data:export":"Xu\u1ea5t d\u1eef li\u1ec7u","user:created":"T\u1ea1o ng\u01b0\u1eddi d\xf9ng","user:updated":"C\u1eadp nh\u1eadt ng\u01b0\u1eddi d\xf9ng","user:deleted":"X\xf3a ng\u01b0\u1eddi d\xf9ng","config:changed":"Thay \u0111\u1ed5i c\u1ea5u h\xecnh","system:error":"L\u1ed7i h\u1ec7 th\u1ed1ng","compliance:check":"Ki\u1ec3m tra tu\xe2n th\u1ee7","data:backup":"Sao l\u01b0u d\u1eef li\u1ec7u","data:restore":"Kh\xf4i ph\u1ee5c d\u1eef li\u1ec7u"},le={low:"default",medium:"blue",high:"orange",critical:"red"},re={success:"green",failure:"red",warning:"orange",info:"blue"},ae=()=>{var e,t;const[n,r]=(0,i.useState)([]),[a,c]=(0,i.useState)(!1),[o,h]=(0,i.useState)(null),[u,x]=(0,i.useState)(null),[p,m]=(0,i.useState)(!1),[y,j]=(0,i.useState)({eventType:null,severity:null,status:null,userEmail:"",startDate:null,endDate:null,limit:100});(0,i.useEffect)(()=>{b(),f()},[]);const b=async()=>{c(!0);try{const e=(0,R.A)((0,R.A)({},y),{},{startDate:y.startDate?y.startDate.format("YYYY-MM-DD"):null,endDate:y.endDate?y.endDate.format("YYYY-MM-DD"):null});Object.keys(e).forEach(t=>{null!==e[t]&&""!==e[t]&&void 0!==e[t]||delete e[t]});const t=await k.Ay.queryAuditLogs(e);r(Array.isArray(null===t||void 0===t?void 0:t.logs)?t.logs:[])}catch(e){console.error("Load audit logs error:",e),g.Ay.error("Kh\xf4ng th\u1ec3 t\u1ea3i audit logs")}finally{c(!1)}},f=async()=>{try{const e=await k.Ay.getAuditStatistics({startDate:y.startDate?y.startDate.format("YYYY-MM-DD"):null,endDate:y.endDate?y.endDate.format("YYYY-MM-DD"):null});h(e)}catch(e){console.error("Load statistics error:",e)}},S=(e,t)=>{j((0,R.A)((0,R.A)({},y),{},{[e]:t}))},T=[{title:"Th\u1eddi gian",dataIndex:"timestampFormatted",key:"timestamp",render:(e,t)=>(0,C.jsx)(N.A,{title:t.timestamp,children:(0,C.jsx)("span",{children:e||t.timestamp})}),sorter:(e,t)=>new Date(e.timestamp).getTime()-new Date(t.timestamp).getTime(),width:180},{title:"Lo\u1ea1i s\u1ef1 ki\u1ec7n",dataIndex:"eventType",key:"eventType",render:e=>(0,C.jsx)(B.A,{children:se[e]||e}),filters:Object.keys(se).map(e=>({text:se[e],value:e})),onFilter:(e,t)=>t.eventType===e,width:200},{title:"M\u1ee9c \u0111\u1ed9",dataIndex:"severity",key:"severity",render:e=>(0,C.jsx)(B.A,{color:le[e]||"default",children:null===e||void 0===e?void 0:e.toUpperCase()}),filters:Object.keys(le).map(e=>({text:e.toUpperCase(),value:e})),onFilter:(e,t)=>t.severity===e,width:100},{title:"Tr\u1ea1ng th\xe1i",dataIndex:"status",key:"status",render:e=>(0,C.jsx)(B.A,{color:re[e]||"default",children:null===e||void 0===e?void 0:e.toUpperCase()}),filters:Object.keys(re).map(e=>({text:e.toUpperCase(),value:e})),onFilter:(e,t)=>t.status===e,width:100},{title:"Ng\u01b0\u1eddi d\xf9ng",dataIndex:"userEmail",key:"userEmail",render:e=>e||"N/A",width:200},{title:"IP Address",dataIndex:"ipAddress",key:"ipAddress",render:e=>e||"N/A",width:150},{title:"H\xe0nh \u0111\u1ed9ng",key:"action",render:(e,t)=>(0,C.jsx)(A.Ay,{type:"link",icon:(0,C.jsx)(Z.A,{}),onClick:()=>(x(t),void m(!0)),children:"Chi ti\u1ebft"}),width:100}];return(0,C.jsx)("div",{className:"security-container",children:(0,C.jsxs)(l.A,{title:(0,C.jsxs)(s.A,{children:[(0,C.jsx)(d.A,{}),(0,C.jsx)("span",{children:"Audit Logs Viewer"})]}),className:"security-card",children:[o&&(0,C.jsxs)(q.A,{gutter:16,style:{marginBottom:"24px"},children:[(0,C.jsx)(W.A,{span:6,children:(0,C.jsx)(_.A,{title:"T\u1ed5ng s\u1ef1 ki\u1ec7n",value:o.totalEvents||0})}),(0,C.jsx)(W.A,{span:6,children:(0,C.jsx)(_.A,{title:"S\u1ef1 ki\u1ec7n th\xe0nh c\xf4ng",value:o.successCount||0,valueStyle:{color:"#3f8600"}})}),(0,C.jsx)(W.A,{span:6,children:(0,C.jsx)(_.A,{title:"S\u1ef1 ki\u1ec7n th\u1ea5t b\u1ea1i",value:o.failureCount||0,valueStyle:{color:"#cf1322"}})}),(0,C.jsx)(W.A,{span:6,children:(0,C.jsx)(_.A,{title:"S\u1ef1 ki\u1ec7n quan tr\u1ecdng",value:o.criticalCount||0,valueStyle:{color:"#ff4d4f"}})})]}),(0,C.jsx)(l.A,{title:(0,C.jsxs)(s.A,{children:[(0,C.jsx)($.A,{}),(0,C.jsx)("span",{children:"B\u1ed9 l\u1ecdc"})]}),style:{marginBottom:"24px"},children:(0,C.jsxs)(s.A,{wrap:!0,style:{width:"100%"},children:[(0,C.jsx)(D.A,{placeholder:"Lo\u1ea1i s\u1ef1 ki\u1ec7n",style:{width:200},allowClear:!0,value:y.eventType,onChange:e=>S("eventType",e),children:Object.entries(se).map(e=>{let[t,n]=e;return(0,C.jsx)(ie,{value:t,children:n},t)})}),(0,C.jsx)(D.A,{placeholder:"M\u1ee9c \u0111\u1ed9",style:{width:150},allowClear:!0,value:y.severity,onChange:e=>S("severity",e),children:Object.keys(le).map(e=>(0,C.jsx)(ie,{value:e,children:e.toUpperCase()},e))}),(0,C.jsx)(D.A,{placeholder:"Tr\u1ea1ng th\xe1i",style:{width:150},allowClear:!0,value:y.status,onChange:e=>S("status",e),children:Object.keys(re).map(e=>(0,C.jsx)(ie,{value:e,children:e.toUpperCase()},e))}),(0,C.jsx)(v.A,{placeholder:"Email ng\u01b0\u1eddi d\xf9ng",style:{width:200},value:y.userEmail,onChange:e=>S("userEmail",e.target.value),allowClear:!0}),(0,C.jsx)(ne,{placeholder:["Ng\xe0y b\u1eaft \u0111\u1ea7u","Ng\xe0y k\u1ebft th\xfac"],value:[y.startDate,y.endDate],onChange:e=>{S("startDate",(null===e||void 0===e?void 0:e[0])||null),S("endDate",(null===e||void 0===e?void 0:e[1])||null)}}),(0,C.jsx)(A.Ay,{type:"primary",icon:(0,C.jsx)($.A,{}),onClick:()=>{b(),f()},children:"\xc1p d\u1ee5ng"}),(0,C.jsx)(A.Ay,{icon:(0,C.jsx)(w.A,{}),onClick:()=>{j({eventType:null,severity:null,status:null,userEmail:"",startDate:null,endDate:null,limit:100}),setTimeout(()=>{b(),f()},100)},children:"\u0110\u1eb7t l\u1ea1i"})]})}),(0,C.jsxs)(s.A,{style:{marginBottom:"16px"},children:[(0,C.jsx)(A.Ay,{icon:(0,C.jsx)(w.A,{}),onClick:()=>{b(),f()},loading:a,children:"L\xe0m m\u1edbi"}),(0,C.jsx)(A.Ay,{icon:(0,C.jsx)(ee.A,{}),onClick:()=>{try{const e=n.map(e=>({"Th\u1eddi gian":e.timestampFormatted||e.timestamp,"Lo\u1ea1i s\u1ef1 ki\u1ec7n":se[e.eventType]||e.eventType,"M\u1ee9c \u0111\u1ed9":e.severity,"Tr\u1ea1ng th\xe1i":e.status,Email:e.userEmail||"N/A",IP:e.ipAddress||"N/A","T\xe0i nguy\xean":e.resource||"N/A","H\xe0nh \u0111\u1ed9ng":e.action||"N/A"}));(0,te.GF)(e,"audit-logs"),g.Ay.success("\u0110\xe3 xu\u1ea5t audit logs ra CSV")}catch(e){g.Ay.error("Kh\xf4ng th\u1ec3 xu\u1ea5t file")}},disabled:0===n.length,children:"Xu\u1ea5t CSV"})]}),(0,C.jsx)(U.A,{columns:T,dataSource:n,rowKey:"id",loading:a,pagination:{pageSize:20,showSizeChanger:!0,showTotal:e=>"T\u1ed5ng ".concat(e," logs")}}),(0,C.jsx)(K.A,{title:"Chi ti\u1ebft Audit Log",open:p,onCancel:()=>m(!1),footer:null,width:800,children:u&&(0,C.jsxs)(J.A,{bordered:!0,column:2,children:[(0,C.jsx)(J.A.Item,{label:"ID",span:2,children:u.id}),(0,C.jsx)(J.A.Item,{label:"Th\u1eddi gian",children:u.timestampFormatted||u.timestamp}),(0,C.jsx)(J.A.Item,{label:"Lo\u1ea1i s\u1ef1 ki\u1ec7n",children:(0,C.jsx)(B.A,{children:se[u.eventType]||u.eventType})}),(0,C.jsx)(J.A.Item,{label:"M\u1ee9c \u0111\u1ed9",children:(0,C.jsx)(B.A,{color:le[u.severity],children:null===(e=u.severity)||void 0===e?void 0:e.toUpperCase()})}),(0,C.jsx)(J.A.Item,{label:"Tr\u1ea1ng th\xe1i",children:(0,C.jsx)(B.A,{color:re[u.status],children:null===(t=u.status)||void 0===t?void 0:t.toUpperCase()})}),(0,C.jsx)(J.A.Item,{label:"Email ng\u01b0\u1eddi d\xf9ng",children:u.userEmail||"N/A"}),(0,C.jsx)(J.A.Item,{label:"User ID",children:u.userId||"N/A"}),(0,C.jsx)(J.A.Item,{label:"IP Address",children:u.ipAddress||"N/A"}),(0,C.jsx)(J.A.Item,{label:"User Agent",span:2,children:u.userAgent||"N/A"}),(0,C.jsx)(J.A.Item,{label:"T\xe0i nguy\xean",children:u.resource||"N/A"}),(0,C.jsx)(J.A.Item,{label:"H\xe0nh \u0111\u1ed9ng",children:u.action||"N/A"}),(0,C.jsx)(J.A.Item,{label:"Chi ti\u1ebft",span:2,children:(0,C.jsx)("pre",{style:{maxHeight:"200px",overflow:"auto"},children:JSON.stringify(u.details||{},null,2)})}),(0,C.jsx)(J.A.Item,{label:"Metadata",span:2,children:(0,C.jsx)("pre",{style:{maxHeight:"200px",overflow:"auto"},children:JSON.stringify(u.metadata||{},null,2)})})]})})]})})};var ce=n(85289),oe=n(70750),de=n(94612),he=n(70717),ue=n(11400);const xe=()=>{const[e,t]=(0,i.useState)(!1),[n,r]=(0,i.useState)(null),[c]=ce.A.useForm();(0,i.useEffect)(()=>{o()},[]);const o=async()=>{t(!0);try{const e=await k.Ay.getCurrentUser(),t=(null===e||void 0===e?void 0:e.user)||e;r(t),c.setFieldsValue({sessionTimeout:30,passwordMinLength:8,requireMFA:(null===t||void 0===t?void 0:t.mfaEnabled)||!1,enableAuditLogging:!0})}catch(e){console.error("Load user profile error:",e),g.Ay.error("Kh\xf4ng th\u1ec3 t\u1ea3i th\xf4ng tin ng\u01b0\u1eddi d\xf9ng")}finally{t(!1)}};return e&&!n?(0,C.jsx)("div",{style:{textAlign:"center",padding:"40px"},children:(0,C.jsx)(p.A,{size:"large"})}):(0,C.jsx)("div",{className:"security-container",children:(0,C.jsx)(l.A,{title:(0,C.jsxs)(s.A,{children:[(0,C.jsx)(h.A,{}),(0,C.jsx)("span",{children:"C\xe0i \u0111\u1eb7t b\u1ea3o m\u1eadt"})]}),className:"security-card",children:(0,C.jsxs)(ce.A,{form:c,layout:"vertical",onFinish:async e=>{t(!0);try{console.log("Settings to save:",e),g.Ay.success("\u0110\xe3 l\u01b0u c\xe0i \u0111\u1eb7t b\u1ea3o m\u1eadt")}catch(n){console.error("Save settings error:",n),g.Ay.error("Kh\xf4ng th\u1ec3 l\u01b0u c\xe0i \u0111\u1eb7t")}finally{t(!1)}},initialValues:{sessionTimeout:30,passwordMinLength:8,requireMFA:(null===n||void 0===n?void 0:n.mfaEnabled)||!1,enableAuditLogging:!0},children:[(0,C.jsx)(l.A,{type:"inner",title:(0,C.jsxs)(s.A,{children:[(0,C.jsx)(a.A,{}),(0,C.jsx)("span",{children:"Tr\u1ea1ng th\xe1i b\u1ea3o m\u1eadt hi\u1ec7n t\u1ea1i"})]}),style:{marginBottom:"24px"},children:(0,C.jsxs)(J.A,{bordered:!0,column:2,children:[(0,C.jsx)(J.A.Item,{label:"MFA",children:(0,C.jsx)(B.A,{color:null!==n&&void 0!==n&&n.mfaEnabled?"green":"default",children:null!==n&&void 0!==n&&n.mfaEnabled?"\u0110\xe3 b\u1eadt":"Ch\u01b0a b\u1eadt"})}),(0,C.jsx)(J.A.Item,{label:"Vai tr\xf2",children:(0,C.jsx)(B.A,{children:(null===n||void 0===n?void 0:n.role)||"N/A"})}),(0,C.jsx)(J.A.Item,{label:"Quy\u1ec1n",span:2,children:null!==n&&void 0!==n&&n.permissions&&Array.isArray(n.permissions)?(0,C.jsx)(s.A,{wrap:!0,children:n.permissions.map(e=>(0,C.jsx)(B.A,{color:"blue",children:e},e))}):"N/A"})]})}),(0,C.jsxs)(l.A,{type:"inner",title:(0,C.jsxs)(s.A,{children:[(0,C.jsx)(u.A,{}),(0,C.jsx)("span",{children:"Ch\xednh s\xe1ch m\u1eadt kh\u1ea9u"})]}),style:{marginBottom:"24px"},children:[(0,C.jsx)(ce.A.Item,{name:"passwordMinLength",label:"\u0110\u1ed9 d\xe0i m\u1eadt kh\u1ea9u t\u1ed1i thi\u1ec3u",tooltip:"S\u1ed1 k\xfd t\u1ef1 t\u1ed1i thi\u1ec3u cho m\u1eadt kh\u1ea9u",children:(0,C.jsxs)(s.A.Compact,{style:{width:"100%"},children:[(0,C.jsx)(oe.A,{min:6,max:32,style:{width:"100%"}}),(0,C.jsx)(A.Ay,{disabled:!0,style:{minWidth:"80px"},children:"k\xfd t\u1ef1"})]})}),(0,C.jsx)(m.A,{message:"Khuy\u1ebfn ngh\u1ecb",description:"S\u1eed d\u1ee5ng m\u1eadt kh\u1ea9u c\xf3 \xedt nh\u1ea5t 12 k\xfd t\u1ef1, bao g\u1ed3m ch\u1eef hoa, ch\u1eef th\u01b0\u1eddng, s\u1ed1 v\xe0 k\xfd t\u1ef1 \u0111\u1eb7c bi\u1ec7t.",type:"info",showIcon:!0,style:{marginTop:"16px"}})]}),(0,C.jsxs)(l.A,{type:"inner",title:"C\xe0i \u0111\u1eb7t phi\xean \u0111\u0103ng nh\u1eadp",style:{marginBottom:"24px"},children:[(0,C.jsx)(ce.A.Item,{name:"sessionTimeout",label:"Th\u1eddi gian h\u1ebft h\u1ea1n phi\xean",tooltip:"S\u1ed1 ph\xfat tr\u01b0\u1edbc khi phi\xean \u0111\u0103ng nh\u1eadp t\u1ef1 \u0111\u1ed9ng h\u1ebft h\u1ea1n",children:(0,C.jsxs)(s.A.Compact,{style:{width:"100%"},children:[(0,C.jsx)(oe.A,{min:5,max:1440,style:{width:"100%"}}),(0,C.jsx)(A.Ay,{disabled:!0,style:{minWidth:"80px"},children:"ph\xfat"})]})}),(0,C.jsx)(m.A,{message:"B\u1ea3o m\u1eadt",description:"Phi\xean \u0111\u0103ng nh\u1eadp s\u1ebd t\u1ef1 \u0111\u1ed9ng h\u1ebft h\u1ea1n sau th\u1eddi gian kh\xf4ng ho\u1ea1t \u0111\u1ed9ng.",type:"warning",showIcon:!0,style:{marginTop:"16px"}})]}),(0,C.jsxs)(l.A,{type:"inner",title:(0,C.jsxs)(s.A,{children:[(0,C.jsx)(a.A,{}),(0,C.jsx)("span",{children:"X\xe1c th\u1ef1c hai l\u1edbp (MFA)"})]}),style:{marginBottom:"24px"},children:[(0,C.jsx)(ce.A.Item,{name:"requireMFA",label:"Y\xeau c\u1ea7u MFA",valuePropName:"checked",tooltip:"B\u1eadt y\xeau c\u1ea7u MFA cho t\u1ea5t c\u1ea3 \u0111\u0103ng nh\u1eadp",children:(0,C.jsx)(de.A,{})}),(0,C.jsx)(m.A,{message:null!==n&&void 0!==n&&n.mfaEnabled?"MFA \u0111\xe3 \u0111\u01b0\u1ee3c k\xedch ho\u1ea1t":"MFA ch\u01b0a \u0111\u01b0\u1ee3c k\xedch ho\u1ea1t",description:null!==n&&void 0!==n&&n.mfaEnabled?"T\xe0i kho\u1ea3n c\u1ee7a b\u1ea1n \u0111\xe3 \u0111\u01b0\u1ee3c b\u1ea3o v\u1ec7 b\u1eb1ng MFA.":"Vui l\xf2ng k\xedch ho\u1ea1t MFA \u0111\u1ec3 t\u0103ng c\u01b0\u1eddng b\u1ea3o m\u1eadt cho t\xe0i kho\u1ea3n.",type:null!==n&&void 0!==n&&n.mfaEnabled?"success":"warning",showIcon:!0,style:{marginTop:"16px"},action:!(null!==n&&void 0!==n&&n.mfaEnabled)&&(0,C.jsx)(A.Ay,{type:"link",href:"/security/mfa",size:"small",children:"K\xedch ho\u1ea1t ngay"})})]}),(0,C.jsxs)(l.A,{type:"inner",title:"Ghi nh\u1eadt k\xfd Audit",style:{marginBottom:"24px"},children:[(0,C.jsx)(ce.A.Item,{name:"enableAuditLogging",label:"B\u1eadt ghi nh\u1eadt k\xfd Audit",valuePropName:"checked",tooltip:"Ghi l\u1ea1i t\u1ea5t c\u1ea3 c\xe1c ho\u1ea1t \u0111\u1ed9ng quan tr\u1ecdng \u0111\u1ec3 tu\xe2n th\u1ee7 v\xe0 b\u1ea3o m\u1eadt",children:(0,C.jsx)(de.A,{disabled:!0})}),(0,C.jsx)(m.A,{message:"Lu\xf4n b\u1eadt",description:"Audit logging lu\xf4n \u0111\u01b0\u1ee3c b\u1eadt \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o tu\xe2n th\u1ee7 v\xe0 b\u1ea3o m\u1eadt.",type:"info",showIcon:!0,style:{marginTop:"16px"}})]}),(0,C.jsx)(l.A,{type:"inner",title:(0,C.jsxs)(s.A,{children:[(0,C.jsx)(he.A,{}),(0,C.jsx)("span",{children:"Th\xf4ng tin m\xe3 h\xf3a"})]}),style:{marginBottom:"24px"},children:(0,C.jsx)(m.A,{message:"M\xe3 h\xf3a d\u1eef li\u1ec7u",description:(0,C.jsxs)("div",{children:[(0,C.jsxs)("p",{children:[(0,C.jsx)("strong",{children:"M\xe3 h\xf3a khi l\u01b0u tr\u1eef:"})," AES-256-GCM"]}),(0,C.jsxs)("p",{children:[(0,C.jsx)("strong",{children:"M\xe3 h\xf3a khi truy\u1ec1n:"})," RSA"]}),(0,C.jsx)("p",{style:{marginBottom:0,color:"#666"},children:"T\u1ea5t c\u1ea3 d\u1eef li\u1ec7u nh\u1ea1y c\u1ea3m \u0111\u1ec1u \u0111\u01b0\u1ee3c m\xe3 h\xf3a t\u1ef1 \u0111\u1ed9ng."})]}),type:"success",showIcon:!0})}),(0,C.jsx)(y.A,{}),(0,C.jsx)(ce.A.Item,{children:(0,C.jsxs)(s.A,{children:[(0,C.jsx)(A.Ay,{type:"primary",htmlType:"submit",icon:(0,C.jsx)(ue.A,{}),loading:e,size:"large",children:"L\u01b0u c\xe0i \u0111\u1eb7t"}),(0,C.jsx)(A.Ay,{icon:(0,C.jsx)(w.A,{}),onClick:o,loading:e,children:"L\xe0m m\u1edbi"})]})})]})})})},ge=()=>{const[e,t]=(0,i.useState)("mfa"),n=[{key:"mfa",label:(0,C.jsxs)(s.A,{children:[(0,C.jsx)(a.A,{}),(0,C.jsx)("span",{children:"MFA Setup"})]}),children:(0,C.jsx)(T,{})},{key:"sso",label:(0,C.jsxs)(s.A,{children:[(0,C.jsx)(c.A,{}),(0,C.jsx)("span",{children:"SSO Login"})]}),children:(0,C.jsx)(E,{})},{key:"users",label:(0,C.jsxs)(s.A,{children:[(0,C.jsx)(o.A,{}),(0,C.jsx)("span",{children:"Qu\u1ea3n l\xfd ng\u01b0\u1eddi d\xf9ng"})]}),children:(0,C.jsx)(H,{})},{key:"audit",label:(0,C.jsxs)(s.A,{children:[(0,C.jsx)(d.A,{}),(0,C.jsx)("span",{children:"Audit Logs"})]}),children:(0,C.jsx)(ae,{})},{key:"settings",label:(0,C.jsxs)(s.A,{children:[(0,C.jsx)(h.A,{}),(0,C.jsx)("span",{children:"C\xe0i \u0111\u1eb7t"})]}),children:(0,C.jsx)(xe,{})}];return(0,C.jsx)("div",{className:"security-dashboard",children:(0,C.jsx)(l.A,{title:(0,C.jsxs)(s.A,{children:[(0,C.jsx)(u.A,{}),(0,C.jsx)("span",{children:"Enterprise Security Dashboard"})]}),className:"security-dashboard-card",children:(0,C.jsx)(r.A,{activeKey:e,onChange:t,type:"card",size:"large",items:n})})})}},60497:(e,t,n)=>{n.d(t,{GF:()=>l,Q7:()=>i,bJ:()=>s});const i=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"export";try{const n=window.open("","_blank"),i="\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <title>".concat(t,"</title>\n          <style>\n            body { font-family: Arial, sans-serif; padding: 20px; }\n            table { width: 100%; border-collapse: collapse; margin-top: 20px; }\n            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }\n            th { background-color: #f2f2f2; }\n            h1 { color: #333; }\n            @media print {\n              body { padding: 0; }\n              button { display: none; }\n            }\n          </style>\n        </head>\n        <body>\n          <h1>").concat(t,"</h1>\n          <p>Generated: ").concat((new Date).toLocaleString("vi-VN"),"</p>\n          <h2>Widgets (").concat(e.widgets.length,")</h2>\n          <table>\n            <thead>\n              <tr>\n                <th>ID</th>\n                <th>Title</th>\n                <th>Type</th>\n                <th>Data Points</th>\n              </tr>\n            </thead>\n            <tbody>\n              ").concat(e.widgets.map(e=>{var t;return"\n                <tr>\n                  <td>".concat(e.id,"</td>\n                  <td>").concat(e.title,"</td>\n                  <td>").concat(e.type,"</td>\n                  <td>").concat((null===(t=e.data)||void 0===t?void 0:t.length)||0,"</td>\n                </tr>\n              ")}).join(""),'\n            </tbody>\n          </table>\n          <button onclick="window.print()">Print / Save as PDF</button>\n        </body>\n      </html>\n    ');return n.document.write(i),n.document.close(),setTimeout(()=>{n.print()},250),!0}catch(n){throw console.error("PDF export error:",n),new Error("Failed to export to PDF")}},s=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"export";try{let n="ID,Title,Type,Data Points\n";e.widgets.forEach(e=>{var t;n+="".concat(e.id,',"').concat(e.title,'",').concat(e.type,",").concat((null===(t=e.data)||void 0===t?void 0:t.length)||0,"\n")});const i=new Blob(["\ufeff"+n],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),l=URL.createObjectURL(i);return s.setAttribute("href",l),s.setAttribute("download","".concat(t,".csv")),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s),!0}catch(n){throw console.error("Excel export error:",n),new Error("Failed to export to Excel")}},l=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"export";try{let n="";n+="Dashboard Export\n",n+="Generated: ".concat((new Date).toLocaleString("vi-VN"),"\n"),n+="\n",n+="Widgets\n",n+="ID,Title,Type,Data Points\n",e.widgets.forEach(e=>{var t;n+="".concat(e.id,',"').concat(e.title,'",').concat(e.type,",").concat((null===(t=e.data)||void 0===t?void 0:t.length)||0,"\n")}),n+="\n",e.widgets.forEach((e,t)=>{if(n+="\nWidget ".concat(t+1,": ").concat(e.title," (").concat(e.type,")\n"),e.data&&e.data.length>0){const t=Object.keys(e.data[0]).join(",");n+="".concat(t,"\n"),e.data.forEach(e=>{const t=Object.values(e).map(e=>"string"===typeof e?'"'.concat(e,'"'):e).join(",");n+="".concat(t,"\n")})}});const i=new Blob(["\ufeff"+n],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),l=URL.createObjectURL(i);return s.setAttribute("href",l),s.setAttribute("download","".concat(t,".csv")),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s),!0}catch(n){throw console.error("CSV export error:",n),new Error("Failed to export to CSV")}}}}]);
//# sourceMappingURL=security-dashboard.5ba6a88a.chunk.js.map