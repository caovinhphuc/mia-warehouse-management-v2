{"version":3,"file":"static/js/google-apps-script.c48676a5.chunk.js","mappings":"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","sources":["services/scriptService.js","components/google/GoogleAppsScriptIntegration.jsx"],"sourcesContent":["/**\n * Google Apps Script Service - K·∫øt n·ªëi v·ªõi Backend Script API\n */\n\nconst API_BASE_URL =\n  import.meta.env.VITE_API_URL ||\n  import.meta.env.REACT_APP_API_URL ||\n  \"http://localhost:3001\";\n\nclass ScriptService {\n  /**\n   * Execute Google Apps Script\n   */\n  async executeScript(scriptId, functionName = \"main\", parameters = []) {\n    try {\n      const response = await fetch(`${API_BASE_URL}/api/script/execute`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          scriptId,\n          functionName,\n          parameters,\n        }),\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new Error(\n          errorData.error || `Script execution failed: ${response.statusText}`,\n        );\n      }\n\n      return await response.json();\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.error(\"Error executing script:\", error);\n      throw error;\n    }\n  }\n\n  /**\n   * Execute inline script code\n   */\n  async executeInline(code, functionName = \"main\", parameters = []) {\n    try {\n      const response = await fetch(\n        `${API_BASE_URL}/api/script/execute-inline`,\n        {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n          },\n          body: JSON.stringify({\n            code,\n            functionName,\n            parameters,\n          }),\n        },\n      );\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new Error(\n          errorData.error ||\n            `Inline script execution failed: ${response.statusText}`,\n        );\n      }\n\n      return await response.json();\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.error(\"Error executing inline script:\", error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get script status\n   */\n  async getScriptStatus(scriptId) {\n    try {\n      const response = await fetch(\n        `${API_BASE_URL}/api/script/status/${scriptId}`,\n      );\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new Error(\n          errorData.error ||\n            `Failed to get script status: ${response.statusText}`,\n        );\n      }\n\n      return await response.json();\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.error(\"Error getting script status:\", error);\n      throw error;\n    }\n  }\n\n  /**\n   * List script projects\n   */\n  async listProjects() {\n    try {\n      const response = await fetch(`${API_BASE_URL}/api/script/projects`);\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new Error(\n          errorData.error || `Failed to list projects: ${response.statusText}`,\n        );\n      }\n\n      return await response.json();\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.error(\"Error listing projects:\", error);\n      throw error;\n    }\n  }\n\n  /**\n   * Test script (validation)\n   */\n  async testScript(scriptId, functionName = \"main\", parameters = []) {\n    try {\n      const response = await fetch(`${API_BASE_URL}/api/script/test`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          scriptId,\n          functionName,\n          parameters,\n        }),\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new Error(\n          errorData.error || `Script test failed: ${response.statusText}`,\n        );\n      }\n\n      return await response.json();\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.error(\"Error testing script:\", error);\n      throw error;\n    }\n  }\n}\n\n// Export singleton instance\nexport const scriptService = new ScriptService();\nexport default scriptService;\n","import React, { useState, useEffect } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport Loading from \"../Common/Loading\";\nimport { scriptService } from \"../../services/scriptService\";\nimport { message } from \"antd\";\nimport \"./GoogleAppsScriptIntegration.css\";\n\nconst GoogleAppsScriptIntegration = () => {\n  const { loading, error } = useSelector((state) => state.auth);\n  const { isAuthenticated, serviceAccount } = useSelector(\n    (state) => state.auth,\n  );\n\n  const [scripts, setScripts] = useState([]);\n  const [selectedScript, setSelectedScript] = useState(null);\n  const [scriptCode, setScriptCode] = useState(\"\");\n  const [isRunning, setIsRunning] = useState(false);\n  const [executionLogs, setExecutionLogs] = useState([]);\n  const [showCreateModal, setShowCreateModal] = useState(false);\n  const [newScriptName, setNewScriptName] = useState(\"\");\n  const [newScriptDescription, setNewScriptDescription] = useState(\"\");\n\n  // Sample scripts\n  const sampleScripts = [\n    {\n      id: \"script_1\",\n      name: \"T·ª± ƒë·ªông g·ª≠i email b√°o c√°o\",\n      description: \"G·ª≠i email b√°o c√°o h√†ng ng√†y cho qu·∫£n l√Ω\",\n      lastModified: \"2024-01-15T10:30:00Z\",\n      status: \"active\",\n      executions: 45,\n      code: `function sendDailyReport() {\n  const sheet = SpreadsheetApp.getActiveSheet();\n  const data = sheet.getDataRange().getValues();\n\n  // T·∫°o b√°o c√°o\n  let report = \"B√°o c√°o h√†ng ng√†y:\\\\n\\\\n\";\n  report += \"T·ªïng s·ªë ƒë∆°n h√†ng: \" + data.length + \"\\\\n\";\n  report += \"Ng√†y: \" + new Date().toLocaleDateString('vi-VN');\n\n  // G·ª≠i email\n  MailApp.sendEmail({\n    to: 'manager@mia.vn',\n    subject: 'B√°o c√°o h√†ng ng√†y - ' + new Date().toLocaleDateString('vi-VN'),\n    body: report\n  });\n\n  console.log('Email ƒë√£ ƒë∆∞·ª£c g·ª≠i th√†nh c√¥ng');\n}`,\n    },\n    {\n      id: \"script_2\",\n      name: \"ƒê·ªìng b·ªô d·ªØ li·ªáu Google Sheets\",\n      description: \"ƒê·ªìng b·ªô d·ªØ li·ªáu gi·ªØa c√°c sheet kh√°c nhau\",\n      lastModified: \"2024-01-14T15:45:00Z\",\n      status: \"active\",\n      executions: 23,\n      code: `function syncSheetsData() {\n  const sourceSheet = SpreadsheetApp.openById('SOURCE_SHEET_ID').getActiveSheet();\n  const targetSheet = SpreadsheetApp.openById('TARGET_SHEET_ID').getActiveSheet();\n\n  const data = sourceSheet.getDataRange().getValues();\n  targetSheet.getRange(1, 1, data.length, data[0].length).setValues(data);\n\n  console.log('D·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c ƒë·ªìng b·ªô th√†nh c√¥ng');\n}`,\n    },\n    {\n      id: \"script_3\",\n      name: \"T·ª± ƒë·ªông backup d·ªØ li·ªáu\",\n      description: \"T·∫°o backup d·ªØ li·ªáu h√†ng tu·∫ßn\",\n      lastModified: \"2024-01-13T09:20:00Z\",\n      status: \"inactive\",\n      executions: 8,\n      code: `function weeklyBackup() {\n  const sheet = SpreadsheetApp.getActiveSheet();\n  const data = sheet.getDataRange().getValues();\n\n  // T·∫°o file backup\n  const backupSheet = SpreadsheetApp.create('Backup_' + new Date().getTime());\n  backupSheet.getActiveSheet().getRange(1, 1, data.length, data[0].length).setValues(data);\n\n  console.log('Backup ƒë√£ ƒë∆∞·ª£c t·∫°o th√†nh c√¥ng');\n}`,\n    },\n  ];\n\n  useEffect(() => {\n    setScripts(sampleScripts);\n  }, []);\n\n  const handleScriptSelect = (script) => {\n    setSelectedScript(script);\n    setScriptCode(script.code);\n  };\n\n  const handleRunScript = async () => {\n    if (!selectedScript) return;\n\n    setIsRunning(true);\n    setExecutionLogs([]);\n\n    try {\n      // Add initial log\n      setExecutionLogs([\n        {\n          time: new Date().toISOString(),\n          message: \"B·∫Øt ƒë·∫ßu th·ª±c thi script...\",\n          type: \"info\",\n        },\n      ]);\n\n      // If script has scriptId, use it; otherwise try inline execution\n      let result;\n      if (selectedScript.scriptId) {\n        result = await scriptService.executeScript(\n          selectedScript.scriptId,\n          selectedScript.functionName || \"main\",\n          selectedScript.parameters || [],\n        );\n      } else {\n        // Try inline execution (will fail gracefully if not supported)\n        result = await scriptService.executeInline(\n          selectedScript.code,\n          selectedScript.functionName || \"main\",\n          selectedScript.parameters || [],\n        );\n      }\n\n      if (result.success) {\n        setExecutionLogs((prev) => [\n          ...prev,\n          {\n            time: new Date().toISOString(),\n            message: \"‚úÖ Script ƒë√£ ƒë∆∞·ª£c th·ª±c thi th√†nh c√¥ng!\",\n            type: \"success\",\n          },\n          {\n            time: new Date().toISOString(),\n            message: `K·∫øt qu·∫£: ${JSON.stringify(result.data)}`,\n            type: \"info\",\n          },\n        ]);\n        message.success(\"Script ƒë√£ ƒë∆∞·ª£c th·ª±c thi th√†nh c√¥ng!\");\n      } else {\n        throw new Error(result.error || \"Script execution failed\");\n      }\n    } catch (error) {\n      console.error(\"Error executing script:\", error);\n      setExecutionLogs((prev) => [\n        ...prev,\n        {\n          time: new Date().toISOString(),\n          message: `‚ùå L·ªói: ${error.message}`,\n          type: \"error\",\n        },\n      ]);\n      message.error(`L·ªói th·ª±c thi script: ${error.message}`);\n    } finally {\n      setIsRunning(false);\n    }\n  };\n\n  const handleCreateScript = () => {\n    if (!newScriptName.trim()) return;\n\n    const newScript = {\n      id: `script_${Date.now()}`,\n      name: newScriptName,\n      description: newScriptDescription,\n      lastModified: new Date().toISOString(),\n      status: \"active\",\n      executions: 0,\n      code: `function ${newScriptName.replace(/\\s+/g, \"\")}() {\n  // Vi·∫øt code c·ªßa b·∫°n ·ªü ƒë√¢y\n  console.log('Script m·ªõi ƒë√£ ƒë∆∞·ª£c t·∫°o');\n}`,\n    };\n\n    setScripts((prev) => [newScript, ...prev]);\n    setNewScriptName(\"\");\n    setNewScriptDescription(\"\");\n    setShowCreateModal(false);\n  };\n\n  const handleSaveScript = () => {\n    if (!selectedScript) return;\n\n    setScripts((prev) =>\n      prev.map((script) =>\n        script.id === selectedScript.id\n          ? {\n              ...script,\n              code: scriptCode,\n              lastModified: new Date().toISOString(),\n            }\n          : script,\n      ),\n    );\n\n    setSelectedScript((prev) => ({\n      ...prev,\n      code: scriptCode,\n      lastModified: new Date().toISOString(),\n    }));\n  };\n\n  const handleDeleteScript = (scriptId) => {\n    setScripts((prev) => prev.filter((script) => script.id !== scriptId));\n    if (selectedScript?.id === scriptId) {\n      setSelectedScript(null);\n      setScriptCode(\"\");\n    }\n  };\n\n  const formatDate = (dateString) => {\n    return new Date(dateString).toLocaleDateString(\"vi-VN\", {\n      year: \"numeric\",\n      month: \"2-digit\",\n      day: \"2-digit\",\n      hour: \"2-digit\",\n      minute: \"2-digit\",\n    });\n  };\n\n  const getStatusColor = (status) => {\n    return status === \"active\" ? \"#22c55e\" : \"#ef4444\";\n  };\n\n  const getLogTypeColor = (type) => {\n    switch (type) {\n      case \"success\":\n        return \"#22c55e\";\n      case \"error\":\n        return \"#ef4444\";\n      case \"warning\":\n        return \"#f59e0b\";\n      default:\n        return \"#3b82f6\";\n    }\n  };\n\n  if (loading) return <Loading />;\n  if (error) return <div className=\"error-state\">L·ªói: {error}</div>;\n\n  return (\n    <div className=\"apps-script-container\">\n      {/* Header */}\n      <div className=\"script-header\">\n        <div className=\"header-left\">\n          <h1>‚öôÔ∏è Google Apps Script</h1>\n          <p>T·ª± ƒë·ªông h√≥a c√¥ng vi·ªác v·ªõi Google Apps Script</p>\n        </div>\n\n        <div className=\"header-right\">\n          <button\n            className=\"btn btn-primary\"\n            onClick={() => setShowCreateModal(true)}\n          >\n            ‚ûï T·∫°o script m·ªõi\n          </button>\n        </div>\n      </div>\n\n      <div className=\"script-content\">\n        {/* Scripts List */}\n        <div className=\"scripts-sidebar\">\n          <div className=\"sidebar-header\">\n            <h3>üìú Danh s√°ch Scripts</h3>\n            <span className=\"script-count\">{scripts.length} scripts</span>\n          </div>\n\n          <div className=\"scripts-list\">\n            {scripts.map((script) => (\n              <div\n                key={script.id}\n                className={`script-item ${\n                  selectedScript?.id === script.id ? \"active\" : \"\"\n                }`}\n                onClick={() => handleScriptSelect(script)}\n              >\n                <div className=\"script-info\">\n                  <div className=\"script-name\">{script.name}</div>\n                  <div className=\"script-description\">{script.description}</div>\n                  <div className=\"script-meta\">\n                    <span\n                      className=\"script-status\"\n                      style={{ color: getStatusColor(script.status) }}\n                    >\n                      {script.status === \"active\"\n                        ? \"üü¢ Ho·∫°t ƒë·ªông\"\n                        : \"üî¥ T·∫°m d·ª´ng\"}\n                    </span>\n                    <span className=\"script-executions\">\n                      {script.executions} l·∫ßn ch·∫°y\n                    </span>\n                  </div>\n                </div>\n                <div className=\"script-actions\">\n                  <button\n                    className=\"action-btn\"\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      handleDeleteScript(script.id);\n                    }}\n                    title=\"X√≥a script\"\n                  >\n                    üóëÔ∏è\n                  </button>\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n\n        {/* Script Editor */}\n        <div className=\"script-editor\">\n          {selectedScript ? (\n            <>\n              <div className=\"editor-header\">\n                <div className=\"script-title\">\n                  <h3>{selectedScript.name}</h3>\n                  <span className=\"script-id\">ID: {selectedScript.id}</span>\n                </div>\n                <div className=\"editor-actions\">\n                  <button\n                    className=\"btn btn-secondary\"\n                    onClick={handleSaveScript}\n                  >\n                    üíæ L∆∞u\n                  </button>\n                  <button\n                    className=\"btn btn-primary\"\n                    onClick={handleRunScript}\n                    disabled={isRunning}\n                  >\n                    {isRunning ? \"‚è≥ ƒêang ch·∫°y...\" : \"‚ñ∂Ô∏è Ch·∫°y script\"}\n                  </button>\n                </div>\n              </div>\n\n              <div className=\"code-editor\">\n                <textarea\n                  value={scriptCode}\n                  onChange={(e) => setScriptCode(e.target.value)}\n                  placeholder=\"Vi·∫øt code JavaScript c·ªßa b·∫°n ·ªü ƒë√¢y...\"\n                  className=\"code-textarea\"\n                />\n              </div>\n\n              {/* Execution Logs */}\n              {executionLogs.length > 0 && (\n                <div className=\"execution-logs\">\n                  <h4>üìã Nh·∫≠t k√Ω th·ª±c thi</h4>\n                  <div className=\"logs-container\">\n                    {executionLogs.map((log, index) => (\n                      <div key={index} className=\"log-entry\">\n                        <span className=\"log-time\">\n                          {new Date(log.time).toLocaleTimeString(\"vi-VN\")}\n                        </span>\n                        <span\n                          className=\"log-message\"\n                          style={{ color: getLogTypeColor(log.type) }}\n                        >\n                          {log.message}\n                        </span>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n            </>\n          ) : (\n            <div className=\"no-script-selected\">\n              <div className=\"empty-icon\">‚öôÔ∏è</div>\n              <h3>Ch·ªçn m·ªôt script ƒë·ªÉ ch·ªânh s·ª≠a</h3>\n              <p>T·∫°o script m·ªõi ho·∫∑c ch·ªçn t·ª´ danh s√°ch b√™n tr√°i</p>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Create Script Modal */}\n      {showCreateModal && (\n        <div className=\"modal-overlay\">\n          <div className=\"modal\">\n            <div className=\"modal-header\">\n              <h3>T·∫°o script m·ªõi</h3>\n              <button\n                className=\"close-btn\"\n                onClick={() => setShowCreateModal(false)}\n              >\n                ‚úï\n              </button>\n            </div>\n            <div className=\"modal-body\">\n              <div className=\"form-group\">\n                <label>T√™n script</label>\n                <input\n                  type=\"text\"\n                  value={newScriptName}\n                  onChange={(e) => setNewScriptName(e.target.value)}\n                  placeholder=\"Nh·∫≠p t√™n script...\"\n                  className=\"input-field\"\n                />\n              </div>\n              <div className=\"form-group\">\n                <label>M√¥ t·∫£</label>\n                <textarea\n                  value={newScriptDescription}\n                  onChange={(e) => setNewScriptDescription(e.target.value)}\n                  placeholder=\"M√¥ t·∫£ ch·ª©c nƒÉng c·ªßa script...\"\n                  className=\"textarea-field\"\n                  rows=\"3\"\n                />\n              </div>\n            </div>\n            <div className=\"modal-footer\">\n              <button\n                className=\"btn btn-secondary\"\n                onClick={() => setShowCreateModal(false)}\n              >\n                H·ªßy\n              </button>\n              <button\n                className=\"btn btn-primary\"\n                onClick={handleCreateScript}\n                disabled={!newScriptName.trim()}\n              >\n                T·∫°o script\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default GoogleAppsScriptIntegration;\n"],"names":["API_BASE_URL","env","VITE_API_URL","REACT_APP_API_URL","scriptService","executeScript","scriptId","functionName","arguments","length","undefined","parameters","response","fetch","concat","method","headers","body","JSON","stringify","ok","errorData","json","catch","Error","error","statusText","console","executeInline","code","getScriptStatus","listProjects","testScript","GoogleAppsScriptIntegration","loading","useSelector","state","auth","isAuthenticated","serviceAccount","scripts","setScripts","useState","selectedScript","setSelectedScript","scriptCode","setScriptCode","isRunning","setIsRunning","executionLogs","setExecutionLogs","showCreateModal","setShowCreateModal","newScriptName","setNewScriptName","newScriptDescription","setNewScriptDescription","sampleScripts","id","name","description","lastModified","status","executions","useEffect","getLogTypeColor","type","_jsx","Loading","_jsxs","className","children","onClick","map","script","handleScriptSelect","style","color","e","stopPropagation","prev","filter","title","_Fragment","handleSaveScript","_objectSpread","Date","toISOString","async","result","time","message","success","data","disabled","value","onChange","target","placeholder","log","index","toLocaleTimeString","rows","handleCreateScript","trim","newScript","now","replace"],"ignoreList":[],"sourceRoot":""}