"use strict";(self.webpackChunkreact_google_sheets_project=self.webpackChunkreact_google_sheets_project||[]).push([[662],{97326:(e,s,a)=>{a.r(s),a.d(s,{default:()=>o});var t=a(89379),i=a(65043),n=a(5137),c=a(58021),l=a(70579);const o=()=>{const{loading:e,error:s}=(0,n.d4)(e=>e.auth),{isAuthenticated:a,serviceAccount:o}=(0,n.d4)(e=>e.auth),[r,d]=(0,i.useState)([]),[h,u]=(0,i.useState)(null),[m,g]=(0,i.useState)(!1),[x,p]=(0,i.useState)({name:"",description:"",trigger:"schedule",action:"email",status:"active"}),[j,v]=(0,i.useState)([]),N=[{id:"auto_1",name:"B\xe1o c\xe1o h\xe0ng ng\xe0y",description:"T\u1ef1 \u0111\u1ed9ng g\u1eedi b\xe1o c\xe1o h\xe0ng ng\xe0y l\xfac 8:00 s\xe1ng",trigger:{type:"schedule",schedule:"0 8 * * *",timezone:"Asia/Ho_Chi_Minh"},action:{type:"email",template:"daily_report",recipients:["manager@mia.vn","admin@mia.vn"]},status:"active",lastRun:"2024-01-15T08:00:00Z",nextRun:"2024-01-16T08:00:00Z",executions:45,successRate:98.5},{id:"auto_2",name:"Backup d\u1eef li\u1ec7u",description:"T\u1ef1 \u0111\u1ed9ng backup d\u1eef li\u1ec7u Google Sheets h\xe0ng tu\u1ea7n",trigger:{type:"schedule",schedule:"0 2 * * 0",timezone:"Asia/Ho_Chi_Minh"},action:{type:"backup",source:"google_sheets",destination:"google_drive"},status:"active",lastRun:"2024-01-14T02:00:00Z",nextRun:"2024-01-21T02:00:00Z",executions:8,successRate:100},{id:"auto_3",name:"Th\xf4ng b\xe1o \u0111\u01a1n h\xe0ng m\u1edbi",description:"G\u1eedi th\xf4ng b\xe1o Telegram khi c\xf3 \u0111\u01a1n h\xe0ng m\u1edbi",trigger:{type:"webhook",endpoint:"/webhook/new-order",method:"POST"},action:{type:"telegram",message:"C\xf3 \u0111\u01a1n h\xe0ng m\u1edbi: {order_id}",chatId:"-4818209867"},status:"active",lastRun:"2024-01-15T14:30:00Z",nextRun:"N/A",executions:23,successRate:95.7},{id:"auto_4",name:"\u0110\u1ed3ng b\u1ed9 inventory",description:"\u0110\u1ed3ng b\u1ed9 d\u1eef li\u1ec7u inventory gi\u1eefa c\xe1c h\u1ec7 th\u1ed1ng",trigger:{type:"schedule",schedule:"0 */6 * * *",timezone:"Asia/Ho_Chi_Minh"},action:{type:"sync",source:"google_sheets",target:"erp_system"},status:"inactive",lastRun:"2024-01-10T12:00:00Z",nextRun:"N/A",executions:156,successRate:92.3}],b=[{id:1,automationId:"auto_1",timestamp:"2024-01-15T08:00:00Z",status:"success",message:"B\xe1o c\xe1o h\xe0ng ng\xe0y \u0111\xe3 \u0111\u01b0\u1ee3c g\u1eedi th\xe0nh c\xf4ng",duration:"2.3s"},{id:2,automationId:"auto_3",timestamp:"2024-01-15T14:30:00Z",status:"success",message:"Th\xf4ng b\xe1o \u0111\u01a1n h\xe0ng #12345 \u0111\xe3 \u0111\u01b0\u1ee3c g\u1eedi",duration:"0.8s"},{id:3,automationId:"auto_2",timestamp:"2024-01-14T02:00:00Z",status:"success",message:"Backup d\u1eef li\u1ec7u ho\xe0n th\xe0nh",duration:"45.2s"},{id:4,automationId:"auto_1",timestamp:"2024-01-14T08:00:00Z",status:"error",message:"L\u1ed7i k\u1ebft n\u1ed1i email server",duration:"5.1s"}];(0,i.useEffect)(()=>{d(N),v(b)},[]);const y=e=>{d(s=>s.map(s=>s.id===e?(0,t.A)((0,t.A)({},s),{},{status:"active"===s.status?"inactive":"active"}):s))},T=e=>new Date(e).toLocaleDateString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),k=e=>"active"===e?"#22c55e":"#ef4444",f=e=>{switch(e){case"success":return"#22c55e";case"error":return"#ef4444";case"warning":return"#f59e0b";default:return"#3b82f6"}},_=e=>{switch(e){case"schedule":return"\u23f0";case"webhook":return"\ud83d\udd17";case"manual":return"\ud83d\udc46";default:return"\u26a1"}},A=e=>{switch(e){case"email":return"\ud83d\udce7";case"telegram":return"\ud83d\udcac";case"backup":return"\ud83d\udcbe";case"sync":return"\ud83d\udd04";default:return"\u26a1"}};return e?(0,l.jsx)(c.A,{}):s?(0,l.jsxs)("div",{className:"error-state",children:["L\u1ed7i: ",s]}):(0,l.jsxs)("div",{className:"automation-dashboard",children:[(0,l.jsxs)("div",{className:"automation-header",children:[(0,l.jsxs)("div",{className:"header-left",children:[(0,l.jsx)("h1",{children:"\ud83e\udd16 Automation"}),(0,l.jsx)("p",{children:"T\u1ef1 \u0111\u1ed9ng h\xf3a quy tr\xecnh v\xe0 c\xf4ng vi\u1ec7c"})]}),(0,l.jsx)("div",{className:"header-right",children:(0,l.jsx)("button",{className:"btn btn-primary",onClick:()=>g(!0),children:"\u2795 T\u1ea1o automation m\u1edbi"})})]}),(0,l.jsxs)("div",{className:"automation-content",children:[(0,l.jsxs)("div",{className:"automations-sidebar",children:[(0,l.jsxs)("div",{className:"sidebar-header",children:[(0,l.jsx)("h3",{children:"\ud83d\udccb Danh s\xe1ch Automation"}),(0,l.jsxs)("span",{className:"automation-count",children:[r.length," automations"]})]}),(0,l.jsx)("div",{className:"automations-list",children:r.map(e=>(0,l.jsxs)("div",{className:"automation-item ".concat((null===h||void 0===h?void 0:h.id)===e.id?"active":""),onClick:()=>(e=>{u(e)})(e),children:[(0,l.jsxs)("div",{className:"automation-info",children:[(0,l.jsxs)("div",{className:"automation-header-item",children:[(0,l.jsx)("span",{className:"automation-name",children:e.name}),(0,l.jsx)("span",{className:"automation-status",style:{color:k(e.status)},children:"active"===e.status?"\ud83d\udfe2":"\ud83d\udd34"})]}),(0,l.jsx)("div",{className:"automation-description",children:e.description}),(0,l.jsxs)("div",{className:"automation-meta",children:[(0,l.jsxs)("span",{className:"automation-trigger",children:[_(e.trigger.type)," ",e.trigger.type]}),(0,l.jsxs)("span",{className:"automation-action",children:[A(e.action.type)," ",e.action.type]})]}),(0,l.jsxs)("div",{className:"automation-stats",children:[(0,l.jsxs)("span",{children:[e.executions," l\u1ea7n ch\u1ea1y"]}),(0,l.jsxs)("span",{children:[e.successRate,"% th\xe0nh c\xf4ng"]})]})]}),(0,l.jsxs)("div",{className:"automation-actions",children:[(0,l.jsx)("button",{className:"action-btn",onClick:s=>{s.stopPropagation(),y(e.id)},title:"active"===e.status?"T\u1ea1m d\u1eebng":"K\xedch ho\u1ea1t",children:"active"===e.status?"\u23f8\ufe0f":"\u25b6\ufe0f"}),(0,l.jsx)("button",{className:"action-btn",onClick:s=>{var a;s.stopPropagation(),a=e.id,d(e=>e.filter(e=>e.id!==a)),(null===h||void 0===h?void 0:h.id)===a&&u(null)},title:"X\xf3a automation",children:"\ud83d\uddd1\ufe0f"})]})]},e.id))})]}),(0,l.jsx)("div",{className:"automation-details",children:h?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"details-header",children:[(0,l.jsxs)("div",{className:"automation-title",children:[(0,l.jsx)("h3",{children:h.name}),(0,l.jsx)("span",{className:"status-badge",style:{backgroundColor:k(h.status)},children:"active"===h.status?"Ho\u1ea1t \u0111\u1ed9ng":"T\u1ea1m d\u1eebng"})]}),(0,l.jsx)("div",{className:"details-actions",children:(0,l.jsx)("button",{className:"btn btn-secondary",onClick:()=>y(h.id),children:"active"===h.status?"\u23f8\ufe0f T\u1ea1m d\u1eebng":"\u25b6\ufe0f K\xedch ho\u1ea1t"})})]}),(0,l.jsxs)("div",{className:"details-content",children:[(0,l.jsxs)("div",{className:"detail-section",children:[(0,l.jsx)("h4",{children:"\ud83d\udcdd M\xf4 t\u1ea3"}),(0,l.jsx)("p",{children:h.description})]}),(0,l.jsxs)("div",{className:"detail-section",children:[(0,l.jsx)("h4",{children:"\u26a1 Trigger"}),(0,l.jsxs)("div",{className:"trigger-info",children:[(0,l.jsxs)("span",{className:"trigger-type",children:[_(h.trigger.type)," ",h.trigger.type]}),h.trigger.schedule&&(0,l.jsxs)("span",{className:"trigger-schedule",children:["L\u1ecbch: ",h.trigger.schedule]}),h.trigger.endpoint&&(0,l.jsxs)("span",{className:"trigger-endpoint",children:["Endpoint: ",h.trigger.endpoint]})]})]}),(0,l.jsxs)("div",{className:"detail-section",children:[(0,l.jsx)("h4",{children:"\ud83c\udfaf Action"}),(0,l.jsxs)("div",{className:"action-info",children:[(0,l.jsxs)("span",{className:"action-type",children:[A(h.action.type)," ",h.action.type]}),h.action.recipients&&(0,l.jsxs)("span",{className:"action-recipients",children:["Ng\u01b0\u1eddi nh\u1eadn:"," ",h.action.recipients.join(", ")]}),h.action.chatId&&(0,l.jsxs)("span",{className:"action-chat",children:["Chat ID: ",h.action.chatId]})]})]}),(0,l.jsxs)("div",{className:"detail-section",children:[(0,l.jsx)("h4",{children:"\ud83d\udcca Th\u1ed1ng k\xea"}),(0,l.jsxs)("div",{className:"stats-grid",children:[(0,l.jsxs)("div",{className:"stat-item",children:[(0,l.jsx)("span",{className:"stat-label",children:"L\u1ea7n ch\u1ea1y cu\u1ed1i"}),(0,l.jsx)("span",{className:"stat-value",children:h.lastRun?T(h.lastRun):"Ch\u01b0a ch\u1ea1y"})]}),(0,l.jsxs)("div",{className:"stat-item",children:[(0,l.jsx)("span",{className:"stat-label",children:"L\u1ea7n ch\u1ea1y ti\u1ebfp theo"}),(0,l.jsx)("span",{className:"stat-value",children:"N/A"!==h.nextRun?T(h.nextRun):"N/A"})]}),(0,l.jsxs)("div",{className:"stat-item",children:[(0,l.jsx)("span",{className:"stat-label",children:"T\u1ed5ng l\u1ea7n ch\u1ea1y"}),(0,l.jsx)("span",{className:"stat-value",children:h.executions})]}),(0,l.jsxs)("div",{className:"stat-item",children:[(0,l.jsx)("span",{className:"stat-label",children:"T\u1ef7 l\u1ec7 th\xe0nh c\xf4ng"}),(0,l.jsxs)("span",{className:"stat-value",children:[h.successRate,"%"]})]})]})]}),(0,l.jsxs)("div",{className:"detail-section",children:[(0,l.jsx)("h4",{children:"\ud83d\udccb Nh\u1eadt k\xfd th\u1ef1c thi"}),(0,l.jsx)("div",{className:"logs-container",children:j.filter(e=>e.automationId===h.id).slice(0,10).map(e=>(0,l.jsxs)("div",{className:"log-entry",children:[(0,l.jsx)("span",{className:"log-time",children:T(e.timestamp)}),(0,l.jsx)("span",{className:"log-status",style:{color:f(e.status)},children:"success"===e.status?"\u2705":"\u274c"}),(0,l.jsx)("span",{className:"log-message",children:e.message}),(0,l.jsx)("span",{className:"log-duration",children:e.duration})]},e.id))})]})]})]}):(0,l.jsxs)("div",{className:"no-automation-selected",children:[(0,l.jsx)("div",{className:"empty-icon",children:"\ud83e\udd16"}),(0,l.jsx)("h3",{children:"Ch\u1ecdn m\u1ed9t automation \u0111\u1ec3 xem chi ti\u1ebft"}),(0,l.jsx)("p",{children:"T\u1ea1o automation m\u1edbi ho\u1eb7c ch\u1ecdn t\u1eeb danh s\xe1ch b\xean tr\xe1i"})]})})]}),m&&(0,l.jsx)("div",{className:"modal-overlay",children:(0,l.jsxs)("div",{className:"modal",children:[(0,l.jsxs)("div",{className:"modal-header",children:[(0,l.jsx)("h3",{children:"T\u1ea1o automation m\u1edbi"}),(0,l.jsx)("button",{className:"close-btn",onClick:()=>g(!1),children:"\u2715"})]}),(0,l.jsxs)("div",{className:"modal-body",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"T\xean automation"}),(0,l.jsx)("input",{type:"text",value:x.name,onChange:e=>p(s=>(0,t.A)((0,t.A)({},s),{},{name:e.target.value})),placeholder:"Nh\u1eadp t\xean automation...",className:"input-field"})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"M\xf4 t\u1ea3"}),(0,l.jsx)("textarea",{value:x.description,onChange:e=>p(s=>(0,t.A)((0,t.A)({},s),{},{description:e.target.value})),placeholder:"M\xf4 t\u1ea3 ch\u1ee9c n\u0103ng c\u1ee7a automation...",className:"textarea-field",rows:"3"})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Trigger"}),(0,l.jsxs)("select",{value:x.trigger,onChange:e=>p(s=>(0,t.A)((0,t.A)({},s),{},{trigger:e.target.value})),className:"select-field",children:[(0,l.jsx)("option",{value:"schedule",children:"L\u1ecbch tr\xecnh"}),(0,l.jsx)("option",{value:"webhook",children:"Webhook"}),(0,l.jsx)("option",{value:"manual",children:"Th\u1ee7 c\xf4ng"})]})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Action"}),(0,l.jsxs)("select",{value:x.action,onChange:e=>p(s=>(0,t.A)((0,t.A)({},s),{},{action:e.target.value})),className:"select-field",children:[(0,l.jsx)("option",{value:"email",children:"G\u1eedi email"}),(0,l.jsx)("option",{value:"telegram",children:"G\u1eedi Telegram"}),(0,l.jsx)("option",{value:"backup",children:"Backup d\u1eef li\u1ec7u"}),(0,l.jsx)("option",{value:"sync",children:"\u0110\u1ed3ng b\u1ed9 d\u1eef li\u1ec7u"})]})]})]}),(0,l.jsxs)("div",{className:"modal-footer",children:[(0,l.jsx)("button",{className:"btn btn-secondary",onClick:()=>g(!1),children:"H\u1ee7y"}),(0,l.jsx)("button",{className:"btn btn-primary",onClick:()=>{if(!x.name.trim())return;const e=(0,t.A)((0,t.A)({id:"auto_".concat(Date.now())},x),{},{lastRun:null,nextRun:new Date(Date.now()+864e5).toISOString(),executions:0,successRate:0});d(s=>[e,...s]),p({name:"",description:"",trigger:"schedule",action:"email",status:"active"}),g(!1)},disabled:!x.name.trim(),children:"T\u1ea1o automation"})]})]})})]})}}}]);
//# sourceMappingURL=automation.f93a2778.chunk.js.map