{"version":3,"file":"static/js/google-sheets.5aca2691.chunk.js","mappings":"kOAOA,MAAMA,cACQC,IAAIC,mBAAqB,4BA6HhC,MAAMC,EAAyB,IA3HtC,MAIE,eAAMC,GAAwC,IAA9BC,EAAKC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,WAAYG,EAAOH,UAAAC,OAAA,EAAAD,UAAA,QAAAE,EACzC,IACE,MAAME,EAAS,CAAEL,SACbI,IAASC,EAAOD,QAAUA,GAE9B,MAAME,QAAiBC,EAAAA,EAAMC,IAAI,GAADC,OAAId,EAAY,gBAAgB,CAC9DU,WAEF,MAAO,CACLK,KAAMJ,EAASI,KAAKA,KACpBV,MAAOM,EAASI,KAAKV,MACrBW,eAAgBL,EAASI,KAAKC,eAElC,CAAE,MAAOC,GAAQ,IAADC,EAAAC,EAEd,MADAC,QAAQH,MAAM,uBAAwBA,GAChC,IAAII,OACM,QAAdH,EAAAD,EAAMN,gBAAQ,IAAAO,GAAM,QAANC,EAAdD,EAAgBH,YAAI,IAAAI,OAAN,EAAdA,EAAsBF,QAAK,yBAAAH,OAA6BG,EAAMK,SAElE,CACF,CAKA,gBAAMC,CAAWlB,EAAOmB,EAAQf,GAC9B,IAME,aALuBG,EAAAA,EAAMa,KAAK,GAADX,OAAId,EAAY,iBAAiB,CAChEK,QACAmB,SACAf,aAEcM,KAAKA,IACvB,CAAE,MAAOE,GAAQ,IAADS,EAAAC,EAEd,MADAP,QAAQH,MAAM,0BAA2BA,GACnC,IAAII,OACM,QAAdK,EAAAT,EAAMN,gBAAQ,IAAAe,GAAM,QAANC,EAAdD,EAAgBX,YAAI,IAAAY,OAAN,EAAdA,EAAsBV,QAAK,6BAAAH,OACIG,EAAMK,SAEzC,CACF,CAKA,mBAAMM,CAAcvB,EAAOmB,EAAQf,GACjC,IAME,aALuBG,EAAAA,EAAMa,KAAK,GAADX,OAAId,EAAY,kBAAkB,CACjEK,QACAmB,SACAf,aAEcM,KAAKA,IACvB,CAAE,MAAOE,GAAQ,IAADY,EAAAC,EAEd,MADAV,QAAQH,MAAM,4BAA6BA,GACrC,IAAII,OACM,QAAdQ,EAAAZ,EAAMN,gBAAQ,IAAAkB,GAAM,QAANC,EAAdD,EAAgBd,YAAI,IAAAe,OAAN,EAAdA,EAAsBb,QAAK,8BAAAH,OACKG,EAAMK,SAE1C,CACF,CAKA,sBAAMS,CAAiBtB,GACrB,IACE,MAAMuB,EAAMvB,EAAO,GAAAK,OACZd,EAAY,qBAAAc,OAAoBL,GAAO,GAAAK,OACvCd,EAAY,oBAGnB,aADuBY,EAAAA,EAAMC,IAAImB,IACjBjB,KAAKA,IACvB,CAAE,MAAOE,GAAQ,IAADgB,EAAAC,EAEd,MADAd,QAAQH,MAAM,gCAAiCA,GACzC,IAAII,OACM,QAAdY,EAAAhB,EAAMN,gBAAQ,IAAAsB,GAAM,QAANC,EAAdD,EAAgBlB,YAAI,IAAAmB,OAAN,EAAdA,EAAsBjB,QAAK,iCAAAH,OACQG,EAAMK,SAE7C,CACF,CAKA,gBAAMa,CAAW9B,EAAOI,GACtB,IAIE,aAHuBG,EAAAA,EAAMwB,OAAO,GAADtB,OAAId,EAAY,iBAAiB,CAClEe,KAAM,CAAEV,QAAOI,cAEDM,KAAKA,IACvB,CAAE,MAAOE,GAAQ,IAADoB,EAAAC,EAEd,MADAlB,QAAQH,MAAM,wBAAyBA,GACjC,IAAII,OACM,QAAdgB,EAAApB,EAAMN,gBAAQ,IAAA0B,GAAM,QAANC,EAAdD,EAAgBtB,YAAI,IAAAuB,OAAN,EAAdA,EAAsBrB,QAAK,0BAAAH,OACCG,EAAMK,SAEtC,CACF,CAKA,cAAMiB,CAASC,EAAW/B,GACxB,IAKE,aAJuBG,EAAAA,EAAMa,KAAK,GAADX,OAAId,EAAY,qBAAqB,CACpEwC,YACA/B,aAEcM,KAAKA,IACvB,CAAE,MAAOE,GAAQ,IAADwB,EAAAC,EAEd,MADAtB,QAAQH,MAAM,sBAAuBA,GAC/B,IAAII,OACM,QAAdoB,EAAAxB,EAAMN,gBAAQ,IAAA8B,GAAM,QAANC,EAAdD,EAAgB1B,YAAI,IAAA2B,OAAN,EAAdA,EAAsBzB,QAAK,wBAAAH,OAA4BG,EAAMK,SAEjE,CACF,G,eC3HF,MA8oBA,EA9oBgCqB,KAE9B,MAAM,QAAEC,EAAO,MAAE3B,IAAU4B,EAAAA,EAAAA,IAAaC,GAAUA,EAAMC,SAClD,gBAAEC,EAAe,eAAEC,IAAmBJ,EAAAA,EAAAA,IACzCC,GAAUA,EAAMI,OAGZC,EAAeC,IAAoBC,EAAAA,EAAAA,UAAS,OAC5CC,EAAcC,IAAmBF,EAAAA,EAAAA,UAAS,KAC1CG,EAAWC,IAAgBJ,EAAAA,EAAAA,WAAS,IACpCK,EAAUC,IAAeN,EAAAA,EAAAA,UAAS,CAAC,IACnCO,EAAYC,IAAiBR,EAAAA,EAAAA,UAAS,KACtCS,EAAcC,IAAmBV,EAAAA,EAAAA,UAAS,KAC1CW,EAAiBC,IAAsBZ,EAAAA,EAAAA,WAAS,IAChDa,EAAcC,IAAmBd,EAAAA,EAAAA,UAAS,KAC1Ce,EAAiBC,IAAsBhB,EAAAA,EAAAA,WAAS,IAChDiB,EAAeC,IAAoBlB,EAAAA,EAAAA,UAAS,KAC5CmB,EAAcC,IAAmBpB,EAAAA,EAAAA,UAAS,KAC1CqB,EAAcC,IAAmBtB,EAAAA,EAAAA,UAAS,KAC1CuB,EAAmBC,IAAwBxB,EAAAA,EAAAA,WAAS,IACpDyB,EAAkBC,IAAuB1B,EAAAA,EAAAA,WAAS,IAClD2B,EAAeC,IAAoB5B,EAAAA,EAAAA,UAAS,OAGnD6B,EAAAA,EAAAA,WAAU,KACaC,WACnBN,GAAqB,GACrBI,EAAiB,MACjB,IACE,MAAMG,QAAiBjF,EAAuB4B,mBAExCsD,EAAc,CAClBC,eACcrF,IAAIsF,mCAChB,+CACFC,MAAOJ,EAASI,MAChBzC,OAAQqC,EAASrC,OAAO0C,IAAI,CAACC,EAAOC,KAAK,IAAAC,EAAAC,EAAA,MAAM,CAC7CC,KAAMJ,EAAMF,MACZF,GAAII,EAAMjF,QACVsF,UAA8B,QAApBH,EAAAF,EAAMM,sBAAc,IAAAJ,OAAA,EAApBA,EAAsBG,WAAY,EAC5CE,aAAiC,QAApBJ,EAAAH,EAAMM,sBAAc,IAAAH,OAAA,EAApBA,EAAsBI,cAAe,MAGtDtB,EAAgB,CAACU,GACnB,CAAE,MAAOa,GACP9E,QAAQH,MAAM,iCAAkCiF,GAChDjB,EAAiBiB,EAAI5E,SAErBqD,EAAgB,GAClB,CAAC,QACCE,GAAqB,EACvB,GAGFsB,IACC,KAGHjB,EAAAA,EAAAA,WAAU,KACiBC,WACvB,GAAKhC,EAAL,CAKA4B,GAAoB,GACpB,IAEE,MAAMvC,EAAYW,EAAc2C,KAC1BzF,EAAK,GAAAS,OAAM0B,EAAS,aACpB4D,QAAejG,EAAuBC,UAAUC,GACtDkD,EAAgB6C,EAAOrF,MAAQ,GACjC,CAAE,MAAOmF,GACP9E,QAAQH,MAAM,gCAAiCiF,GAC/C3C,EAAgB,GAClB,CAAC,QACCwB,GAAoB,EACtB,CAdA,MAFExB,EAAgB,KAmBpB8C,IACC,CAAClD,KAEJ+B,EAAAA,EAAAA,WAAU,KACR,GAAItB,EAAY,CACd,MAAM0C,EAAWhD,EAAaiD,OAAQC,GACpCA,EAAIC,KAAMC,GACRA,EAAKC,WAAWC,cAAcC,SAASjD,EAAWgD,iBAGtD7C,EAAgBuC,EAClB,MACEvC,EAAgBT,IAEjB,CAACM,EAAYN,IAEhB,MAOMwD,EAA0BA,CAACpB,EAAOqB,KACjB,IAADC,EAAfD,IACHA,GACiB,QAAfC,EAAAtC,EAAa,UAAE,IAAAsC,OAAA,EAAfA,EAAiB1B,iBACLrF,IAAIsF,mCAChB,gDAKJ,MAAM0B,EAAQ,0CAAAnG,OAA6CiG,EAAa,cAAAjG,OAAa4E,EAAMJ,IAC3F4B,OAAOC,KAAKF,EAAU,WAoKxB,OAAIrE,GACKwE,EAAAA,EAAAA,KAACC,EAAAA,EAAO,CAACC,KAAK,sCAA4BC,YAAU,IAGzDtG,GAEAuG,EAAAA,EAAAA,MAAA,OAAKC,UAAU,eAAcC,SAAA,EAC3BN,EAAAA,EAAAA,KAAA,MAAAM,SAAI,8CACJN,EAAAA,EAAAA,KAAA,KAAAM,SAAIzG,KACJmG,EAAAA,EAAAA,KAAA,UAAQO,QAASA,IAAMT,OAAOU,SAASC,SAASH,SAAC,0BAMrDF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,gDAA+CC,SAAA,EAE5DF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,4BAA2BC,SAAA,EACxCN,EAAAA,EAAAA,KAAA,OAAKK,UAAU,qBAAoBC,UACjCN,EAAAA,EAAAA,KAAA,MAAAM,SAAI,8CAENF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,gCAA+BC,SAAA,EAC5CN,EAAAA,EAAAA,KAAA,UACEK,UAAU,kBACVE,QAASA,IAAM1D,GAAmB,GAAMyD,SACzC,mCAGAvE,IACCqE,EAAAA,EAAAA,MAAAM,EAAAA,SAAA,CAAAJ,SAAA,EACEN,EAAAA,EAAAA,KAAA,UACEK,UAAU,oBACVE,QAASA,IAAMlE,GAAcD,GAAWkE,SAEvClE,EAAY,wBAAW,sCAE1B4D,EAAAA,EAAAA,KAAA,UAAQK,UAAU,kBAAkBE,QAtL3BI,KAEnB,MAAMC,EAAalE,EAAa2B,IAAKe,GAAQA,EAAIyB,KAAK,MAAMA,KAAK,MAC3DC,EAAO,IAAIC,KAAK,CAACH,GAAa,CAAEI,KAAM,aACtCpG,EAAMkF,OAAOmB,IAAIC,gBAAgBJ,GACjCK,EAAIC,SAASC,cAAc,KACjCF,EAAEG,KAAO1G,EACTuG,EAAEI,SAAQ,GAAA7H,QAAmB,OAAbqC,QAAa,IAAbA,OAAa,EAAbA,EAAe2C,OAAQ,QAAO,QAC9CyC,EAAEK,QACF1B,OAAOmB,IAAIQ,gBAAgB7G,IA6KyC0F,SAAC,yCAQnEF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,mCAAkCC,SAAA,EAE/CF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,iBAAgBC,SAAA,EAC7BF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,iBAAgBC,SAAA,EAC7BN,EAAAA,EAAAA,KAAA,MAAAM,SAAI,qCACH9C,GACCwC,EAAAA,EAAAA,KAAA,QAAMK,UAAU,eAAcC,SAAC,2BAE/BF,EAAAA,EAAAA,MAAA,QAAMC,UAAU,eAAcC,SAAA,CAC3BhD,EAAaoE,OAAO,CAACC,EAAKC,IAAMD,EAAMC,EAAEjG,OAAOxC,OAAQ,GAAI,IAAI,eAMrEyE,IACCwC,EAAAA,EAAAA,MAAA,OACEC,UAAU,eACVwB,MAAO,CACLC,QAAS,OACTC,OAAQ,OACRC,gBAAiB,UACjBC,MAAO,UACPC,aAAc,OACd5B,SAAA,CACH,4CACuB1C,MAI1BoC,EAAAA,EAAAA,KAAA,OAAKK,UAAU,cAAaC,SACzB9C,GACCwC,EAAAA,EAAAA,KAAA,OAAK6B,MAAO,CAAEC,QAAS,OAAQK,UAAW,UAAW7B,SAAC,0BAG5B,IAAxBhD,EAAanE,QACf6G,EAAAA,EAAAA,KAAA,OAAK6B,MAAO,CAAEC,QAAS,OAAQK,UAAW,UAAW7B,SAAC,iCAItDhD,EAAae,IAAKJ,IAChBmC,EAAAA,EAAAA,MAAA,OAA0BC,UAAU,oBAAmBC,SAAA,EACrDN,EAAAA,EAAAA,KAAA,OAAKK,UAAU,oBAAmBC,SAAErC,EAAYG,QAC/CH,EAAYtC,OAAO0C,IAAKC,IACvB8B,EAAAA,EAAAA,MAAA,OAEEC,UAAS,cAAA3G,QACM,OAAbqC,QAAa,IAAbA,OAAa,EAAbA,EAAemC,MAAOI,EAAMJ,GAAK,SAAW,IAE9CqC,QAASA,IAnRFjC,KACzBtC,EAAiBsC,GACjBjC,GAAa,GACbE,EAAY,CAAC,IAgRoB6F,CAAkB9D,GACjC+D,cAAeA,IACb3C,EAAwBpB,EAAOL,EAAYC,IAE7CE,MAAM,0DAAuCkC,SAAA,EAE7CF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,aAAYC,SAAA,EACzBF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,oBAAmBC,SAAA,EAChCN,EAAAA,EAAAA,KAAA,QAAMK,UAAU,aAAYC,SAAEhC,EAAMI,QACpC0B,EAAAA,EAAAA,MAAA,OAAKC,UAAU,yBAAwBC,SAAA,EACrCN,EAAAA,EAAAA,KAAA,QAAMK,UAAU,eAAcC,SAAC,kBACjB,OAAbvE,QAAa,IAAbA,OAAa,EAAbA,EAAemC,MAAOI,EAAMJ,KAC3B8B,EAAAA,EAAAA,KAAA,QAAMK,UAAU,mBAAkBC,SAAC,8CAMzCF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,oBAAmBC,SAAA,CAAC,mBAChBhC,EAAMK,SAAS,gBAAQ,IACvCL,EAAMO,YAAY,gBAErBuB,EAAAA,EAAAA,MAAA,OAAKC,UAAU,aAAYC,SAAA,EACzBN,EAAAA,EAAAA,KAAA,QAAMK,UAAU,gBAAeC,SAAC,yBAChCN,EAAAA,EAAAA,KAAA,QAAMK,UAAU,eAAcC,SAAC,0BAEjCF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,cAAaC,SAAA,EAC1BF,EAAAA,EAAAA,MAAA,QAAAE,SAAA,CAAOhC,EAAMK,SAAS,oBACtBqB,EAAAA,EAAAA,KAAA,QAAAM,SAAM,iCAGVF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,gBAAeC,SAAA,EAC5BN,EAAAA,EAAAA,KAAA,UACEK,UAAU,aACVE,QAAU+B,IACRA,EAAEC,kBACF7C,EAAwBpB,EAAOL,EAAYC,KAE7CE,MAAM,gCAAuBkC,SAC9B,kBAGDN,EAAAA,EAAAA,KAAA,UACEK,UAAU,aACVE,QAAU+B,IACRA,EAAEC,kBACFC,MAAM,2BAAkBlE,EAAMI,OAEhCN,MAAM,mBAAUkC,SACjB,YAGDN,EAAAA,EAAAA,KAAA,UACEK,UAAU,aACVE,QAAU+B,IACRA,EAAEC,kBACFC,MAAM,0BAAmBlE,EAAMI,OAEjCN,MAAM,kBAAWkC,SAClB,kBAGDN,EAAAA,EAAAA,KAAA,UACEK,UAAU,aACVE,QAAU+B,IACRA,EAAEC,kBACFC,MAAM,mCAA0BlE,EAAMI,OAExCN,MAAM,4BAAgBkC,SACvB,wBAGDN,EAAAA,EAAAA,KAAA,UACEK,UAAU,aACVE,QAAU+B,IACRA,EAAEC,kBAlL1BC,MAAM,OAAD9I,OAmLgC4E,EAnLnBJ,KAAmB,OAAbnC,QAAa,IAAbA,OAAa,EAAbA,EAAemC,OAqLjBE,MAAM,SAAQkC,SACf,4BAnFEhC,EAAMJ,OAJPD,EAAYC,WAoG9B8B,EAAAA,EAAAA,KAAA,OAAKK,UAAU,sBAAqBC,SACjC5C,GACCsC,EAAAA,EAAAA,KAAA,OAAK6B,MAAO,CAAEC,QAAS,OAAQK,UAAW,UAAW7B,UACnDN,EAAAA,EAAAA,KAACC,EAAAA,EAAO,CAACC,KAAK,oDAEdnE,GACFqE,EAAAA,EAAAA,MAAAM,EAAAA,SAAA,CAAAJ,SAAA,EACEF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,eAAcC,SAAA,EAC3BF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,qBAAoBC,SAAA,EACjCF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,mBAAkBC,SAAA,EAC/BN,EAAAA,EAAAA,KAAA,MAAAM,SAAKvE,EAAc2C,QACnB0B,EAAAA,EAAAA,MAAA,QAAMC,UAAU,mBAAkBC,SAAA,CAC/BvE,EAAc4C,SAAS,gBAAQ,IAC/B5C,EAAc8C,YAAY,mBAG/BmB,EAAAA,EAAAA,KAAA,UACEK,UAAU,eACVE,QAASA,KAAO,IAADkC,EACb,MAAM9C,GACW,QAAf8C,EAAAnF,EAAa,UAAE,IAAAmF,OAAA,EAAfA,EAAiBvE,iBACLrF,IAAIsF,mCAChB,+CACFuB,EAAwB3D,EAAe4D,IAEzCvB,MAAM,gCACNyD,MAAO,CAAEa,WAAY,OAAQZ,QAAS,WAAYxB,SACnD,mDAIHF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,gBAAeC,SAAA,EAC5BN,EAAAA,EAAAA,KAAA,SACEgB,KAAK,OACL2B,YAAY,mCACZC,MAAOpG,EACPqG,SAAWP,GAAM7F,EAAc6F,EAAEQ,OAAOF,OACxCvC,UAAU,kBAEZD,EAAAA,EAAAA,MAAA,QAAMC,UAAU,YAAWC,SAAA,CAAE5D,EAAavD,OAAO,kBAIrD6G,EAAAA,EAAAA,KAAA,OAAKK,UAAU,wBAAuBC,SACX,IAAxB5D,EAAavD,QACZ6G,EAAAA,EAAAA,KAAA,OAAK6B,MAAO,CAAEC,QAAS,OAAQK,UAAW,UAAW7B,UACnDN,EAAAA,EAAAA,KAAA,KAAAM,SAAG,mEAGLF,EAAAA,EAAAA,MAAA,SAAOC,UAAU,cAAaC,SAAA,EAC5BN,EAAAA,EAAAA,KAAA,SAAAM,UACEN,EAAAA,EAAAA,KAAA,MAAAM,SACG5D,EAAa,GAAG2B,IAAI,CAAC0E,EAAQxE,KAC5ByB,EAAAA,EAAAA,KAAA,MAAAM,SAAiByC,GAARxE,SAIfyB,EAAAA,EAAAA,KAAA,SAAAM,SACG5D,EAAasG,MAAM,GAAG3E,IAAI,CAACe,EAAK6D,KAC/BjD,EAAAA,EAAAA,KAAA,MAAAM,SACGlB,EAAIf,IAAI,CAACiB,EAAM4D,KACdlD,EAAAA,EAAAA,KAAA,MAAAM,SACGlE,GACC4D,EAAAA,EAAAA,KAAA,SACEgB,KAAK,OACL4B,MACEtG,EAAS,GAAD5C,OAAIuJ,EAAW,EAAC,KAAAvJ,OAAIwJ,KAC5B5D,EAEFuD,SAAWP,GA/ZpBa,EAACF,EAAUC,EAAUN,KAC1CrG,GAAW6G,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EACR9G,GAAQ,IACX,CAAC,GAAD5C,OAAIuJ,EAAQ,KAAAvJ,OAAIwJ,IAAaN,MA6ZCO,CACEF,EAAW,EACXC,EACAZ,EAAEQ,OAAOF,OAGbvC,UAAU,gBAGZL,EAAAA,EAAAA,KAAA,QAAMK,UAAU,eAAcC,SAAEhB,KAlB3B4D,KAFJD,eAgCrB7C,EAAAA,EAAAA,MAAA,OAAKC,UAAU,oBAAmBC,SAAA,EAChCN,EAAAA,EAAAA,KAAA,OAAKK,UAAU,gBAAeC,SAAC,kBAC/BN,EAAAA,EAAAA,KAAA,MAAAM,SAAI,iEACJN,EAAAA,EAAAA,KAAA,KAAAM,SAAG,kHAOV1D,IACCoD,EAAAA,EAAAA,KAAA,OAAKK,UAAU,gBAAeC,UAC5BF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,QAAOC,SAAA,EACpBF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,eAAcC,SAAA,EAC3BN,EAAAA,EAAAA,KAAA,MAAAM,SAAI,6BACJN,EAAAA,EAAAA,KAAA,UACEK,UAAU,YACVE,QAASA,IAAM1D,GAAmB,GAAOyD,SAC1C,eAIHN,EAAAA,EAAAA,KAAA,OAAKK,UAAU,aAAYC,UACzBF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,aAAYC,SAAA,EACzBN,EAAAA,EAAAA,KAAA,SAAAM,SAAO,kBACPN,EAAAA,EAAAA,KAAA,SACEgB,KAAK,OACL4B,MAAO9F,EACP+F,SAAWP,GAAMvF,EAAgBuF,EAAEQ,OAAOF,OAC1CD,YAAY,4BACZtC,UAAU,sBAIhBD,EAAAA,EAAAA,MAAA,OAAKC,UAAU,eAAcC,SAAA,EAC3BN,EAAAA,EAAAA,KAAA,UACEK,UAAU,oBACVE,QAASA,IAAM1D,GAAmB,GAAOyD,SAC1C,cAGDN,EAAAA,EAAAA,KAAA,UACEK,UAAU,kBACVE,QArcYxC,UACxB,GAAKjB,EAAauG,OAElB,IAAK,IAADC,EACF7F,GAAqB,GAGrB,MAAMkC,GACW,QAAf2D,EAAAhG,EAAa,UAAE,IAAAgG,OAAA,EAAfA,EAAiBpF,iBACLrF,IAAIsF,mCAChB,+CAGIoF,QAAiBxK,EAAuBoC,SAC5C2B,EAAauG,OACb1D,GAII3B,QACEjF,EAAuB4B,iBAAiBgF,GAC1C1B,EAAc,CAClBC,GAAIyB,EACJvB,MAAOJ,EAASI,MAChBzC,OAAQqC,EAASrC,OAAO0C,IAAI,CAACC,EAAOC,KAAK,IAAAiF,EAAAC,EAAA,MAAM,CAC7C/E,KAAMJ,EAAMF,MACZF,GAAII,EAAMjF,QACVsF,UAA8B,QAApB6E,EAAAlF,EAAMM,sBAAc,IAAA4E,OAAA,EAApBA,EAAsB7E,WAAY,EAC5CE,aAAiC,QAApB4E,EAAAnF,EAAMM,sBAAc,IAAA6E,OAAA,EAApBA,EAAsB5E,cAAe,MAGtDtB,EAAgB,CAACU,IAGjB,MAAMyF,EAAezF,EAAYtC,OAAOgI,KACrC/B,GAAMA,EAAE1D,KAAOqF,EAASlK,SAEvBqK,GACF1H,EAAiB0H,GAGnB3G,EAAgB,IAChBF,GAAmB,GACnBY,GAAqB,EACvB,CAAE,MAAO5D,GACPG,QAAQH,MAAM,wBAAyBA,GACvC2I,MAAM,4BAAD9I,OAAmBG,EAAMK,UAC9BuD,GAAqB,EACvB,GAsZYmG,UAAW9G,EAAauG,OAAO/C,SAChC,2BASRtD,IACCgD,EAAAA,EAAAA,KAAA,OAAKK,UAAU,gBAAeC,UAC5BF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,QAAOC,SAAA,EACpBF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,eAAcC,SAAA,EAC3BN,EAAAA,EAAAA,KAAA,MAAAM,SAAI,+BACJN,EAAAA,EAAAA,KAAA,UACEK,UAAU,YACVE,QAASA,IAAMtD,GAAmB,GAAOqD,SAC1C,eAIHN,EAAAA,EAAAA,KAAA,OAAKK,UAAU,aAAYC,UACzBF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,aAAYC,SAAA,EACzBN,EAAAA,EAAAA,KAAA,SAAAM,SAAO,qBACPN,EAAAA,EAAAA,KAAA,SACEgB,KAAK,OACL4B,MAAO1F,EACP2F,SAAWP,GAAMnF,EAAiBmF,EAAEQ,OAAOF,OAC3CD,YAAY,+BACZtC,UAAU,sBAIhBD,EAAAA,EAAAA,MAAA,OAAKC,UAAU,eAAcC,SAAA,EAC3BN,EAAAA,EAAAA,KAAA,UACEK,UAAU,oBACVE,QAASA,IAAMtD,GAAmB,GAAOqD,SAC1C,cAGDN,EAAAA,EAAAA,KAAA,UACEK,UAAU,kBACVE,QA9bUsD,KACtB,IAAK3G,EAAcmG,SAAWtH,EAAe,OAE7C,MAAM+H,EAAiB5H,EAAamC,IAAI,CAACe,EAAKb,IAC9B,IAAVA,EAEK,IAAIa,EAAKlC,GAGT,IAAIkC,EAAK,KAIpBjD,EAAgB2H,GAChB3G,EAAiB,IACjBF,GAAmB,IAgbP2G,UAAW1G,EAAcmG,OAAO/C,SACjC,gC","sources":["services/googleSheetsApi.js","components/google/GoogleSheetsIntegration.jsx"],"sourcesContent":["/**\n * Google Sheets API Service - Frontend\n * Calls backend API instead of direct Google APIs\n */\n\nimport axios from \"axios\";\n\nconst API_BASE_URL =\n  import.meta.env.VITE_API_BASE_URL || \"http://localhost:3001/api\";\n\nclass GoogleSheetsApiService {\n  /**\n   * Read data from sheet\n   */\n  async readSheet(range = \"A1:Z1000\", sheetId) {\n    try {\n      const params = { range };\n      if (sheetId) params.sheetId = sheetId;\n\n      const response = await axios.get(`${API_BASE_URL}/sheets/read`, {\n        params,\n      });\n      return {\n        data: response.data.data,\n        range: response.data.range,\n        majorDimension: response.data.majorDimension,\n      };\n    } catch (error) {\n      console.error(\"Error reading sheet:\", error);\n      throw new Error(\n        error.response?.data?.error || `Failed to read sheet: ${error.message}`,\n      );\n    }\n  }\n\n  /**\n   * Write data to sheet\n   */\n  async writeSheet(range, values, sheetId) {\n    try {\n      const response = await axios.post(`${API_BASE_URL}/sheets/write`, {\n        range,\n        values,\n        sheetId,\n      });\n      return response.data.data;\n    } catch (error) {\n      console.error(\"Error writing to sheet:\", error);\n      throw new Error(\n        error.response?.data?.error ||\n          `Failed to write to sheet: ${error.message}`,\n      );\n    }\n  }\n\n  /**\n   * Append data to sheet\n   */\n  async appendToSheet(range, values, sheetId) {\n    try {\n      const response = await axios.post(`${API_BASE_URL}/sheets/append`, {\n        range,\n        values,\n        sheetId,\n      });\n      return response.data.data;\n    } catch (error) {\n      console.error(\"Error appending to sheet:\", error);\n      throw new Error(\n        error.response?.data?.error ||\n          `Failed to append to sheet: ${error.message}`,\n      );\n    }\n  }\n\n  /**\n   * Get sheet metadata\n   */\n  async getSheetMetadata(sheetId) {\n    try {\n      const url = sheetId\n        ? `${API_BASE_URL}/sheets/metadata/${sheetId}`\n        : `${API_BASE_URL}/sheets/metadata`;\n\n      const response = await axios.get(url);\n      return response.data.data;\n    } catch (error) {\n      console.error(\"Error getting sheet metadata:\", error);\n      throw new Error(\n        error.response?.data?.error ||\n          `Failed to get sheet metadata: ${error.message}`,\n      );\n    }\n  }\n\n  /**\n   * Clear sheet data\n   */\n  async clearSheet(range, sheetId) {\n    try {\n      const response = await axios.delete(`${API_BASE_URL}/sheets/clear`, {\n        data: { range, sheetId },\n      });\n      return response.data.data;\n    } catch (error) {\n      console.error(\"Error clearing sheet:\", error);\n      throw new Error(\n        error.response?.data?.error ||\n          `Failed to clear sheet: ${error.message}`,\n      );\n    }\n  }\n\n  /**\n   * Add new worksheet (sheet) to spreadsheet\n   */\n  async addSheet(sheetName, sheetId) {\n    try {\n      const response = await axios.post(`${API_BASE_URL}/sheets/add-sheet`, {\n        sheetName,\n        sheetId,\n      });\n      return response.data.data;\n    } catch (error) {\n      console.error(\"Error adding sheet:\", error);\n      throw new Error(\n        error.response?.data?.error || `Failed to add sheet: ${error.message}`,\n      );\n    }\n  }\n}\n\n// Export singleton instance\nexport const googleSheetsApiService = new GoogleSheetsApiService();\nexport default googleSheetsApiService;\n","import React, { useState, useEffect } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport Loading from \"../Common/Loading\";\nimport { googleSheetsApiService } from \"../../services/googleSheetsApi\";\nimport \"./GoogleSheetsIntegration.css\";\n\nconst GoogleSheetsIntegration = () => {\n  // const dispatch = useDispatch();\n  const { loading, error } = useSelector((state) => state.sheets);\n  const { isAuthenticated, serviceAccount } = useSelector(\n    (state) => state.auth,\n  );\n\n  const [selectedSheet, setSelectedSheet] = useState(null);\n  const [sheetContent, setSheetContent] = useState([]);\n  const [isEditing, setIsEditing] = useState(false);\n  const [editData, setEditData] = useState({});\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [filteredData, setFilteredData] = useState([]);\n  const [showCreateModal, setShowCreateModal] = useState(false);\n  const [newSheetName, setNewSheetName] = useState(\"\");\n  const [showColumnModal, setShowColumnModal] = useState(false);\n  const [newColumnName, setNewColumnName] = useState(\"\");\n  const [selectedRows, setSelectedRows] = useState([]);\n  const [spreadsheets, setSpreadsheets] = useState([]);\n  const [isLoadingMetadata, setIsLoadingMetadata] = useState(false);\n  const [isLoadingContent, setIsLoadingContent] = useState(false);\n  const [metadataError, setMetadataError] = useState(null);\n\n  // Load spreadsheet metadata on mount\n  useEffect(() => {\n    const loadMetadata = async () => {\n      setIsLoadingMetadata(true);\n      setMetadataError(null);\n      try {\n        const metadata = await googleSheetsApiService.getSheetMetadata();\n        // Transform metadata to match component structure\n        const spreadsheet = {\n          id:\n            import.meta.env.VITE_GOOGLE_SHEETS_SPREADSHEET_ID ||\n            \"18B1PIhCDmBWyHZytvOcfj_1QbYBwczLf1x1Qbu0E5As\",\n          title: metadata.title,\n          sheets: metadata.sheets.map((sheet, index) => ({\n            name: sheet.title,\n            id: sheet.sheetId,\n            rowCount: sheet.gridProperties?.rowCount || 0,\n            columnCount: sheet.gridProperties?.columnCount || 0,\n          })),\n        };\n        setSpreadsheets([spreadsheet]);\n      } catch (err) {\n        console.error(\"Failed to load sheet metadata:\", err);\n        setMetadataError(err.message);\n        // Fallback to empty state\n        setSpreadsheets([]);\n      } finally {\n        setIsLoadingMetadata(false);\n      }\n    };\n\n    loadMetadata();\n  }, []);\n\n  // Load sheet content when sheet is selected\n  useEffect(() => {\n    const loadSheetContent = async () => {\n      if (!selectedSheet) {\n        setSheetContent([]);\n        return;\n      }\n\n      setIsLoadingContent(true);\n      try {\n        // Read data from the selected sheet (use sheet name in range)\n        const sheetName = selectedSheet.name;\n        const range = `${sheetName}!A1:Z1000`;\n        const result = await googleSheetsApiService.readSheet(range);\n        setSheetContent(result.data || []);\n      } catch (err) {\n        console.error(\"Failed to load sheet content:\", err);\n        setSheetContent([]);\n      } finally {\n        setIsLoadingContent(false);\n      }\n    };\n\n    loadSheetContent();\n  }, [selectedSheet]);\n\n  useEffect(() => {\n    if (searchTerm) {\n      const filtered = sheetContent.filter((row) =>\n        row.some((cell) =>\n          cell.toString().toLowerCase().includes(searchTerm.toLowerCase()),\n        ),\n      );\n      setFilteredData(filtered);\n    } else {\n      setFilteredData(sheetContent);\n    }\n  }, [searchTerm, sheetContent]);\n\n  const handleSheetSelect = (sheet) => {\n    setSelectedSheet(sheet);\n    setIsEditing(false);\n    setEditData({});\n  };\n\n  // M·ªü Google Sheet tr·ª±c ti·∫øp tr√™n browser\n  const handleOpenSheetInGoogle = (sheet, spreadsheetId) => {\n    if (!spreadsheetId) {\n      spreadsheetId =\n        spreadsheets[0]?.id ||\n        import.meta.env.VITE_GOOGLE_SHEETS_SPREADSHEET_ID ||\n        \"18B1PIhCDmBWyHZytvOcfj_1QbYBwczLf1x1Qbu0E5As\";\n    }\n\n    // T·∫°o URL ƒë·ªÉ m·ªü sheet c·ª• th·ªÉ\n    // Format: https://docs.google.com/spreadsheets/d/{SPREADSHEET_ID}/edit#gid={SHEET_ID}\n    const sheetUrl = `https://docs.google.com/spreadsheets/d/${spreadsheetId}/edit#gid=${sheet.id}`;\n    window.open(sheetUrl, \"_blank\");\n  };\n\n  const handleCellEdit = (rowIndex, colIndex, value) => {\n    setEditData({\n      ...editData,\n      [`${rowIndex}-${colIndex}`]: value,\n    });\n  };\n\n  // const handleSave = () => {\n  //   // Simulate save operation\n  //   console.log(\"Saving data:\", editData);\n  //   setIsEditing(false);\n  //   setEditData({});\n  //   // Here you would dispatch an action to save to Google Sheets\n  // };\n\n  const handleExport = () => {\n    // Simulate export operation\n    const csvContent = filteredData.map((row) => row.join(\",\")).join(\"\\n\");\n    const blob = new Blob([csvContent], { type: \"text/csv\" });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = `${selectedSheet?.name || \"sheet\"}.csv`;\n    a.click();\n    window.URL.revokeObjectURL(url);\n  };\n\n  const handleCreateSheet = async () => {\n    if (!newSheetName.trim()) return;\n\n    try {\n      setIsLoadingMetadata(true);\n\n      // Get current spreadsheet ID\n      const spreadsheetId =\n        spreadsheets[0]?.id ||\n        import.meta.env.VITE_GOOGLE_SHEETS_SPREADSHEET_ID ||\n        \"18B1PIhCDmBWyHZytvOcfj_1QbYBwczLf1x1Qbu0E5As\";\n\n      // Call API to create new sheet\n      const newSheet = await googleSheetsApiService.addSheet(\n        newSheetName.trim(),\n        spreadsheetId,\n      );\n\n      // Reload metadata to show the new sheet\n      const metadata =\n        await googleSheetsApiService.getSheetMetadata(spreadsheetId);\n      const spreadsheet = {\n        id: spreadsheetId,\n        title: metadata.title,\n        sheets: metadata.sheets.map((sheet, index) => ({\n          name: sheet.title,\n          id: sheet.sheetId,\n          rowCount: sheet.gridProperties?.rowCount || 0,\n          columnCount: sheet.gridProperties?.columnCount || 0,\n        })),\n      };\n      setSpreadsheets([spreadsheet]);\n\n      // Select the newly created sheet\n      const createdSheet = spreadsheet.sheets.find(\n        (s) => s.id === newSheet.sheetId,\n      );\n      if (createdSheet) {\n        setSelectedSheet(createdSheet);\n      }\n\n      setNewSheetName(\"\");\n      setShowCreateModal(false);\n      setIsLoadingMetadata(false);\n    } catch (error) {\n      console.error(\"Error creating sheet:\", error);\n      alert(`L·ªói t·∫°o sheet: ${error.message}`);\n      setIsLoadingMetadata(false);\n    }\n  };\n\n  const handleAddColumn = () => {\n    if (!newColumnName.trim() || !selectedSheet) return;\n\n    const updatedContent = sheetContent.map((row, index) => {\n      if (index === 0) {\n        // Header row\n        return [...row, newColumnName];\n      } else {\n        // Data rows\n        return [...row, \"\"];\n      }\n    });\n\n    setSheetContent(updatedContent);\n    setNewColumnName(\"\");\n    setShowColumnModal(false);\n  };\n\n  const handleDeleteColumn = (columnIndex) => {\n    if (!selectedSheet) return;\n\n    const updatedContent = sheetContent.map((row) =>\n      row.filter((_, index) => index !== columnIndex),\n    );\n\n    setSheetContent(updatedContent);\n  };\n\n  const handleAddRow = () => {\n    if (!selectedSheet) return;\n\n    const newRow = Array(selectedSheet.headers.length).fill(\"\");\n    setSheetContent([...sheetContent, newRow]);\n  };\n\n  const handleDeleteRow = (rowIndex) => {\n    const updatedContent = sheetContent.filter(\n      (_, index) => index !== rowIndex,\n    );\n    setSheetContent(updatedContent);\n  };\n\n  const handleDeleteEmptyRows = () => {\n    const updatedContent = sheetContent.filter((row) =>\n      row.some((cell) => cell.toString().trim() !== \"\"),\n    );\n    setSheetContent(updatedContent);\n  };\n\n  const handleRowSelect = (rowIndex) => {\n    setSelectedRows((prev) =>\n      prev.includes(rowIndex)\n        ? prev.filter((index) => index !== rowIndex)\n        : [...prev, rowIndex],\n    );\n  };\n\n  const handleSelectAllRows = () => {\n    const allRowIndices = sheetContent.map((_, index) => index);\n    setSelectedRows(\n      selectedRows.length === allRowIndices.length ? [] : allRowIndices,\n    );\n  };\n\n  const handleDeleteSelectedRows = () => {\n    const updatedContent = sheetContent.filter(\n      (_, index) => !selectedRows.includes(index),\n    );\n    setSheetContent(updatedContent);\n    setSelectedRows([]);\n  };\n\n  const handleViewId = (item) => {\n    alert(`ID: ${item.id || selectedSheet?.id}`);\n  };\n\n  const handleMoveRow = (fromIndex, toIndex) => {\n    const updatedContent = [...sheetContent];\n    const [movedRow] = updatedContent.splice(fromIndex, 1);\n    updatedContent.splice(toIndex, 0, movedRow);\n    setSheetContent(updatedContent);\n  };\n\n  if (loading) {\n    return <Loading text=\"ƒêang t·∫£i Google Sheets...\" fullScreen />;\n  }\n\n  if (error) {\n    return (\n      <div className=\"sheets-error\">\n        <h3>L·ªói k·∫øt n·ªëi Google Sheets</h3>\n        <p>{error}</p>\n        <button onClick={() => window.location.reload()}>Th·ª≠ l·∫°i</button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"google-sheets-integration dashboard-container\">\n      {/* Header */}\n      <div className=\"sheets-header page-header\">\n        <div className=\"header-title-group\">\n          <h2>üìä Google Sheets Integration</h2>\n        </div>\n        <div className=\"sheets-controls page-controls\">\n          <button\n            className=\"btn btn-primary\"\n            onClick={() => setShowCreateModal(true)}\n          >\n            ‚ûï T·∫°o sheet m·ªõi\n          </button>\n          {selectedSheet && (\n            <>\n              <button\n                className=\"btn btn-secondary\"\n                onClick={() => setIsEditing(!isEditing)}\n              >\n                {isEditing ? \"üíæ L∆∞u\" : \"‚úèÔ∏è Ch·ªânh s·ª≠a\"}\n              </button>\n              <button className=\"btn btn-primary\" onClick={handleExport}>\n                üì• Xu·∫•t CSV\n              </button>\n            </>\n          )}\n        </div>\n      </div>\n\n      <div className=\"sheets-content two-column-layout\">\n        {/* Sidebar - Sheet List */}\n        <div className=\"sheets-sidebar\">\n          <div className=\"sidebar-header\">\n            <h3>üìã Danh s√°ch Sheets</h3>\n            {isLoadingMetadata ? (\n              <span className=\"sheets-count\">ƒêang t·∫£i...</span>\n            ) : (\n              <span className=\"sheets-count\">\n                {spreadsheets.reduce((sum, s) => sum + s.sheets.length, 0)}{\" \"}\n                sheets\n              </span>\n            )}\n          </div>\n\n          {metadataError && (\n            <div\n              className=\"error-banner\"\n              style={{\n                padding: \"10px\",\n                margin: \"10px\",\n                backgroundColor: \"#ffebee\",\n                color: \"#c62828\",\n                borderRadius: \"4px\",\n              }}\n            >\n              ‚ö†Ô∏è L·ªói t·∫£i metadata: {metadataError}\n            </div>\n          )}\n\n          <div className=\"sheets-list\">\n            {isLoadingMetadata ? (\n              <div style={{ padding: \"20px\", textAlign: \"center\" }}>\n                ƒêang t·∫£i...\n              </div>\n            ) : spreadsheets.length === 0 ? (\n              <div style={{ padding: \"20px\", textAlign: \"center\" }}>\n                Kh√¥ng c√≥ sheets n√†o\n              </div>\n            ) : (\n              spreadsheets.map((spreadsheet) => (\n                <div key={spreadsheet.id} className=\"spreadsheet-group\">\n                  <div className=\"spreadsheet-title\">{spreadsheet.title}</div>\n                  {spreadsheet.sheets.map((sheet) => (\n                    <div\n                      key={sheet.id}\n                      className={`sheet-item ${\n                        selectedSheet?.id === sheet.id ? \"active\" : \"\"\n                      }`}\n                      onClick={() => handleSheetSelect(sheet)}\n                      onDoubleClick={() =>\n                        handleOpenSheetInGoogle(sheet, spreadsheet.id)\n                      }\n                      title=\"Double-click ƒë·ªÉ m·ªü tr√™n Google Sheets\"\n                    >\n                      <div className=\"sheet-info\">\n                        <div className=\"sheet-header-item\">\n                          <span className=\"sheet-name\">{sheet.name}</span>\n                          <div className=\"sheet-status-container\">\n                            <span className=\"sheet-status\">üìä</span>\n                            {selectedSheet?.id === sheet.id && (\n                              <span className=\"sheet-active-tag\">\n                                ƒêang ho·∫°t ƒë·ªông\n                              </span>\n                            )}\n                          </div>\n                        </div>\n                        <div className=\"sheet-description\">\n                          Google Sheets - {sheet.rowCount} h√†ng √ó{\" \"}\n                          {sheet.columnCount} c·ªôt\n                        </div>\n                        <div className=\"sheet-meta\">\n                          <span className=\"sheet-trigger\">üìä sheets</span>\n                          <span className=\"sheet-action\">üìÖ sync</span>\n                        </div>\n                        <div className=\"sheet-stats\">\n                          <span>{sheet.rowCount} b·∫£n ghi</span>\n                          <span>100% ho√†n th√†nh</span>\n                        </div>\n                      </div>\n                      <div className=\"sheet-actions\">\n                        <button\n                          className=\"action-btn\"\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            handleOpenSheetInGoogle(sheet, spreadsheet.id);\n                          }}\n                          title=\"M·ªü tr√™n Google Sheets\"\n                        >\n                          üîó\n                        </button>\n                        <button\n                          className=\"action-btn\"\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            alert(\"Th√™m c·ªôt v√†o \" + sheet.name);\n                          }}\n                          title=\"Th√™m c·ªôt\"\n                        >\n                          ‚ûï\n                        </button>\n                        <button\n                          className=\"action-btn\"\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            alert(\"Th√™m h√†ng v√†o \" + sheet.name);\n                          }}\n                          title=\"Th√™m h√†ng\"\n                        >\n                          üìù\n                        </button>\n                        <button\n                          className=\"action-btn\"\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            alert(\"X√≥a d√≤ng tr·ªëng trong \" + sheet.name);\n                          }}\n                          title=\"X√≥a d√≤ng tr·ªëng\"\n                        >\n                          üóëÔ∏è\n                        </button>\n                        <button\n                          className=\"action-btn\"\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            handleViewId(sheet);\n                          }}\n                          title=\"Xem ID\"\n                        >\n                          üëÅÔ∏è\n                        </button>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              ))\n            )}\n          </div>\n        </div>\n\n        {/* Main Content - Sheet Data */}\n        <div className=\"sheets-main-content\">\n          {isLoadingContent ? (\n            <div style={{ padding: \"40px\", textAlign: \"center\" }}>\n              <Loading text=\"ƒêang t·∫£i d·ªØ li·ªáu sheet...\" />\n            </div>\n          ) : selectedSheet ? (\n            <>\n              <div className=\"sheet-header\">\n                <div className=\"sheet-info-section\">\n                  <div className=\"sheet-title-info\">\n                    <h3>{selectedSheet.name}</h3>\n                    <span className=\"sheet-dimensions\">\n                      {selectedSheet.rowCount} h√†ng √ó{\" \"}\n                      {selectedSheet.columnCount} c·ªôt\n                    </span>\n                  </div>\n                  <button\n                    className=\"btn btn-link\"\n                    onClick={() => {\n                      const spreadsheetId =\n                        spreadsheets[0]?.id ||\n                        import.meta.env.VITE_GOOGLE_SHEETS_SPREADSHEET_ID ||\n                        \"18B1PIhCDmBWyHZytvOcfj_1QbYBwczLf1x1Qbu0E5As\";\n                      handleOpenSheetInGoogle(selectedSheet, spreadsheetId);\n                    }}\n                    title=\"M·ªü tr√™n Google Sheets\"\n                    style={{ marginLeft: \"10px\", padding: \"4px 8px\" }}\n                  >\n                    üîó M·ªü tr√™n Google Sheets\n                  </button>\n                </div>\n                <div className=\"sheet-actions\">\n                  <input\n                    type=\"text\"\n                    placeholder=\"üîç T√¨m ki·∫øm...\"\n                    value={searchTerm}\n                    onChange={(e) => setSearchTerm(e.target.value)}\n                    className=\"search-input\"\n                  />\n                  <span className=\"row-count\">{filteredData.length} rows</span>\n                </div>\n              </div>\n\n              <div className=\"sheet-table-container\">\n                {filteredData.length === 0 ? (\n                  <div style={{ padding: \"40px\", textAlign: \"center\" }}>\n                    <p>Sheet tr·ªëng ho·∫∑c kh√¥ng c√≥ d·ªØ li·ªáu</p>\n                  </div>\n                ) : (\n                  <table className=\"sheet-table\">\n                    <thead>\n                      <tr>\n                        {filteredData[0].map((header, index) => (\n                          <th key={index}>{header}</th>\n                        ))}\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {filteredData.slice(1).map((row, rowIndex) => (\n                        <tr key={rowIndex}>\n                          {row.map((cell, colIndex) => (\n                            <td key={colIndex}>\n                              {isEditing ? (\n                                <input\n                                  type=\"text\"\n                                  value={\n                                    editData[`${rowIndex + 1}-${colIndex}`] ||\n                                    cell\n                                  }\n                                  onChange={(e) =>\n                                    handleCellEdit(\n                                      rowIndex + 1,\n                                      colIndex,\n                                      e.target.value,\n                                    )\n                                  }\n                                  className=\"cell-input\"\n                                />\n                              ) : (\n                                <span className=\"cell-content\">{cell}</span>\n                              )}\n                            </td>\n                          ))}\n                        </tr>\n                      ))}\n                    </tbody>\n                  </table>\n                )}\n              </div>\n            </>\n          ) : (\n            <div className=\"no-sheet-selected\">\n              <div className=\"no-sheet-icon\">üìä</div>\n              <h3>Ch·ªçn m·ªôt sheet ƒë·ªÉ xem d·ªØ li·ªáu</h3>\n              <p>Nh·∫•p v√†o m·ªôt sheet trong danh s√°ch b√™n tr√°i ƒë·ªÉ b·∫Øt ƒë·∫ßu</p>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Create Sheet Modal */}\n      {showCreateModal && (\n        <div className=\"modal-overlay\">\n          <div className=\"modal\">\n            <div className=\"modal-header\">\n              <h3>T·∫°o sheet m·ªõi</h3>\n              <button\n                className=\"close-btn\"\n                onClick={() => setShowCreateModal(false)}\n              >\n                ‚úï\n              </button>\n            </div>\n            <div className=\"modal-body\">\n              <div className=\"form-group\">\n                <label>T√™n sheet</label>\n                <input\n                  type=\"text\"\n                  value={newSheetName}\n                  onChange={(e) => setNewSheetName(e.target.value)}\n                  placeholder=\"Nh·∫≠p t√™n sheet...\"\n                  className=\"input-field\"\n                />\n              </div>\n            </div>\n            <div className=\"modal-footer\">\n              <button\n                className=\"btn btn-secondary\"\n                onClick={() => setShowCreateModal(false)}\n              >\n                H·ªßy\n              </button>\n              <button\n                className=\"btn btn-primary\"\n                onClick={handleCreateSheet}\n                disabled={!newSheetName.trim()}\n              >\n                T·∫°o sheet\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Add Column Modal */}\n      {showColumnModal && (\n        <div className=\"modal-overlay\">\n          <div className=\"modal\">\n            <div className=\"modal-header\">\n              <h3>Th√™m c·ªôt m·ªõi</h3>\n              <button\n                className=\"close-btn\"\n                onClick={() => setShowColumnModal(false)}\n              >\n                ‚úï\n              </button>\n            </div>\n            <div className=\"modal-body\">\n              <div className=\"form-group\">\n                <label>T√™n c·ªôt</label>\n                <input\n                  type=\"text\"\n                  value={newColumnName}\n                  onChange={(e) => setNewColumnName(e.target.value)}\n                  placeholder=\"Nh·∫≠p t√™n c·ªôt...\"\n                  className=\"input-field\"\n                />\n              </div>\n            </div>\n            <div className=\"modal-footer\">\n              <button\n                className=\"btn btn-secondary\"\n                onClick={() => setShowColumnModal(false)}\n              >\n                H·ªßy\n              </button>\n              <button\n                className=\"btn btn-primary\"\n                onClick={handleAddColumn}\n                disabled={!newColumnName.trim()}\n              >\n                Th√™m c·ªôt\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default GoogleSheetsIntegration;\n"],"names":["API_BASE_URL","env","VITE_API_BASE_URL","googleSheetsApiService","readSheet","range","arguments","length","undefined","sheetId","params","response","axios","get","concat","data","majorDimension","error","_error$response","_error$response$data","console","Error","message","writeSheet","values","post","_error$response2","_error$response2$data","appendToSheet","_error$response3","_error$response3$data","getSheetMetadata","url","_error$response4","_error$response4$data","clearSheet","delete","_error$response5","_error$response5$data","addSheet","sheetName","_error$response6","_error$response6$data","GoogleSheetsIntegration","loading","useSelector","state","sheets","isAuthenticated","serviceAccount","auth","selectedSheet","setSelectedSheet","useState","sheetContent","setSheetContent","isEditing","setIsEditing","editData","setEditData","searchTerm","setSearchTerm","filteredData","setFilteredData","showCreateModal","setShowCreateModal","newSheetName","setNewSheetName","showColumnModal","setShowColumnModal","newColumnName","setNewColumnName","selectedRows","setSelectedRows","spreadsheets","setSpreadsheets","isLoadingMetadata","setIsLoadingMetadata","isLoadingContent","setIsLoadingContent","metadataError","setMetadataError","useEffect","async","metadata","spreadsheet","id","VITE_GOOGLE_SHEETS_SPREADSHEET_ID","title","map","sheet","index","_sheet$gridProperties","_sheet$gridProperties2","name","rowCount","gridProperties","columnCount","err","loadMetadata","result","loadSheetContent","filtered","filter","row","some","cell","toString","toLowerCase","includes","handleOpenSheetInGoogle","spreadsheetId","_spreadsheets$","sheetUrl","window","open","_jsx","Loading","text","fullScreen","_jsxs","className","children","onClick","location","reload","_Fragment","handleExport","csvContent","join","blob","Blob","type","URL","createObjectURL","a","document","createElement","href","download","click","revokeObjectURL","reduce","sum","s","style","padding","margin","backgroundColor","color","borderRadius","textAlign","handleSheetSelect","onDoubleClick","e","stopPropagation","alert","_spreadsheets$3","marginLeft","placeholder","value","onChange","target","header","slice","rowIndex","colIndex","handleCellEdit","_objectSpread","trim","_spreadsheets$2","newSheet","_sheet$gridProperties3","_sheet$gridProperties4","createdSheet","find","disabled","handleAddColumn","updatedContent"],"ignoreList":[],"sourceRoot":""}