{"version":3,"file":"static/js/security-dashboard.5ba6a88a.chunk.js","mappings":"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","sources":["components/security/MFASetup.jsx","components/security/SSOLogin.jsx","components/security/UserManagement.jsx","components/security/AuditLogsViewer.jsx","components/security/SecuritySettings.jsx","components/security/SecurityDashboard.jsx","utils/exportUtils.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport {\n  message,\n  Card,\n  Button,\n  Input,\n  Steps,\n  QRCode,\n  Space,\n  Divider,\n  Alert,\n  Spin,\n} from \"antd\";\nimport {\n  SafetyOutlined,\n  CheckCircleOutlined,\n  CloseCircleOutlined,\n  ReloadOutlined,\n  LockOutlined,\n} from \"@ant-design/icons\";\nimport securityService from \"../../services/securityService\";\nimport \"./Security.css\";\n\nconst { Step } = Steps;\n\nconst MFASetup = () => {\n  const [current, setCurrent] = useState(0);\n  const [loading, setLoading] = useState(false);\n  const [mfaEnabled, setMfaEnabled] = useState(false);\n  const [mfaSecret, setMfaSecret] = useState(null);\n  const [verificationToken, setVerificationToken] = useState(\"\");\n  const [userProfile, setUserProfile] = useState(null);\n\n  useEffect(() => {\n    loadUserProfile();\n  }, []);\n\n  const loadUserProfile = async () => {\n    try {\n      const profile = await securityService.getCurrentUser();\n      setUserProfile(profile?.user || profile);\n      setMfaEnabled(profile?.user?.mfaEnabled || profile?.mfaEnabled || false);\n    } catch (error) {\n      console.error(\"Load user profile error:\", error);\n    }\n  };\n\n  const handleGenerateSecret = async () => {\n    setLoading(true);\n    try {\n      const secretData = await securityService.generateMFASecret();\n      setMfaSecret(secretData);\n      setCurrent(1);\n      message.success(\"MFA secret đã được tạo!\");\n    } catch (error) {\n      message.error(error.message || \"Không thể tạo MFA secret\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleEnableMFA = async () => {\n    if (!verificationToken) {\n      message.warning(\"Vui lòng nhập mã xác thực\");\n      return;\n    }\n\n    setLoading(true);\n    try {\n      await securityService.enableMFA(verificationToken);\n      setMfaEnabled(true);\n      setCurrent(2);\n      message.success(\"MFA đã được kích hoạt thành công!\");\n      await loadUserProfile();\n    } catch (error) {\n      message.error(\n        error.message ||\n          \"Không thể kích hoạt MFA. Vui lòng kiểm tra mã xác thực.\",\n      );\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleDisableMFA = async () => {\n    setLoading(true);\n    try {\n      await securityService.disableMFA();\n      setMfaEnabled(false);\n      setMfaSecret(null);\n      setCurrent(0);\n      message.success(\"MFA đã được tắt thành công!\");\n      await loadUserProfile();\n    } catch (error) {\n      message.error(error.message || \"Không thể tắt MFA\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleReset = () => {\n    setCurrent(0);\n    setMfaSecret(null);\n    setVerificationToken(\"\");\n  };\n\n  const otpAuthUrl = mfaSecret\n    ? `otpauth://totp/MIA.vn:${userProfile?.email || \"user\"}?secret=${mfaSecret.secret}&issuer=MIA.vn`\n    : \"\";\n\n  if (loading && !mfaSecret) {\n    return (\n      <div style={{ textAlign: \"center\", padding: \"40px\" }}>\n        <Spin size=\"large\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"security-container\">\n      <Card\n        title={\n          <Space>\n            <SafetyOutlined />\n            <span>Xác thực hai lớp (MFA)</span>\n          </Space>\n        }\n        className=\"security-card\"\n      >\n        {mfaEnabled && current !== 2 ? (\n          <Alert\n            message=\"MFA đã được kích hoạt\"\n            description=\"Tài khoản của bạn đã được bảo vệ bằng xác thực hai lớp.\"\n            type=\"success\"\n            icon={<CheckCircleOutlined />}\n            showIcon\n            action={\n              <Button\n                danger\n                onClick={handleDisableMFA}\n                loading={loading}\n                icon={<CloseCircleOutlined />}\n              >\n                Tắt MFA\n              </Button>\n            }\n            style={{ marginBottom: \"24px\" }}\n          />\n        ) : null}\n\n        <Steps current={current} onChange={setCurrent}>\n          <Step title=\"Bắt đầu\" description=\"Tạo MFA secret\" />\n          <Step title=\"Quét QR Code\" description=\"Xác thực thiết bị\" />\n          <Step title=\"Hoàn tất\" description=\"MFA đã kích hoạt\" />\n        </Steps>\n\n        <Divider />\n\n        {current === 0 && (\n          <div className=\"mfa-step-content\">\n            <div style={{ textAlign: \"center\", marginBottom: \"24px\" }}>\n              <LockOutlined style={{ fontSize: \"64px\", color: \"#1890ff\" }} />\n              <h3 style={{ marginTop: \"16px\" }}>Bảo vệ tài khoản của bạn</h3>\n              <p style={{ color: \"#666\", maxWidth: \"500px\", margin: \"0 auto\" }}>\n                Xác thực hai lớp (MFA) giúp bảo vệ tài khoản của bạn bằng cách\n                yêu cầu mã xác thực từ ứng dụng xác thực trên điện thoại khi\n                đăng nhập.\n              </p>\n            </div>\n\n            <div style={{ textAlign: \"center\" }}>\n              <Button\n                type=\"primary\"\n                size=\"large\"\n                icon={<SafetyOutlined />}\n                onClick={handleGenerateSecret}\n                loading={loading}\n              >\n                Tạo MFA Secret\n              </Button>\n            </div>\n          </div>\n        )}\n\n        {current === 1 && mfaSecret && (\n          <div className=\"mfa-step-content\">\n            <Alert\n              message=\"Quét QR Code bằng ứng dụng xác thực\"\n              description=\"Sử dụng Google Authenticator, Microsoft Authenticator, hoặc ứng dụng tương tự để quét mã QR.\"\n              type=\"info\"\n              showIcon\n              style={{ marginBottom: \"24px\" }}\n            />\n\n            <div style={{ textAlign: \"center\", marginBottom: \"24px\" }}>\n              <QRCode\n                value={otpAuthUrl}\n                size={256}\n                style={{ margin: \"0 auto\" }}\n              />\n            </div>\n\n            <div style={{ marginBottom: \"24px\", textAlign: \"center\" }}>\n              <p style={{ marginBottom: \"8px\", fontWeight: \"bold\" }}>\n                Hoặc nhập mã thủ công:\n              </p>\n              <Input\n                value={mfaSecret.manualEntryKey || mfaSecret.secret}\n                readOnly\n                style={{\n                  maxWidth: \"300px\",\n                  textAlign: \"center\",\n                  fontFamily: \"monospace\",\n                  fontSize: \"16px\",\n                  letterSpacing: \"2px\",\n                }}\n              />\n            </div>\n\n            <Divider>Nhập mã xác thực</Divider>\n\n            <div style={{ maxWidth: \"400px\", margin: \"0 auto\" }}>\n              <Input\n                placeholder=\"Nhập mã 6 chữ số từ ứng dụng\"\n                value={verificationToken}\n                onChange={(e) => setVerificationToken(e.target.value)}\n                maxLength={6}\n                style={{\n                  fontSize: \"20px\",\n                  textAlign: \"center\",\n                  letterSpacing: \"4px\",\n                  fontFamily: \"monospace\",\n                  marginBottom: \"16px\",\n                }}\n              />\n              <Space style={{ width: \"100%\", justifyContent: \"center\" }}>\n                <Button onClick={handleReset} icon={<ReloadOutlined />}>\n                  Quay lại\n                </Button>\n                <Button\n                  type=\"primary\"\n                  onClick={handleEnableMFA}\n                  loading={loading}\n                  disabled={verificationToken.length !== 6}\n                  icon={<CheckCircleOutlined />}\n                >\n                  Kích hoạt MFA\n                </Button>\n              </Space>\n            </div>\n          </div>\n        )}\n\n        {current === 2 && (\n          <div className=\"mfa-step-content\">\n            <div style={{ textAlign: \"center\" }}>\n              <CheckCircleOutlined\n                style={{ fontSize: \"64px\", color: \"#52c41a\" }}\n              />\n              <h3 style={{ marginTop: \"16px\", color: \"#52c41a\" }}>\n                MFA đã được kích hoạt thành công!\n              </h3>\n              <p style={{ color: \"#666\", marginBottom: \"24px\" }}>\n                Tài khoản của bạn giờ đã được bảo vệ bằng xác thực hai lớp. Bạn\n                sẽ cần nhập mã xác thực mỗi khi đăng nhập.\n              </p>\n              <Button type=\"primary\" onClick={() => setCurrent(0)}>\n                Quay lại\n              </Button>\n            </div>\n          </div>\n        )}\n      </Card>\n    </div>\n  );\n};\n\nexport default MFASetup;\n","import React, { useState, useEffect } from \"react\";\nimport { Card, Button, Space, Divider, Alert, Spin } from \"antd\";\nimport {\n  GoogleOutlined,\n  GithubOutlined,\n  WindowsOutlined,\n  LoginOutlined,\n  SafetyOutlined,\n} from \"@ant-design/icons\";\nimport { message } from \"antd\";\nimport securityService from \"../../services/securityService\";\nimport \"./Security.css\";\n\nconst SSOLogin = () => {\n  const [loading, setLoading] = useState(null);\n  const [providers, setProviders] = useState([\n    {\n      id: \"google\",\n      name: \"Google\",\n      icon: <GoogleOutlined />,\n      color: \"#4285F4\",\n    },\n    {\n      id: \"github\",\n      name: \"GitHub\",\n      icon: <GithubOutlined />,\n      color: \"#24292e\",\n    },\n    {\n      id: \"microsoft\",\n      name: \"Microsoft\",\n      icon: <WindowsOutlined />,\n      color: \"#00A1F1\",\n    },\n  ]);\n\n  const handleSSOLogin = async (provider) => {\n    setLoading(provider);\n    try {\n      // Get authorization URL\n      const authData = await securityService.getSSOAuthUrl(provider);\n\n      if (authData?.authUrl) {\n        // Redirect to OAuth provider\n        window.location.href = authData.authUrl;\n      } else {\n        message.error(`Không thể lấy URL xác thực từ ${provider}`);\n        setLoading(null);\n      }\n    } catch (error) {\n      console.error(`SSO login error for ${provider}:`, error);\n      message.error(error.message || `Đăng nhập ${provider} thất bại`);\n      setLoading(null);\n    }\n  };\n\n  // Handle SSO callback from URL params\n  useEffect(() => {\n    if (typeof window !== \"undefined\" && window.location) {\n      const urlParams = new (window.URLSearchParams || URLSearchParams)(\n        window.location.search,\n      );\n      const code = urlParams.get(\"code\");\n      const state = urlParams.get(\"state\");\n      const provider =\n        urlParams.get(\"provider\") || (state ? state.split(\"_\")[0] : null);\n\n      if (code && provider) {\n        handleSSOCallback(provider, code, state);\n      }\n    }\n  }, []);\n\n  const handleSSOCallback = async (provider, code, state) => {\n    setLoading(provider);\n    try {\n      const userData = await securityService.handleSSOCallback(\n        provider,\n        code,\n        state,\n      );\n\n      if (userData?.token) {\n        message.success(`Đăng nhập ${provider} thành công!`);\n        // Redirect to dashboard or home\n        setTimeout(() => {\n          window.location.href = \"/\";\n        }, 1000);\n      } else {\n        message.error(`Đăng nhập ${provider} thất bại`);\n      }\n    } catch (error) {\n      console.error(`SSO callback error for ${provider}:`, error);\n      message.error(error.message || `Đăng nhập ${provider} thất bại`);\n    } finally {\n      setLoading(null);\n      // Clean URL\n      window.history.replaceState({}, document.title, window.location.pathname);\n    }\n  };\n\n  return (\n    <div className=\"security-container\">\n      <Card\n        title={\n          <Space>\n            <LoginOutlined />\n            <span>Đăng nhập bằng SSO</span>\n          </Space>\n        }\n        className=\"security-card\"\n      >\n        <Alert\n          message=\"Đăng nhập nhanh và an toàn\"\n          description=\"Sử dụng tài khoản Google, GitHub, hoặc Microsoft để đăng nhập. Không cần nhớ mật khẩu riêng.\"\n          type=\"info\"\n          icon={<SafetyOutlined />}\n          showIcon\n          style={{ marginBottom: \"24px\" }}\n        />\n\n        <div className=\"sso-buttons-container\">\n          <Space direction=\"vertical\" size=\"middle\" style={{ width: \"100%\" }}>\n            {providers.map((provider) => (\n              <Button\n                key={provider.id}\n                type=\"primary\"\n                size=\"large\"\n                icon={provider.icon}\n                loading={loading === provider.id}\n                onClick={() => handleSSOLogin(provider.id)}\n                style={{\n                  width: \"100%\",\n                  height: \"50px\",\n                  backgroundColor:\n                    loading === provider.id ? \"#d9d9d9\" : provider.color,\n                  borderColor: provider.color,\n                  display: \"flex\",\n                  alignItems: \"center\",\n                  justifyContent: \"center\",\n                  gap: \"8px\",\n                }}\n                disabled={loading !== null}\n              >\n                Đăng nhập với {provider.name}\n              </Button>\n            ))}\n          </Space>\n        </div>\n\n        <Divider>Hoặc</Divider>\n\n        <div style={{ textAlign: \"center\", color: \"#666\" }}>\n          <p>\n            Bạn có thể sử dụng email và mật khẩu để đăng nhập{\" \"}\n            <a href=\"/login\">tại đây</a>\n          </p>\n        </div>\n\n        {loading && (\n          <div style={{ textAlign: \"center\", marginTop: \"24px\" }}>\n            <Spin size=\"large\" />\n            <p style={{ marginTop: \"16px\", color: \"#666\" }}>\n              Đang chuyển hướng đến nhà cung cấp...\n            </p>\n          </div>\n        )}\n      </Card>\n    </div>\n  );\n};\n\nexport default SSOLogin;\n","import React, { useState, useEffect } from \"react\";\nimport {\n  Table,\n  Card,\n  Button,\n  Space,\n  Tag,\n  Modal,\n  Select,\n  message,\n  Popconfirm,\n  Tooltip,\n  Input,\n  Badge,\n} from \"antd\";\nimport {\n  UserOutlined,\n  EditOutlined,\n  DeleteOutlined,\n  ReloadOutlined,\n  PlusOutlined,\n  SafetyOutlined,\n  SearchOutlined,\n} from \"@ant-design/icons\";\nimport securityService from \"../../services/securityService\";\nimport \"./Security.css\";\n\nconst { Option } = Select;\n\nconst ROLE_COLORS = {\n  admin: \"red\",\n  manager: \"orange\",\n  user: \"blue\",\n  guest: \"default\",\n};\n\nconst ROLE_LABELS = {\n  admin: \"Quản trị viên\",\n  manager: \"Quản lý\",\n  user: \"Người dùng\",\n  guest: \"Khách\",\n};\n\nconst UserManagement = () => {\n  const [users, setUsers] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [searchText, setSearchText] = useState(\"\");\n  const [editingUser, setEditingUser] = useState(null);\n  const [editModalVisible, setEditModalVisible] = useState(false);\n  const [newRole, setNewRole] = useState(null);\n\n  useEffect(() => {\n    loadUsers();\n  }, []);\n\n  const loadUsers = async () => {\n    setLoading(true);\n    try {\n      const data = await securityService.getAllUsers();\n      setUsers(Array.isArray(data) ? data : data?.users || []);\n    } catch (error) {\n      console.error(\"Load users error:\", error);\n      message.error(\"Không thể tải danh sách người dùng\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleEditRole = (user) => {\n    setEditingUser(user);\n    setNewRole(user.role);\n    setEditModalVisible(true);\n  };\n\n  const handleSaveRole = async () => {\n    if (!editingUser || !newRole) {\n      message.warning(\"Vui lòng chọn vai trò mới\");\n      return;\n    }\n\n    setLoading(true);\n    try {\n      await securityService.updateUserRole(editingUser.id, newRole);\n      message.success(`Đã cập nhật vai trò của ${editingUser.email}`);\n      setEditModalVisible(false);\n      setEditingUser(null);\n      setNewRole(null);\n      await loadUsers();\n    } catch (error) {\n      console.error(\"Update role error:\", error);\n      message.error(error.message || \"Không thể cập nhật vai trò\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleDeleteUser = async (userId, email) => {\n    setLoading(true);\n    try {\n      await securityService.deleteUser(userId);\n      message.success(`Đã xóa người dùng ${email}`);\n      await loadUsers();\n    } catch (error) {\n      console.error(\"Delete user error:\", error);\n      message.error(error.message || \"Không thể xóa người dùng\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const filteredUsers = users.filter((user) => {\n    if (!searchText) return true;\n    const searchLower = searchText.toLowerCase();\n    return (\n      user.email?.toLowerCase().includes(searchLower) ||\n      user.role?.toLowerCase().includes(searchLower) ||\n      user.id?.toString().includes(searchLower)\n    );\n  });\n\n  const columns = [\n    {\n      title: \"Email\",\n      dataIndex: \"email\",\n      key: \"email\",\n      render: (text, record) => (\n        <Space>\n          <UserOutlined />\n          <span>{text || \"N/A\"}</span>\n          {record.mfaEnabled && (\n            <Tooltip title=\"MFA đã kích hoạt\">\n              <Badge status=\"success\" />\n            </Tooltip>\n          )}\n        </Space>\n      ),\n      sorter: (a, b) => (a.email || \"\").localeCompare(b.email || \"\"),\n    },\n    {\n      title: \"Vai trò\",\n      dataIndex: \"role\",\n      key: \"role\",\n      render: (role) => (\n        <Tag color={ROLE_COLORS[role] || \"default\"}>\n          {ROLE_LABELS[role] || role}\n        </Tag>\n      ),\n      filters: Object.keys(ROLE_LABELS).map((role) => ({\n        text: ROLE_LABELS[role],\n        value: role,\n      })),\n      onFilter: (value, record) => record.role === value,\n    },\n    {\n      title: \"MFA\",\n      dataIndex: \"mfaEnabled\",\n      key: \"mfaEnabled\",\n      render: (enabled) => (\n        <Tag color={enabled ? \"green\" : \"default\"}>\n          {enabled ? \"Đã bật\" : \"Chưa bật\"}\n        </Tag>\n      ),\n      filters: [\n        { text: \"Đã bật\", value: true },\n        { text: \"Chưa bật\", value: false },\n      ],\n      onFilter: (value, record) => record.mfaEnabled === value,\n    },\n    {\n      title: \"Quyền\",\n      dataIndex: \"permissions\",\n      key: \"permissions\",\n      render: (permissions) => {\n        if (!permissions || !Array.isArray(permissions)) return \"N/A\";\n        return (\n          <Space wrap>\n            {permissions.slice(0, 3).map((perm) => (\n              <Tag key={perm} color=\"blue\">\n                {perm}\n              </Tag>\n            ))}\n            {permissions.length > 3 && (\n              <Tag color=\"default\">+{permissions.length - 3}</Tag>\n            )}\n          </Space>\n        );\n      },\n    },\n    {\n      title: \"Hành động\",\n      key: \"action\",\n      render: (_, record) => (\n        <Space>\n          <Tooltip title=\"Chỉnh sửa vai trò\">\n            <Button\n              type=\"link\"\n              icon={<EditOutlined />}\n              onClick={() => handleEditRole(record)}\n            >\n              Sửa\n            </Button>\n          </Tooltip>\n          <Popconfirm\n            title={`Bạn có chắc muốn xóa người dùng ${record.email}?`}\n            description=\"Hành động này không thể hoàn tác.\"\n            onConfirm={() => handleDeleteUser(record.id, record.email)}\n            okText=\"Xóa\"\n            cancelText=\"Hủy\"\n            okButtonProps={{ danger: true }}\n          >\n            <Tooltip title=\"Xóa người dùng\">\n              <Button\n                type=\"link\"\n                danger\n                icon={<DeleteOutlined />}\n                disabled={record.role === \"admin\"}\n              >\n                Xóa\n              </Button>\n            </Tooltip>\n          </Popconfirm>\n        </Space>\n      ),\n    },\n  ];\n\n  return (\n    <div className=\"security-container\">\n      <Card\n        title={\n          <Space>\n            <UserOutlined />\n            <span>Quản lý người dùng</span>\n          </Space>\n        }\n        className=\"security-card\"\n        extra={\n          <Space>\n            <Input\n              placeholder=\"Tìm kiếm email, vai trò...\"\n              prefix={<SearchOutlined />}\n              value={searchText}\n              onChange={(e) => setSearchText(e.target.value)}\n              style={{ width: \"250px\" }}\n              allowClear\n            />\n            <Button\n              icon={<ReloadOutlined />}\n              onClick={loadUsers}\n              loading={loading}\n            >\n              Làm mới\n            </Button>\n          </Space>\n        }\n      >\n        <Table\n          columns={columns}\n          dataSource={filteredUsers}\n          rowKey=\"id\"\n          loading={loading}\n          pagination={{\n            pageSize: 10,\n            showSizeChanger: true,\n            showTotal: (total) => `Tổng ${total} người dùng`,\n          }}\n        />\n\n        <Modal\n          title={\n            <Space>\n              <EditOutlined />\n              <span>Chỉnh sửa vai trò người dùng</span>\n            </Space>\n          }\n          open={editModalVisible}\n          onOk={handleSaveRole}\n          onCancel={() => {\n            setEditModalVisible(false);\n            setEditingUser(null);\n            setNewRole(null);\n          }}\n          confirmLoading={loading}\n        >\n          {editingUser && (\n            <div>\n              <p>\n                <strong>Email:</strong> {editingUser.email}\n              </p>\n              <p style={{ marginTop: \"16px\", marginBottom: \"8px\" }}>\n                <strong>Vai trò hiện tại:</strong>{\" \"}\n                <Tag color={ROLE_COLORS[editingUser.role]}>\n                  {ROLE_LABELS[editingUser.role]}\n                </Tag>\n              </p>\n              <p style={{ marginTop: \"16px\", marginBottom: \"8px\" }}>\n                <strong>Vai trò mới:</strong>\n              </p>\n              <Select\n                value={newRole}\n                onChange={setNewRole}\n                style={{ width: \"100%\" }}\n                placeholder=\"Chọn vai trò mới\"\n              >\n                {Object.keys(ROLE_LABELS).map((role) => (\n                  <Option key={role} value={role}>\n                    <Tag color={ROLE_COLORS[role]}>{ROLE_LABELS[role]}</Tag>\n                  </Option>\n                ))}\n              </Select>\n            </div>\n          )}\n        </Modal>\n      </Card>\n    </div>\n  );\n};\n\nexport default UserManagement;\n","import React, { useState, useEffect } from \"react\";\nimport {\n  Card,\n  Table,\n  Space,\n  Button,\n  Select,\n  DatePicker,\n  Input,\n  Tag,\n  Tooltip,\n  message,\n  Statistic,\n  Row,\n  Col,\n  Modal,\n  Descriptions,\n} from \"antd\";\nimport {\n  FileSearchOutlined,\n  ReloadOutlined,\n  ExportOutlined,\n  FilterOutlined,\n  EyeOutlined,\n  CalendarOutlined,\n} from \"@ant-design/icons\";\nimport dayjs from \"dayjs\";\nimport securityService from \"../../services/securityService\";\nimport { exportToCSV } from \"../../utils/exportUtils\";\nimport \"./Security.css\";\n\nconst { RangePicker } = DatePicker;\nconst { Option } = Select;\n\nconst EVENT_TYPES = {\n  \"login:success\": \"Đăng nhập thành công\",\n  \"login:failure\": \"Đăng nhập thất bại\",\n  logout: \"Đăng xuất\",\n  \"mfa:enabled\": \"Bật MFA\",\n  \"mfa:disabled\": \"Tắt MFA\",\n  \"mfa:verified\": \"Xác thực MFA\",\n  \"mfa:failed\": \"MFA thất bại\",\n  \"sso:login\": \"Đăng nhập SSO\",\n  \"password:changed\": \"Đổi mật khẩu\",\n  \"permission:denied\": \"Từ chối quyền\",\n  \"role:changed\": \"Thay đổi vai trò\",\n  \"access:granted\": \"Cấp quyền truy cập\",\n  \"access:revoked\": \"Thu hồi quyền\",\n  \"data:read\": \"Đọc dữ liệu\",\n  \"data:write\": \"Ghi dữ liệu\",\n  \"data:delete\": \"Xóa dữ liệu\",\n  \"data:export\": \"Xuất dữ liệu\",\n  \"user:created\": \"Tạo người dùng\",\n  \"user:updated\": \"Cập nhật người dùng\",\n  \"user:deleted\": \"Xóa người dùng\",\n  \"config:changed\": \"Thay đổi cấu hình\",\n  \"system:error\": \"Lỗi hệ thống\",\n  \"compliance:check\": \"Kiểm tra tuân thủ\",\n  \"data:backup\": \"Sao lưu dữ liệu\",\n  \"data:restore\": \"Khôi phục dữ liệu\",\n};\n\nconst SEVERITY_COLORS = {\n  low: \"default\",\n  medium: \"blue\",\n  high: \"orange\",\n  critical: \"red\",\n};\n\nconst STATUS_COLORS = {\n  success: \"green\",\n  failure: \"red\",\n  warning: \"orange\",\n  info: \"blue\",\n};\n\nconst AuditLogsViewer = () => {\n  const [logs, setLogs] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [statistics, setStatistics] = useState(null);\n  const [selectedLog, setSelectedLog] = useState(null);\n  const [detailModalVisible, setDetailModalVisible] = useState(false);\n\n  // Filters\n  const [filters, setFilters] = useState({\n    eventType: null,\n    severity: null,\n    status: null,\n    userEmail: \"\",\n    startDate: null,\n    endDate: null,\n    limit: 100,\n  });\n\n  useEffect(() => {\n    loadLogs();\n    loadStatistics();\n  }, []);\n\n  const loadLogs = async () => {\n    setLoading(true);\n    try {\n      const queryFilters = {\n        ...filters,\n        startDate: filters.startDate\n          ? filters.startDate.format(\"YYYY-MM-DD\")\n          : null,\n        endDate: filters.endDate ? filters.endDate.format(\"YYYY-MM-DD\") : null,\n      };\n\n      // Remove null/empty values\n      Object.keys(queryFilters).forEach((key) => {\n        if (\n          queryFilters[key] === null ||\n          queryFilters[key] === \"\" ||\n          queryFilters[key] === undefined\n        ) {\n          delete queryFilters[key];\n        }\n      });\n\n      const data = await securityService.queryAuditLogs(queryFilters);\n      setLogs(Array.isArray(data?.logs) ? data.logs : []);\n    } catch (error) {\n      console.error(\"Load audit logs error:\", error);\n      message.error(\"Không thể tải audit logs\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadStatistics = async () => {\n    try {\n      const stats = await securityService.getAuditStatistics({\n        startDate: filters.startDate\n          ? filters.startDate.format(\"YYYY-MM-DD\")\n          : null,\n        endDate: filters.endDate ? filters.endDate.format(\"YYYY-MM-DD\") : null,\n      });\n      setStatistics(stats);\n    } catch (error) {\n      console.error(\"Load statistics error:\", error);\n    }\n  };\n\n  const handleFilterChange = (key, value) => {\n    setFilters({ ...filters, [key]: value });\n  };\n\n  const handleApplyFilters = () => {\n    loadLogs();\n    loadStatistics();\n  };\n\n  const handleResetFilters = () => {\n    setFilters({\n      eventType: null,\n      severity: null,\n      status: null,\n      userEmail: \"\",\n      startDate: null,\n      endDate: null,\n      limit: 100,\n    });\n    setTimeout(() => {\n      loadLogs();\n      loadStatistics();\n    }, 100);\n  };\n\n  const handleExport = () => {\n    try {\n      const exportData = logs.map((log) => ({\n        \"Thời gian\": log.timestampFormatted || log.timestamp,\n        \"Loại sự kiện\": EVENT_TYPES[log.eventType] || log.eventType,\n        \"Mức độ\": log.severity,\n        \"Trạng thái\": log.status,\n        Email: log.userEmail || \"N/A\",\n        IP: log.ipAddress || \"N/A\",\n        \"Tài nguyên\": log.resource || \"N/A\",\n        \"Hành động\": log.action || \"N/A\",\n      }));\n\n      exportToCSV(exportData, \"audit-logs\");\n      message.success(\"Đã xuất audit logs ra CSV\");\n    } catch (error) {\n      message.error(\"Không thể xuất file\");\n    }\n  };\n\n  const handleViewDetails = (log) => {\n    setSelectedLog(log);\n    setDetailModalVisible(true);\n  };\n\n  const columns = [\n    {\n      title: \"Thời gian\",\n      dataIndex: \"timestampFormatted\",\n      key: \"timestamp\",\n      render: (text, record) => (\n        <Tooltip title={record.timestamp}>\n          <span>{text || record.timestamp}</span>\n        </Tooltip>\n      ),\n      sorter: (a, b) =>\n        new Date(a.timestamp).getTime() - new Date(b.timestamp).getTime(),\n      width: 180,\n    },\n    {\n      title: \"Loại sự kiện\",\n      dataIndex: \"eventType\",\n      key: \"eventType\",\n      render: (eventType) => <Tag>{EVENT_TYPES[eventType] || eventType}</Tag>,\n      filters: Object.keys(EVENT_TYPES).map((type) => ({\n        text: EVENT_TYPES[type],\n        value: type,\n      })),\n      onFilter: (value, record) => record.eventType === value,\n      width: 200,\n    },\n    {\n      title: \"Mức độ\",\n      dataIndex: \"severity\",\n      key: \"severity\",\n      render: (severity) => (\n        <Tag color={SEVERITY_COLORS[severity] || \"default\"}>\n          {severity?.toUpperCase()}\n        </Tag>\n      ),\n      filters: Object.keys(SEVERITY_COLORS).map((sev) => ({\n        text: sev.toUpperCase(),\n        value: sev,\n      })),\n      onFilter: (value, record) => record.severity === value,\n      width: 100,\n    },\n    {\n      title: \"Trạng thái\",\n      dataIndex: \"status\",\n      key: \"status\",\n      render: (status) => (\n        <Tag color={STATUS_COLORS[status] || \"default\"}>\n          {status?.toUpperCase()}\n        </Tag>\n      ),\n      filters: Object.keys(STATUS_COLORS).map((stat) => ({\n        text: stat.toUpperCase(),\n        value: stat,\n      })),\n      onFilter: (value, record) => record.status === value,\n      width: 100,\n    },\n    {\n      title: \"Người dùng\",\n      dataIndex: \"userEmail\",\n      key: \"userEmail\",\n      render: (email) => email || \"N/A\",\n      width: 200,\n    },\n    {\n      title: \"IP Address\",\n      dataIndex: \"ipAddress\",\n      key: \"ipAddress\",\n      render: (ip) => ip || \"N/A\",\n      width: 150,\n    },\n    {\n      title: \"Hành động\",\n      key: \"action\",\n      render: (_, record) => (\n        <Button\n          type=\"link\"\n          icon={<EyeOutlined />}\n          onClick={() => handleViewDetails(record)}\n        >\n          Chi tiết\n        </Button>\n      ),\n      width: 100,\n    },\n  ];\n\n  return (\n    <div className=\"security-container\">\n      <Card\n        title={\n          <Space>\n            <FileSearchOutlined />\n            <span>Audit Logs Viewer</span>\n          </Space>\n        }\n        className=\"security-card\"\n      >\n        {/* Statistics */}\n        {statistics && (\n          <Row gutter={16} style={{ marginBottom: \"24px\" }}>\n            <Col span={6}>\n              <Statistic\n                title=\"Tổng sự kiện\"\n                value={statistics.totalEvents || 0}\n              />\n            </Col>\n            <Col span={6}>\n              <Statistic\n                title=\"Sự kiện thành công\"\n                value={statistics.successCount || 0}\n                valueStyle={{ color: \"#3f8600\" }}\n              />\n            </Col>\n            <Col span={6}>\n              <Statistic\n                title=\"Sự kiện thất bại\"\n                value={statistics.failureCount || 0}\n                valueStyle={{ color: \"#cf1322\" }}\n              />\n            </Col>\n            <Col span={6}>\n              <Statistic\n                title=\"Sự kiện quan trọng\"\n                value={statistics.criticalCount || 0}\n                valueStyle={{ color: \"#ff4d4f\" }}\n              />\n            </Col>\n          </Row>\n        )}\n\n        {/* Filters */}\n        <Card\n          title={\n            <Space>\n              <FilterOutlined />\n              <span>Bộ lọc</span>\n            </Space>\n          }\n          style={{ marginBottom: \"24px\" }}\n        >\n          <Space wrap style={{ width: \"100%\" }}>\n            <Select\n              placeholder=\"Loại sự kiện\"\n              style={{ width: 200 }}\n              allowClear\n              value={filters.eventType}\n              onChange={(value) => handleFilterChange(\"eventType\", value)}\n            >\n              {Object.entries(EVENT_TYPES).map(([key, label]) => (\n                <Option key={key} value={key}>\n                  {label}\n                </Option>\n              ))}\n            </Select>\n\n            <Select\n              placeholder=\"Mức độ\"\n              style={{ width: 150 }}\n              allowClear\n              value={filters.severity}\n              onChange={(value) => handleFilterChange(\"severity\", value)}\n            >\n              {Object.keys(SEVERITY_COLORS).map((sev) => (\n                <Option key={sev} value={sev}>\n                  {sev.toUpperCase()}\n                </Option>\n              ))}\n            </Select>\n\n            <Select\n              placeholder=\"Trạng thái\"\n              style={{ width: 150 }}\n              allowClear\n              value={filters.status}\n              onChange={(value) => handleFilterChange(\"status\", value)}\n            >\n              {Object.keys(STATUS_COLORS).map((stat) => (\n                <Option key={stat} value={stat}>\n                  {stat.toUpperCase()}\n                </Option>\n              ))}\n            </Select>\n\n            <Input\n              placeholder=\"Email người dùng\"\n              style={{ width: 200 }}\n              value={filters.userEmail}\n              onChange={(e) => handleFilterChange(\"userEmail\", e.target.value)}\n              allowClear\n            />\n\n            <RangePicker\n              placeholder={[\"Ngày bắt đầu\", \"Ngày kết thúc\"]}\n              value={[filters.startDate, filters.endDate]}\n              onChange={(dates) => {\n                handleFilterChange(\"startDate\", dates?.[0] || null);\n                handleFilterChange(\"endDate\", dates?.[1] || null);\n              }}\n            />\n\n            <Button\n              type=\"primary\"\n              icon={<FilterOutlined />}\n              onClick={handleApplyFilters}\n            >\n              Áp dụng\n            </Button>\n\n            <Button icon={<ReloadOutlined />} onClick={handleResetFilters}>\n              Đặt lại\n            </Button>\n          </Space>\n        </Card>\n\n        {/* Actions */}\n        <Space style={{ marginBottom: \"16px\" }}>\n          <Button\n            icon={<ReloadOutlined />}\n            onClick={() => {\n              loadLogs();\n              loadStatistics();\n            }}\n            loading={loading}\n          >\n            Làm mới\n          </Button>\n          <Button\n            icon={<ExportOutlined />}\n            onClick={handleExport}\n            disabled={logs.length === 0}\n          >\n            Xuất CSV\n          </Button>\n        </Space>\n\n        {/* Table */}\n        <Table\n          columns={columns}\n          dataSource={logs}\n          rowKey=\"id\"\n          loading={loading}\n          pagination={{\n            pageSize: 20,\n            showSizeChanger: true,\n            showTotal: (total) => `Tổng ${total} logs`,\n          }}\n        />\n\n        {/* Detail Modal */}\n        <Modal\n          title=\"Chi tiết Audit Log\"\n          open={detailModalVisible}\n          onCancel={() => setDetailModalVisible(false)}\n          footer={null}\n          width={800}\n        >\n          {selectedLog && (\n            <Descriptions bordered column={2}>\n              <Descriptions.Item label=\"ID\" span={2}>\n                {selectedLog.id}\n              </Descriptions.Item>\n              <Descriptions.Item label=\"Thời gian\">\n                {selectedLog.timestampFormatted || selectedLog.timestamp}\n              </Descriptions.Item>\n              <Descriptions.Item label=\"Loại sự kiện\">\n                <Tag>\n                  {EVENT_TYPES[selectedLog.eventType] || selectedLog.eventType}\n                </Tag>\n              </Descriptions.Item>\n              <Descriptions.Item label=\"Mức độ\">\n                <Tag color={SEVERITY_COLORS[selectedLog.severity]}>\n                  {selectedLog.severity?.toUpperCase()}\n                </Tag>\n              </Descriptions.Item>\n              <Descriptions.Item label=\"Trạng thái\">\n                <Tag color={STATUS_COLORS[selectedLog.status]}>\n                  {selectedLog.status?.toUpperCase()}\n                </Tag>\n              </Descriptions.Item>\n              <Descriptions.Item label=\"Email người dùng\">\n                {selectedLog.userEmail || \"N/A\"}\n              </Descriptions.Item>\n              <Descriptions.Item label=\"User ID\">\n                {selectedLog.userId || \"N/A\"}\n              </Descriptions.Item>\n              <Descriptions.Item label=\"IP Address\">\n                {selectedLog.ipAddress || \"N/A\"}\n              </Descriptions.Item>\n              <Descriptions.Item label=\"User Agent\" span={2}>\n                {selectedLog.userAgent || \"N/A\"}\n              </Descriptions.Item>\n              <Descriptions.Item label=\"Tài nguyên\">\n                {selectedLog.resource || \"N/A\"}\n              </Descriptions.Item>\n              <Descriptions.Item label=\"Hành động\">\n                {selectedLog.action || \"N/A\"}\n              </Descriptions.Item>\n              <Descriptions.Item label=\"Chi tiết\" span={2}>\n                <pre style={{ maxHeight: \"200px\", overflow: \"auto\" }}>\n                  {JSON.stringify(selectedLog.details || {}, null, 2)}\n                </pre>\n              </Descriptions.Item>\n              <Descriptions.Item label=\"Metadata\" span={2}>\n                <pre style={{ maxHeight: \"200px\", overflow: \"auto\" }}>\n                  {JSON.stringify(selectedLog.metadata || {}, null, 2)}\n                </pre>\n              </Descriptions.Item>\n            </Descriptions>\n          )}\n        </Modal>\n      </Card>\n    </div>\n  );\n};\n\nexport default AuditLogsViewer;\n","import React, { useState, useEffect } from \"react\";\nimport {\n  Card,\n  Space,\n  Button,\n  Input,\n  Switch,\n  Form,\n  message,\n  Alert,\n  Divider,\n  Tag,\n  Descriptions,\n  Spin,\n  InputNumber,\n} from \"antd\";\nimport {\n  SettingOutlined,\n  LockOutlined,\n  SaveOutlined,\n  ReloadOutlined,\n  KeyOutlined,\n  SafetyOutlined,\n} from \"@ant-design/icons\";\nimport securityService from \"../../services/securityService\";\nimport \"./Security.css\";\n\nconst SecuritySettings = () => {\n  const [loading, setLoading] = useState(false);\n  const [userProfile, setUserProfile] = useState(null);\n  const [form] = Form.useForm();\n\n  useEffect(() => {\n    loadUserProfile();\n  }, []);\n\n  const loadUserProfile = async () => {\n    setLoading(true);\n    try {\n      const profile = await securityService.getCurrentUser();\n      const user = profile?.user || profile;\n      setUserProfile(user);\n\n      // Set form values\n      form.setFieldsValue({\n        sessionTimeout: 30, // minutes (default)\n        passwordMinLength: 8,\n        requireMFA: user?.mfaEnabled || false,\n        enableAuditLogging: true,\n      });\n    } catch (error) {\n      console.error(\"Load user profile error:\", error);\n      message.error(\"Không thể tải thông tin người dùng\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSaveSettings = async (values) => {\n    setLoading(true);\n    try {\n      // In a real app, you would call an API to save settings\n      // For now, we'll just show a success message\n      console.log(\"Settings to save:\", values);\n\n      message.success(\"Đã lưu cài đặt bảo mật\");\n    } catch (error) {\n      console.error(\"Save settings error:\", error);\n      message.error(\"Không thể lưu cài đặt\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (loading && !userProfile) {\n    return (\n      <div style={{ textAlign: \"center\", padding: \"40px\" }}>\n        <Spin size=\"large\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"security-container\">\n      <Card\n        title={\n          <Space>\n            <SettingOutlined />\n            <span>Cài đặt bảo mật</span>\n          </Space>\n        }\n        className=\"security-card\"\n      >\n        <Form\n          form={form}\n          layout=\"vertical\"\n          onFinish={handleSaveSettings}\n          initialValues={{\n            sessionTimeout: 30,\n            passwordMinLength: 8,\n            requireMFA: userProfile?.mfaEnabled || false,\n            enableAuditLogging: true,\n          }}\n        >\n          {/* Current Security Status */}\n          <Card\n            type=\"inner\"\n            title={\n              <Space>\n                <SafetyOutlined />\n                <span>Trạng thái bảo mật hiện tại</span>\n              </Space>\n            }\n            style={{ marginBottom: \"24px\" }}\n          >\n            <Descriptions bordered column={2}>\n              <Descriptions.Item label=\"MFA\">\n                <Tag color={userProfile?.mfaEnabled ? \"green\" : \"default\"}>\n                  {userProfile?.mfaEnabled ? \"Đã bật\" : \"Chưa bật\"}\n                </Tag>\n              </Descriptions.Item>\n              <Descriptions.Item label=\"Vai trò\">\n                <Tag>{userProfile?.role || \"N/A\"}</Tag>\n              </Descriptions.Item>\n              <Descriptions.Item label=\"Quyền\" span={2}>\n                {userProfile?.permissions &&\n                Array.isArray(userProfile.permissions) ? (\n                  <Space wrap>\n                    {userProfile.permissions.map((perm) => (\n                      <Tag key={perm} color=\"blue\">\n                        {perm}\n                      </Tag>\n                    ))}\n                  </Space>\n                ) : (\n                  \"N/A\"\n                )}\n              </Descriptions.Item>\n            </Descriptions>\n          </Card>\n\n          {/* Password Policy */}\n          <Card\n            type=\"inner\"\n            title={\n              <Space>\n                <LockOutlined />\n                <span>Chính sách mật khẩu</span>\n              </Space>\n            }\n            style={{ marginBottom: \"24px\" }}\n          >\n            <Form.Item\n              name=\"passwordMinLength\"\n              label=\"Độ dài mật khẩu tối thiểu\"\n              tooltip=\"Số ký tự tối thiểu cho mật khẩu\"\n            >\n              <Space.Compact style={{ width: \"100%\" }}>\n                <InputNumber min={6} max={32} style={{ width: \"100%\" }} />\n                <Button disabled style={{ minWidth: \"80px\" }}>\n                  ký tự\n                </Button>\n              </Space.Compact>\n            </Form.Item>\n\n            <Alert\n              message=\"Khuyến nghị\"\n              description=\"Sử dụng mật khẩu có ít nhất 12 ký tự, bao gồm chữ hoa, chữ thường, số và ký tự đặc biệt.\"\n              type=\"info\"\n              showIcon\n              style={{ marginTop: \"16px\" }}\n            />\n          </Card>\n\n          {/* Session Settings */}\n          <Card\n            type=\"inner\"\n            title=\"Cài đặt phiên đăng nhập\"\n            style={{ marginBottom: \"24px\" }}\n          >\n            <Form.Item\n              name=\"sessionTimeout\"\n              label=\"Thời gian hết hạn phiên\"\n              tooltip=\"Số phút trước khi phiên đăng nhập tự động hết hạn\"\n            >\n              <Space.Compact style={{ width: \"100%\" }}>\n                <InputNumber min={5} max={1440} style={{ width: \"100%\" }} />\n                <Button disabled style={{ minWidth: \"80px\" }}>\n                  phút\n                </Button>\n              </Space.Compact>\n            </Form.Item>\n\n            <Alert\n              message=\"Bảo mật\"\n              description=\"Phiên đăng nhập sẽ tự động hết hạn sau thời gian không hoạt động.\"\n              type=\"warning\"\n              showIcon\n              style={{ marginTop: \"16px\" }}\n            />\n          </Card>\n\n          {/* Multi-Factor Authentication */}\n          <Card\n            type=\"inner\"\n            title={\n              <Space>\n                <SafetyOutlined />\n                <span>Xác thực hai lớp (MFA)</span>\n              </Space>\n            }\n            style={{ marginBottom: \"24px\" }}\n          >\n            <Form.Item\n              name=\"requireMFA\"\n              label=\"Yêu cầu MFA\"\n              valuePropName=\"checked\"\n              tooltip=\"Bật yêu cầu MFA cho tất cả đăng nhập\"\n            >\n              <Switch />\n            </Form.Item>\n\n            <Alert\n              message={\n                userProfile?.mfaEnabled\n                  ? \"MFA đã được kích hoạt\"\n                  : \"MFA chưa được kích hoạt\"\n              }\n              description={\n                userProfile?.mfaEnabled\n                  ? \"Tài khoản của bạn đã được bảo vệ bằng MFA.\"\n                  : \"Vui lòng kích hoạt MFA để tăng cường bảo mật cho tài khoản.\"\n              }\n              type={userProfile?.mfaEnabled ? \"success\" : \"warning\"}\n              showIcon\n              style={{ marginTop: \"16px\" }}\n              action={\n                !userProfile?.mfaEnabled && (\n                  <Button type=\"link\" href=\"/security/mfa\" size=\"small\">\n                    Kích hoạt ngay\n                  </Button>\n                )\n              }\n            />\n          </Card>\n\n          {/* Audit Logging */}\n          <Card\n            type=\"inner\"\n            title=\"Ghi nhật ký Audit\"\n            style={{ marginBottom: \"24px\" }}\n          >\n            <Form.Item\n              name=\"enableAuditLogging\"\n              label=\"Bật ghi nhật ký Audit\"\n              valuePropName=\"checked\"\n              tooltip=\"Ghi lại tất cả các hoạt động quan trọng để tuân thủ và bảo mật\"\n            >\n              <Switch disabled />\n            </Form.Item>\n\n            <Alert\n              message=\"Luôn bật\"\n              description=\"Audit logging luôn được bật để đảm bảo tuân thủ và bảo mật.\"\n              type=\"info\"\n              showIcon\n              style={{ marginTop: \"16px\" }}\n            />\n          </Card>\n\n          {/* Encryption Keys Info */}\n          <Card\n            type=\"inner\"\n            title={\n              <Space>\n                <KeyOutlined />\n                <span>Thông tin mã hóa</span>\n              </Space>\n            }\n            style={{ marginBottom: \"24px\" }}\n          >\n            <Alert\n              message=\"Mã hóa dữ liệu\"\n              description={\n                <div>\n                  <p>\n                    <strong>Mã hóa khi lưu trữ:</strong> AES-256-GCM\n                  </p>\n                  <p>\n                    <strong>Mã hóa khi truyền:</strong> RSA\n                  </p>\n                  <p style={{ marginBottom: 0, color: \"#666\" }}>\n                    Tất cả dữ liệu nhạy cảm đều được mã hóa tự động.\n                  </p>\n                </div>\n              }\n              type=\"success\"\n              showIcon\n            />\n          </Card>\n\n          <Divider />\n\n          {/* Save Button */}\n          <Form.Item>\n            <Space>\n              <Button\n                type=\"primary\"\n                htmlType=\"submit\"\n                icon={<SaveOutlined />}\n                loading={loading}\n                size=\"large\"\n              >\n                Lưu cài đặt\n              </Button>\n              <Button\n                icon={<ReloadOutlined />}\n                onClick={loadUserProfile}\n                loading={loading}\n              >\n                Làm mới\n              </Button>\n            </Space>\n          </Form.Item>\n        </Form>\n      </Card>\n    </div>\n  );\n};\n\nexport default SecuritySettings;\n","import React, { useState } from \"react\";\nimport { Tabs, Card, Space } from \"antd\";\nimport {\n  SafetyOutlined,\n  UserOutlined,\n  FileSearchOutlined,\n  SettingOutlined,\n  LoginOutlined,\n  LockOutlined,\n} from \"@ant-design/icons\";\nimport MFASetup from \"./MFASetup\";\nimport SSOLogin from \"./SSOLogin\";\nimport UserManagement from \"./UserManagement\";\nimport AuditLogsViewer from \"./AuditLogsViewer\";\nimport SecuritySettings from \"./SecuritySettings\";\nimport \"./Security.css\";\n\nconst SecurityDashboard = () => {\n  const [activeTab, setActiveTab] = useState(\"mfa\");\n\n  const tabItems = [\n    {\n      key: \"mfa\",\n      label: (\n        <Space>\n          <SafetyOutlined />\n          <span>MFA Setup</span>\n        </Space>\n      ),\n      children: <MFASetup />,\n    },\n    {\n      key: \"sso\",\n      label: (\n        <Space>\n          <LoginOutlined />\n          <span>SSO Login</span>\n        </Space>\n      ),\n      children: <SSOLogin />,\n    },\n    {\n      key: \"users\",\n      label: (\n        <Space>\n          <UserOutlined />\n          <span>Quản lý người dùng</span>\n        </Space>\n      ),\n      children: <UserManagement />,\n    },\n    {\n      key: \"audit\",\n      label: (\n        <Space>\n          <FileSearchOutlined />\n          <span>Audit Logs</span>\n        </Space>\n      ),\n      children: <AuditLogsViewer />,\n    },\n    {\n      key: \"settings\",\n      label: (\n        <Space>\n          <SettingOutlined />\n          <span>Cài đặt</span>\n        </Space>\n      ),\n      children: <SecuritySettings />,\n    },\n  ];\n\n  return (\n    <div className=\"security-dashboard\">\n      <Card\n        title={\n          <Space>\n            <LockOutlined />\n            <span>Enterprise Security Dashboard</span>\n          </Space>\n        }\n        className=\"security-dashboard-card\"\n      >\n        <Tabs\n          activeKey={activeTab}\n          onChange={setActiveTab}\n          type=\"card\"\n          size=\"large\"\n          items={tabItems}\n        />\n      </Card>\n    </div>\n  );\n};\n\nexport default SecurityDashboard;\n","/* eslint-disable */\n/**\n * Export Utilities\n * Export analytics data to PDF, Excel, CSV\n */\n\n// Export to PDF (using html2pdf.js or similar)\nexport const exportToPDF = async (data, filename = \"export\") => {\n  try {\n    // For now, we'll use a simple approach with window.print\n    // In production, you might want to use jsPDF or html2pdf.js\n\n    const printWindow = window.open(\"\", \"_blank\");\n    const htmlContent = `\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <title>${filename}</title>\n          <style>\n            body { font-family: Arial, sans-serif; padding: 20px; }\n            table { width: 100%; border-collapse: collapse; margin-top: 20px; }\n            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }\n            th { background-color: #f2f2f2; }\n            h1 { color: #333; }\n            @media print {\n              body { padding: 0; }\n              button { display: none; }\n            }\n          </style>\n        </head>\n        <body>\n          <h1>${filename}</h1>\n          <p>Generated: ${new Date().toLocaleString(\"vi-VN\")}</p>\n          <h2>Widgets (${data.widgets.length})</h2>\n          <table>\n            <thead>\n              <tr>\n                <th>ID</th>\n                <th>Title</th>\n                <th>Type</th>\n                <th>Data Points</th>\n              </tr>\n            </thead>\n            <tbody>\n              ${data.widgets\n                .map(\n                  (widget) => `\n                <tr>\n                  <td>${widget.id}</td>\n                  <td>${widget.title}</td>\n                  <td>${widget.type}</td>\n                  <td>${widget.data?.length || 0}</td>\n                </tr>\n              `,\n                )\n                .join(\"\")}\n            </tbody>\n          </table>\n          <button onclick=\"window.print()\">Print / Save as PDF</button>\n        </body>\n      </html>\n    `;\n\n    printWindow.document.write(htmlContent);\n    printWindow.document.close();\n\n    // Auto print after a short delay\n    setTimeout(() => {\n      printWindow.print();\n    }, 250);\n\n    return true;\n  } catch (error) {\n    console.error(\"PDF export error:\", error);\n    throw new Error(\"Failed to export to PDF\");\n  }\n};\n\n// Export to Excel (using SheetJS or similar)\nexport const exportToExcel = async (data, filename = \"export\") => {\n  try {\n    // Simple CSV approach for now\n    // In production, use xlsx library for proper Excel format\n\n    let csvContent = \"ID,Title,Type,Data Points\\n\";\n    data.widgets.forEach((widget) => {\n      csvContent += `${widget.id},\"${widget.title}\",${widget.type},${widget.data?.length || 0}\\n`;\n    });\n\n    // Convert to Excel-like format\n    const blob = new Blob([\"\\ufeff\" + csvContent], {\n      type: \"text/csv;charset=utf-8;\",\n    });\n    const link = document.createElement(\"a\");\n    const url = URL.createObjectURL(blob);\n\n    link.setAttribute(\"href\", url);\n    link.setAttribute(\"download\", `${filename}.csv`);\n    link.style.visibility = \"hidden\";\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n\n    return true;\n  } catch (error) {\n    console.error(\"Excel export error:\", error);\n    throw new Error(\"Failed to export to Excel\");\n  }\n};\n\n// Export to CSV\nexport const exportToCSV = async (data, filename = \"export\") => {\n  try {\n    let csvContent = \"\";\n\n    // Header\n    csvContent += \"Dashboard Export\\n\";\n    csvContent += `Generated: ${new Date().toLocaleString(\"vi-VN\")}\\n`;\n    csvContent += \"\\n\";\n\n    // Widgets summary\n    csvContent += \"Widgets\\n\";\n    csvContent += \"ID,Title,Type,Data Points\\n\";\n    data.widgets.forEach((widget) => {\n      csvContent += `${widget.id},\"${widget.title}\",${widget.type},${widget.data?.length || 0}\\n`;\n    });\n\n    csvContent += \"\\n\";\n\n    // Widget data\n    data.widgets.forEach((widget, index) => {\n      csvContent += `\\nWidget ${index + 1}: ${widget.title} (${widget.type})\\n`;\n      if (widget.data && widget.data.length > 0) {\n        const headers = Object.keys(widget.data[0]).join(\",\");\n        csvContent += `${headers}\\n`;\n        widget.data.forEach((row) => {\n          const values = Object.values(row)\n            .map((val) => (typeof val === \"string\" ? `\"${val}\"` : val))\n            .join(\",\");\n          csvContent += `${values}\\n`;\n        });\n      }\n    });\n\n    const blob = new Blob([\"\\ufeff\" + csvContent], {\n      type: \"text/csv;charset=utf-8;\",\n    });\n    const link = document.createElement(\"a\");\n    const url = URL.createObjectURL(blob);\n\n    link.setAttribute(\"href\", url);\n    link.setAttribute(\"download\", `${filename}.csv`);\n    link.style.visibility = \"hidden\";\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n\n    return true;\n  } catch (error) {\n    console.error(\"CSV export error:\", error);\n    throw new Error(\"Failed to export to CSV\");\n  }\n};\n"],"names":["Step","Steps","MFASetup","current","setCurrent","useState","loading","setLoading","mfaEnabled","setMfaEnabled","mfaSecret","setMfaSecret","verificationToken","setVerificationToken","userProfile","setUserProfile","useEffect","loadUserProfile","async","_profile$user","profile","securityService","user","error","console","otpAuthUrl","concat","email","secret","_jsx","style","textAlign","padding","children","Spin","size","className","_jsxs","Card","title","Space","SafetyOutlined","Alert","message","description","type","icon","CheckCircleOutlined","showIcon","action","Button","danger","onClick","success","CloseCircleOutlined","marginBottom","onChange","Divider","LockOutlined","fontSize","color","marginTop","maxWidth","margin","secretData","QRCode","value","fontWeight","Input","manualEntryKey","readOnly","fontFamily","letterSpacing","placeholder","e","target","maxLength","width","justifyContent","handleReset","ReloadOutlined","warning","disabled","length","SSOLogin","providers","setProviders","id","name","GoogleOutlined","GithubOutlined","WindowsOutlined","window","location","urlParams","URLSearchParams","search","code","get","state","provider","split","handleSSOCallback","userData","token","setTimeout","href","history","replaceState","document","pathname","LoginOutlined","direction","map","authData","authUrl","handleSSOLogin","height","backgroundColor","borderColor","display","alignItems","gap","Option","Select","ROLE_COLORS","admin","manager","guest","ROLE_LABELS","UserManagement","users","setUsers","searchText","setSearchText","editingUser","setEditingUser","editModalVisible","setEditModalVisible","newRole","setNewRole","loadUsers","data","Array","isArray","filteredUsers","filter","_user$email","_user$role","_user$id","searchLower","toLowerCase","includes","role","toString","columns","dataIndex","key","render","text","record","UserOutlined","Tooltip","Badge","status","sorter","a","b","localeCompare","Tag","filters","Object","keys","onFilter","enabled","permissions","wrap","slice","perm","_","EditOutlined","handleEditRole","Popconfirm","onConfirm","userId","handleDeleteUser","okText","cancelText","okButtonProps","DeleteOutlined","extra","prefix","SearchOutlined","allowClear","Table","dataSource","rowKey","pagination","pageSize","showSizeChanger","showTotal","total","Modal","open","onOk","onCancel","confirmLoading","RangePicker","DatePicker","EVENT_TYPES","logout","SEVERITY_COLORS","low","medium","high","critical","STATUS_COLORS","failure","info","AuditLogsViewer","_selectedLog$severity","_selectedLog$status","logs","setLogs","statistics","setStatistics","selectedLog","setSelectedLog","detailModalVisible","setDetailModalVisible","setFilters","eventType","severity","userEmail","startDate","endDate","limit","loadLogs","loadStatistics","queryFilters","_objectSpread","format","forEach","undefined","stats","handleFilterChange","timestamp","Date","getTime","toUpperCase","sev","stat","ip","EyeOutlined","FileSearchOutlined","Row","gutter","Col","span","Statistic","totalEvents","successCount","valueStyle","failureCount","criticalCount","FilterOutlined","entries","_ref","label","dates","handleApplyFilters","handleResetFilters","ExportOutlined","handleExport","exportData","log","timestampFormatted","Email","IP","ipAddress","resource","exportToCSV","footer","Descriptions","bordered","column","Item","userAgent","maxHeight","overflow","JSON","stringify","details","metadata","SecuritySettings","form","Form","useForm","setFieldsValue","sessionTimeout","passwordMinLength","requireMFA","enableAuditLogging","SettingOutlined","layout","onFinish","values","initialValues","tooltip","Compact","InputNumber","min","max","minWidth","valuePropName","Switch","KeyOutlined","htmlType","SaveOutlined","SecurityDashboard","activeTab","setActiveTab","tabItems","Tabs","activeKey","items","exportToPDF","filename","arguments","printWindow","htmlContent","toLocaleString","widgets","widget","_widget$data","join","write","close","print","Error","exportToExcel","csvContent","_widget$data2","blob","Blob","link","createElement","url","URL","createObjectURL","setAttribute","visibility","body","appendChild","click","removeChild","_widget$data3","index","headers","row","val"],"ignoreList":[],"sourceRoot":""}