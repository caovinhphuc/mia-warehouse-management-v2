"use strict";(self.webpackChunkreact_google_sheets_project=self.webpackChunkreact_google_sheets_project||[]).push([[766],{60497:(e,t,a)=>{a.d(t,{GF:()=>l,Q7:()=>r,bJ:()=>n});const r=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"export";try{const a=window.open("","_blank"),r="\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <title>".concat(t,"</title>\n          <style>\n            body { font-family: Arial, sans-serif; padding: 20px; }\n            table { width: 100%; border-collapse: collapse; margin-top: 20px; }\n            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }\n            th { background-color: #f2f2f2; }\n            h1 { color: #333; }\n            @media print {\n              body { padding: 0; }\n              button { display: none; }\n            }\n          </style>\n        </head>\n        <body>\n          <h1>").concat(t,"</h1>\n          <p>Generated: ").concat((new Date).toLocaleString("vi-VN"),"</p>\n          <h2>Widgets (").concat(e.widgets.length,")</h2>\n          <table>\n            <thead>\n              <tr>\n                <th>ID</th>\n                <th>Title</th>\n                <th>Type</th>\n                <th>Data Points</th>\n              </tr>\n            </thead>\n            <tbody>\n              ").concat(e.widgets.map(e=>{var t;return"\n                <tr>\n                  <td>".concat(e.id,"</td>\n                  <td>").concat(e.title,"</td>\n                  <td>").concat(e.type,"</td>\n                  <td>").concat((null===(t=e.data)||void 0===t?void 0:t.length)||0,"</td>\n                </tr>\n              ")}).join(""),'\n            </tbody>\n          </table>\n          <button onclick="window.print()">Print / Save as PDF</button>\n        </body>\n      </html>\n    ');return a.document.write(r),a.document.close(),setTimeout(()=>{a.print()},250),!0}catch(a){throw console.error("PDF export error:",a),new Error("Failed to export to PDF")}},n=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"export";try{let a="ID,Title,Type,Data Points\n";e.widgets.forEach(e=>{var t;a+="".concat(e.id,',"').concat(e.title,'",').concat(e.type,",").concat((null===(t=e.data)||void 0===t?void 0:t.length)||0,"\n")});const r=new Blob(["\ufeff"+a],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a"),l=URL.createObjectURL(r);return n.setAttribute("href",l),n.setAttribute("download","".concat(t,".csv")),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n),!0}catch(a){throw console.error("Excel export error:",a),new Error("Failed to export to Excel")}},l=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"export";try{let a="";a+="Dashboard Export\n",a+="Generated: ".concat((new Date).toLocaleString("vi-VN"),"\n"),a+="\n",a+="Widgets\n",a+="ID,Title,Type,Data Points\n",e.widgets.forEach(e=>{var t;a+="".concat(e.id,',"').concat(e.title,'",').concat(e.type,",").concat((null===(t=e.data)||void 0===t?void 0:t.length)||0,"\n")}),a+="\n",e.widgets.forEach((e,t)=>{if(a+="\nWidget ".concat(t+1,": ").concat(e.title," (").concat(e.type,")\n"),e.data&&e.data.length>0){const t=Object.keys(e.data[0]).join(",");a+="".concat(t,"\n"),e.data.forEach(e=>{const t=Object.values(e).map(e=>"string"===typeof e?'"'.concat(e,'"'):e).join(",");a+="".concat(t,"\n")})}});const r=new Blob(["\ufeff"+a],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a"),l=URL.createObjectURL(r);return n.setAttribute("href",l),n.setAttribute("download","".concat(t,".csv")),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n),!0}catch(a){throw console.error("CSV export error:",a),new Error("Failed to export to CSV")}}},83025:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ce});var r=a(89379),n=a(65043),l=a(52169),s=a(59834),i=a(62215),o=a(53151),c=a(76552),d=a(85289),h=a(68508),x=a(35799),y=a(93509),u=a(84211),p=a(27986),j=a(88971),g=a(27340),m=a(6319),A=a(52069),v=a(93292),f=a(9690),b=a(91917),w=a(50809),C=a(85521),k=a(97042),D=a(28791),K=a(41180),T=a(75748),M=a(87734),E=a(52185),S=a(6026),F=a(80379),P=a(70095),R=a(10023),W=a(82291),L=a(16992),O=a(56102),z=a(17869),N=a(35963),I=a(877),V=a(70579);const{Title:_,Text:G}=o.A,{Option:U}=f.A,Y=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899","#06b6d4","#84cc16"],B=e=>{let{data:t,dataKey:a,title:r,height:l=300,showLegend:s=!0,strokeColors:i=Y}=e;const o=(0,n.useMemo)(()=>t&&Array.isArray(t)?Array.isArray(a)?a.map((e,t)=>(0,V.jsx)(D.N1,{type:"monotone",dataKey:e,stroke:i[t%i.length],strokeWidth:2,dot:{r:4},activeDot:{r:6}},e)):(0,V.jsx)(D.N1,{type:"monotone",dataKey:a,stroke:i[0],strokeWidth:2,dot:{r:4},activeDot:{r:6}}):[],[t,a,i]);return(0,V.jsxs)(x.A,{children:[r&&(0,V.jsx)(_,{level:5,children:r}),(0,V.jsx)(K.u,{width:"100%",height:l,children:(0,V.jsxs)(T.b,{data:t,margin:{top:5,right:30,left:20,bottom:5},children:[(0,V.jsx)(M.d,{strokeDasharray:"3 3"}),(0,V.jsx)(E.W,{dataKey:"name"}),(0,V.jsx)(S.h,{}),(0,V.jsx)(F.m,{}),s&&(0,V.jsx)(P.s,{}),o]})})]})},Q=e=>{let{data:t,dataKey:a,title:r,height:l=300,showLegend:s=!0,colors:i=Y,orientation:o="vertical"}=e;const c=(0,n.useMemo)(()=>t&&Array.isArray(t)?Array.isArray(a)?a.map((e,t)=>(0,V.jsx)(R.yP,{dataKey:e,fill:i[t%i.length]},e)):(0,V.jsx)(R.yP,{dataKey:a,fill:i[0]}):[],[t,a,i]);W.E;return(0,V.jsxs)(x.A,{children:[r&&(0,V.jsx)(_,{level:5,children:r}),(0,V.jsx)(K.u,{width:"100%",height:l,children:(0,V.jsxs)(W.E,{data:t,layout:"horizontal"===o?"vertical":"horizontal",margin:{top:5,right:30,left:20,bottom:5},children:[(0,V.jsx)(M.d,{strokeDasharray:"3 3"}),(0,V.jsx)(E.W,{type:"horizontal"===o?"number":"category",dataKey:"horizontal"===o?a:"name"}),(0,V.jsx)(S.h,{type:"horizontal"===o?"category":"number",dataKey:"horizontal"===o?"name":a}),(0,V.jsx)(F.m,{}),s&&(0,V.jsx)(P.s,{}),c]})})]})},q=e=>{let{data:t,dataKey:a="value",nameKey:r="name",title:n,height:l=300,showLegend:s=!0,colors:i=Y}=e;return(0,V.jsxs)(x.A,{children:[n&&(0,V.jsx)(_,{level:5,children:n}),(0,V.jsx)(K.u,{width:"100%",height:l,children:(0,V.jsxs)(L.r,{children:[(0,V.jsx)(O.Fq,{data:t,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{cx:t,cy:a,midAngle:r,innerRadius:n,outerRadius:l,percent:s}=e;const i=Math.PI/180,o=n+.5*(l-n),c=t+o*Math.cos(-r*i),d=a+o*Math.sin(-r*i);return(0,V.jsx)("text",{x:c,y:d,fill:"white",textAnchor:c>t?"start":"end",dominantBaseline:"central",fontSize:12,fontWeight:"bold",children:"".concat((100*s).toFixed(0),"%")})},outerRadius:80,fill:"#8884d8",dataKey:a,nameKey:r,children:null===t||void 0===t?void 0:t.map((e,t)=>(0,V.jsx)(z.f,{fill:i[t%i.length]},"cell-".concat(t)))}),(0,V.jsx)(F.m,{}),s&&(0,V.jsx)(P.s,{})]})})]})},H=e=>{let{data:t,dataKey:a,title:r,height:l=300,showLegend:s=!0,strokeColors:i=Y,fillColors:o=Y}=e;const c=(0,n.useMemo)(()=>t&&Array.isArray(t)?Array.isArray(a)?a.map((e,t)=>(0,V.jsx)(N.Gk,{type:"monotone",dataKey:e,stroke:i[t%i.length],fill:o[t%o.length],fillOpacity:.6},e)):(0,V.jsx)(N.Gk,{type:"monotone",dataKey:a,stroke:i[0],fill:o[0],fillOpacity:.6}):[],[t,a,i,o]);return(0,V.jsxs)(x.A,{children:[r&&(0,V.jsx)(_,{level:5,children:r}),(0,V.jsx)(K.u,{width:"100%",height:l,children:(0,V.jsxs)(I.Q,{data:t,margin:{top:5,right:30,left:20,bottom:5},children:[(0,V.jsx)(M.d,{strokeDasharray:"3 3"}),(0,V.jsx)(E.W,{dataKey:"name"}),(0,V.jsx)(S.h,{}),(0,V.jsx)(F.m,{}),s&&(0,V.jsx)(P.s,{}),c]})})]})},J=e=>{let{data:t,xKey:a,yKey:r,valueKey:l,title:s,height:i=400,colors:o=["#e6f7ff","#91d5ff","#1890ff","#0050b3","#003a8c"]}=e;const c=(0,n.useMemo)(()=>{if(!t||!Array.isArray(t))return[];const e={};return t.forEach(t=>{const n=t[a],s=t[r],i=t[l]||0,o="".concat(n,"-").concat(s);e[o]?e[o].value+=i:e[o]={x:n,y:s,value:i}}),Object.values(e)},[t,a,r,l]),d=e=>{const t=e/Math.max(...c.map(e=>e.value),1),a=Math.floor(t*(o.length-1));return o[a]||o[o.length-1]};return(0,V.jsxs)(x.A,{children:[s&&(0,V.jsx)(_,{level:5,children:s}),(0,V.jsx)("div",{style:{height:i,overflow:"auto"},children:(0,V.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:c.map((e,t)=>(0,V.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"8px 12px",backgroundColor:d(e.value),borderRadius:4,color:e.value>50?"white":"black"},children:[(0,V.jsx)(G,{strong:!0,style:{minWidth:120},children:e.x}),(0,V.jsx)(G,{style:{minWidth:120},children:e.y}),(0,V.jsx)(G,{strong:!0,style:{marginLeft:"auto"},children:e.value})]},t))})})]})};var X=a(8905),Z=a(15065);const{Text:$}=o.A,{RangePicker:ee}=c.A,{Option:te}=f.A,ae=e=>{let{filters:t,onFiltersChange:a,onSearch:n}=e;const l=(e,t)=>{a(a=>(0,r.A)((0,r.A)({},a),{},{[e]:t}))},s=t.search||t.dateRange||t.chartType;return(0,V.jsxs)(y.A,{gutter:[16,16],align:"middle",children:[(0,V.jsx)(u.A,{xs:24,sm:12,md:8,children:(0,V.jsxs)(p.A,{direction:"vertical",style:{width:"100%"},size:"small",children:[(0,V.jsx)($,{strong:!0,children:"Search"}),(0,V.jsx)(v.A,{placeholder:"Search widgets by title...",prefix:(0,V.jsx)(X.A,{}),value:t.search,onChange:e=>{return t=e.target.value,n(t),void a(e=>(0,r.A)((0,r.A)({},e),{},{search:t}));var t},allowClear:!0})]})}),(0,V.jsx)(u.A,{xs:24,sm:12,md:6,children:(0,V.jsxs)(p.A,{direction:"vertical",style:{width:"100%"},size:"small",children:[(0,V.jsx)($,{strong:!0,children:"Chart Type"}),(0,V.jsxs)(f.A,{style:{width:"100%"},placeholder:"All Types",value:t.chartType,onChange:e=>l("chartType",e),allowClear:!0,children:[(0,V.jsx)(te,{value:"line",children:"Line Chart"}),(0,V.jsx)(te,{value:"bar",children:"Bar Chart"}),(0,V.jsx)(te,{value:"pie",children:"Pie Chart"}),(0,V.jsx)(te,{value:"area",children:"Area Chart"}),(0,V.jsx)(te,{value:"heatmap",children:"Heat Map"})]})]})}),(0,V.jsx)(u.A,{xs:24,sm:12,md:8,children:(0,V.jsxs)(p.A,{direction:"vertical",style:{width:"100%"},size:"small",children:[(0,V.jsx)($,{strong:!0,children:"Date Range"}),(0,V.jsx)(ee,{style:{width:"100%"},value:t.dateRange,onChange:e=>l("dateRange",e),format:"YYYY-MM-DD"})]})}),(0,V.jsx)(u.A,{xs:24,sm:12,md:2,children:s&&(0,V.jsx)(j.Ay,{icon:(0,V.jsx)(Z.A,{}),onClick:()=>{a({search:"",dateRange:null,chartType:null})},danger:!0,style:{width:"100%"},children:"Clear"})})]})};var re=a(60497);a(92741),a(95753);const{Title:ne,Text:le}=o.A,{RangePicker:se}=c.A,ie=(0,l.WidthProvider)(l.Responsive),oe=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"line",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;const a=[];for(let r=0;r<t;r++)"line"===e||"bar"===e||"area"===e?a.push({name:"Day ".concat(r+1),value:Math.floor(100*Math.random()),value2:Math.floor(100*Math.random()),value3:Math.floor(100*Math.random())}):"pie"===e?a.push({name:"Category ".concat(r+1),value:Math.floor(100*Math.random())}):"heatmap"===e&&a.push({x:"X".concat(r%5),y:"Y".concat(Math.floor(r/5)),value:Math.floor(100*Math.random())});return a},ce=()=>{const[e,t]=(0,n.useState)({lg:[{i:"chart-1",x:0,y:0,w:6,h:3},{i:"chart-2",x:6,y:0,w:6,h:3},{i:"chart-3",x:0,y:3,w:6,h:3},{i:"chart-4",x:6,y:3,w:6,h:3}]}),[a,l]=(0,n.useState)([{id:"chart-1",type:"line",title:"Sales Trend",data:oe("line"),dataKey:"value"},{id:"chart-2",type:"bar",title:"Revenue by Category",data:oe("bar"),dataKey:"value"},{id:"chart-3",type:"pie",title:"Market Share",data:oe("pie",5),dataKey:"value"},{id:"chart-4",type:"area",title:"User Activity",data:oe("area"),dataKey:"value"}]),[o,c]=(0,n.useState)({search:"",dateRange:null,chartType:null}),[D,K]=(0,n.useState)(!1),[T,M]=(0,n.useState)(null),[E]=d.A.useForm(),S=a.filter(e=>!(o.search&&!e.title.toLowerCase().includes(o.search.toLowerCase()))&&(!o.chartType||e.type===o.chartType)),F=async t=>{try{const a={widgets:S,layouts:e.lg,filters:o,timestamp:(new Date).toISOString()};"pdf"===t?(await(0,re.Q7)(a,"Analytics-Dashboard"),h.Ay.success("Dashboard exported to PDF!")):"excel"===t?(await(0,re.bJ)(a,"Analytics-Dashboard"),h.Ay.success("Dashboard exported to Excel!")):"csv"===t&&(await(0,re.GF)(a,"Analytics-Dashboard"),h.Ay.success("Dashboard exported to CSV!"))}catch(a){console.error("Export error:",a),h.Ay.error("Failed to export dashboard")}},P=e=>{const t={title:e.title,data:e.data,dataKey:e.dataKey,height:300};switch(e.type){case"line":default:return(0,V.jsx)(B,(0,r.A)({},t));case"bar":return(0,V.jsx)(Q,(0,r.A)({},t));case"pie":return(0,V.jsx)(q,(0,r.A)({},t));case"area":return(0,V.jsx)(H,(0,r.A)({},t));case"heatmap":return(0,V.jsx)(J,{data:e.data,xKey:"x",yKey:"y",valueKey:"value",title:e.title})}};return(0,V.jsx)(s.Q,{backend:i.t2,children:(0,V.jsxs)("div",{className:"advanced-analytics-dashboard",children:[(0,V.jsx)(x.A,{className:"dashboard-header-card",children:(0,V.jsxs)(y.A,{justify:"space-between",align:"middle",children:[(0,V.jsxs)(u.A,{children:[(0,V.jsx)(ne,{level:2,children:"\ud83d\udcca Advanced Analytics Dashboard"}),(0,V.jsx)(le,{type:"secondary",children:"Interactive charts with drag & drop customization"})]}),(0,V.jsx)(u.A,{children:(0,V.jsxs)(p.A,{children:[(0,V.jsx)(j.Ay,{type:"primary",icon:(0,V.jsx)(b.A,{}),onClick:()=>{K(!0),M(null),E.resetFields()},children:"Add Widget"}),(0,V.jsx)(j.Ay,{icon:(0,V.jsx)(w.A,{}),onClick:()=>F("pdf"),children:"Export PDF"}),(0,V.jsx)(j.Ay,{icon:(0,V.jsx)(w.A,{}),onClick:()=>F("excel"),children:"Export Excel"}),(0,V.jsx)(j.Ay,{icon:(0,V.jsx)(w.A,{}),onClick:()=>F("csv"),children:"Export CSV"})]})})]})}),(0,V.jsx)(x.A,{className:"filters-card",children:(0,V.jsx)(ae,{filters:o,onFiltersChange:c,onSearch:e=>c(t=>(0,r.A)((0,r.A)({},t),{},{search:e}))})}),(0,V.jsx)(ie,{className:"layout",layouts:e,onLayoutChange:(e,a)=>{t(a)},breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:10,sm:6,xs:4,xxs:2},rowHeight:100,isDraggable:!0,isResizable:!0,children:S.map(e=>(0,V.jsx)("div",{className:"widget-container",children:(0,V.jsx)(x.A,{className:"widget-card",title:(0,V.jsxs)("div",{className:"widget-header",children:[(0,V.jsx)(le,{strong:!0,children:e.title}),(0,V.jsxs)(p.A,{children:[(0,V.jsx)(g.A,{title:"Edit",children:(0,V.jsx)(j.Ay,{type:"text",size:"small",icon:(0,V.jsx)(C.A,{}),onClick:()=>(e=>{M(e),E.setFieldsValue({type:e.type,title:e.title}),K(!0)})(e)})}),(0,V.jsx)(g.A,{title:"Delete",children:(0,V.jsx)(j.Ay,{type:"text",size:"small",danger:!0,icon:(0,V.jsx)(k.A,{}),onClick:()=>{return a=e.id,l(e=>e.filter(e=>e.id!==a)),t(e=>({lg:(e.lg||[]).filter(e=>e.i!==a)})),void h.Ay.success("Widget deleted successfully!");var a}})})]})]}),extra:(0,V.jsx)(m.A,{children:e.type.toUpperCase()}),children:P(e)})},e.id))}),(0,V.jsx)(A.A,{title:T?"Edit Widget":"Add New Widget",open:D,onCancel:()=>{K(!1),E.resetFields()},onOk:()=>E.submit(),okText:"Save",cancelText:"Cancel",children:(0,V.jsxs)(d.A,{form:E,layout:"vertical",onFinish:e=>{const n={id:"chart-".concat(Date.now()),type:e.type,title:e.title,data:oe(e.type),dataKey:"value"};if(T)l(e=>e.map(e=>e.id===T.id?(0,r.A)((0,r.A)({},e),n):e)),h.Ay.success("Widget updated successfully!");else{l(e=>[...e,n]);const e={i:n.id,x:a.length%2*6,y:3*Math.floor(a.length/2),w:6,h:3};t(t=>({lg:[...t.lg||[],e]})),h.Ay.success("Widget added successfully!")}K(!1),E.resetFields()},initialValues:{type:"line"},children:[(0,V.jsx)(d.A.Item,{name:"title",label:"Widget Title",rules:[{required:!0,message:"Please enter widget title"}],children:(0,V.jsx)(v.A,{placeholder:"Enter widget title"})}),(0,V.jsx)(d.A.Item,{name:"type",label:"Chart Type",rules:[{required:!0,message:"Please select chart type"}],children:(0,V.jsxs)(f.A,{children:[(0,V.jsx)(f.A.Option,{value:"line",children:"Line Chart"}),(0,V.jsx)(f.A.Option,{value:"bar",children:"Bar Chart"}),(0,V.jsx)(f.A.Option,{value:"pie",children:"Pie Chart"}),(0,V.jsx)(f.A.Option,{value:"area",children:"Area Chart"}),(0,V.jsx)(f.A.Option,{value:"heatmap",children:"Heat Map"})]})})]})})]})})}}}]);
//# sourceMappingURL=advanced-analytics.d9a17ead.chunk.js.map